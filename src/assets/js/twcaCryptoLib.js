var separation="|-|",MobileUtils={unregisterFunction:function(I){"string"==typeof func&&delete window[I]},registerFunction:function(I){if("function"==typeof I){arguments.callee.count=++arguments.callee.count||(new Date).getTime();var D="mobilejscbf"+arguments.callee.count;window[D]=function(){I.apply(this,arguments);delete window[D]};return D}return"string"==typeof I?I:""},supportTwidAndroid:function(){return"undefined"!=typeof window.mobile&&"function"==typeof window.mobile.GetVersion},toNumber:function(I){return"number"!=
typeof I?(I=parseInt(I),isNaN(I)?0:I):I}};function mobileAndTabletcheck(){var I=!1;/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(I=!0);return I}
function TwcaCryptoLibAlertDialog(){this.show=function(I,D,G,m,x,F){if(!document.getElementById("dialogoverlay")){var y=document.createElement("DIV");y.id="dialogoverlay";document.body.appendChild(y)}if(!document.getElementById("dialogbox")){y=document.createElement("DIV");y.id="dialogbox";var C=document.createElement("DIV");C.id="dialogboxhead";var t=document.createElement("DIV");t.id="dialogboxbody";var a=document.createElement("DIV");a.id="dialogboxfoot";y.appendChild(C);y.appendChild(t);y.appendChild(a);
document.body.appendChild(y)}var e,y=window.innerWidth;e=window.innerHeight;if(void 0===y||void 0===e)y=document.documentElement.clientWidth,e=document.documentElement.clientHeight;var d=Math.max(Math.min(.35*y,420),280),k=document.getElementById("dialogoverlay"),g=document.getElementById("dialogbox"),C=document.getElementById("dialogboxhead"),t=document.getElementById("dialogboxbody"),a=document.getElementById("dialogboxfoot");k.style.display="block";k.style.height=e+"px";k.style.opacity=.8;k.style.position=
"fixed";k.style.top="0px";k.style.left="0px";k.style.background="#000";k.style.width="100%";k.style.zIndex=10;g.style.display="block";g.style.left=y/2-d/2+"px";g.style.top=.15*e+"px";g.style.position="fixed";g.style.background="#FFF";g.style.width=d+"px";g.style.zIndex=10;g.style.border="solid";g.style.borderWidth="1px";g.style.borderColor="#000000";g.style.borderTopLeftRadius="5px";g.style.borderTopRightRadius="5px";g.style.borderBottomLeftRadius="5px";g.style.borderBottomRightRadius="5px";C.style.background=
"#E2E2E2";C.style.borderColor="#000000";C.style.color="#666666";C.style.fontWeight="bold";C.style.font.size="19px";C.style.padding="10px";C.style.borderTopLeftRadius="5px";C.style.borderTopRightRadius="5px";C.style.textAlign="center";t.style.font.size="18px";t.style.color="#717171";t.style.textAlign="center";a.style.background="#E2E2E2";a.style.borderColor="#000000";a.style.font.size="10px";a.style.height="35px";a.style.lineHeight="35px";a.style.textAlign="center";a.style.borderBottomLeftRadius="5px";
a.style.borderBottomRightRadius="5px";twcaDialogParams=F;document.getElementById("dialogboxhead").innerHTML=I;document.getElementById("dialogboxbody").innerHTML="<br/>&nbsp;&nbsp;"+D+"<br/>&nbsp;&nbsp;"+G+'&nbsp;<input id="twcaCryptoLibInput" type="password"/><br/><br/>';document.getElementById("dialogboxfoot").innerHTML='<input type="button" value="'+m+'" onclick="twcaCryptoLibAlertDialog.cancel(twcaDialogParams);" style="width:'+.25*d+'px;" /> &nbsp; <input type="button" value="'+x+'" onclick="twcaCryptoLibAlertDialog.ok(twcaDialogParams);" style="width:'+
.25*d+'px;" />';document.getElementById("twcaCryptoLibInput").focus()};this.ok=function(I){twcaDialogParams=null;document.getElementById("dialogbox").style.display="none";document.getElementById("dialogoverlay").style.display="none";"SelectSignerEx"==I[0]?I[10].SelectSignerEx(I[1],I[2],I[3],document.getElementById("twcaCryptoLibInput").value,I[5],I[6],I[7],I[8],I[9]):"SelectSignerExFromChild"==I[0]&&I[10].SelectSignerEx(I[1],I[2],I[3],document.getElementById("twcaCryptoLibInput").value,I[5],I[6],
I[7],I[8],I[9])};this.cancel=function(I){twcaDialogParams=null;document.getElementById("dialogbox").style.display="none";document.getElementById("dialogoverlay").style.display="none";"SelectSignerEx"==I[0]?I[10].callback(I[9],5070,"\u4f7f\u7528\u8005\u6309\u4e0b\u53d6\u6d88",""):"SelectSignerExFromChild"==I[0]&&I[10].callback(I[9],5070,"\u4f7f\u7528\u8005\u6309\u4e0b\u53d6\u6d88","")}}var support_amd;
try{support_amd=define.amd}catch(I){(function(D,G){"function"==typeof define&&define.amd?define([],G):D.forge=G()})(this,function(){var D,G,m;return function(x){function F(a,b){var c,q,h,g,d,l,n,u,e,k=b&&b.split("/"),w=f.map,m=w&&w["*"]||{};if(a&&"."===a.charAt(0))if(b){k=k.slice(0,k.length-1);a=a.split("/");d=a.length-1;f.nodeIdCompat&&v.test(a[d])&&(a[d]=a[d].replace(v,""));a=k.concat(a);for(d=0;d<a.length;d+=1)if(c=a[d],"."===c)a.splice(d,1),--d;else if(".."===c){if(1===d&&(".."===a[2]||".."===
a[0]))break;0<d&&(a.splice(d-1,2),d-=2)}a=a.join("/")}else 0===a.indexOf("./")&&(a=a.substring(2));if((k||m)&&w){c=a.split("/");for(d=c.length;0<d;--d){q=c.slice(0,d).join("/");if(k)for(e=k.length;0<e;--e)if(h=w[k.slice(0,e).join("/")])if(h=h[q]){g=h;l=d;break}if(g)break;!n&&m&&m[q]&&(n=m[q],u=d)}!g&&n&&(g=n,l=u);g&&(c.splice(0,l,g),a=c.join("/"))}return a}function y(a,b){return function(){return g.apply(x,q.call(arguments,0).concat([a,b]))}}function C(a){return function(b){return F(b,a)}}function t(a){return function(c){b[a]=
c}}function a(a){if(u.call(n,a)){var c=n[a];delete n[a];w[a]=!0;k.apply(x,c)}if(!u.call(b,a)&&!u.call(w,a))throw Error("No "+a);return b[a]}function e(a){var b,c=a?a.indexOf("!"):-1;return-1<c&&(b=a.substring(0,c),a=a.substring(c+1,a.length)),[b,a]}function d(a){return function(){return f&&f.config&&f.config[a]||{}}}var k,g,h,c,b={},n={},f={},w={},u=Object.prototype.hasOwnProperty,q=[].slice,v=/\.js$/;h=function(b,c){var q,f=e(b),h=f[0];return b=f[1],h&&(h=F(h,c),q=a(h)),h?q&&q.normalize?b=q.normalize(b,
C(c)):b=F(b,c):(b=F(b,c),f=e(b),h=f[0],b=f[1],h&&(q=a(h))),{f:h?h+"!"+b:b,n:b,pr:h,p:q}};c={require:function(a){return y(a)},exports:function(a){var c=b[a];return"undefined"!=typeof c?c:b[a]={}},module:function(a){return{id:a,uri:"",exports:b[a],config:d(a)}}};k=function(q,f,p,d){var v,g,e,l,k=[];g=typeof p;var m;d=d||q;if("undefined"===g||"function"===g){f=!f.length&&p.length?["require","exports","module"]:f;for(l=0;l<f.length;l+=1)if(e=h(f[l],d),g=e.f,"require"===g)k[l]=c.require(q);else if("exports"===
g)k[l]=c.exports(q),m=!0;else if("module"===g)v=k[l]=c.module(q);else if(u.call(b,g)||u.call(n,g)||u.call(w,g))k[l]=a(g);else{if(!e.p)throw Error(q+" missing "+g);e.p.load(e.n,y(d,!0),t(g),{});k[l]=b[g]}f=p?p.apply(b[q],k):void 0;q&&(v&&v.exports!==x&&v.exports!==b[q]?b[q]=v.exports:f===x&&m||(b[q]=f))}else q&&(b[q]=p)};D=G=g=function(b,q,p,d,v){if("string"==typeof b)return c[b]?c[b](q):a(h(b,q).f);if(!b.splice){f=b;f.deps&&g(f.deps,f.callback);if(!q)return;q.splice?(b=q,q=p,p=null):b=x}return q=
q||function(){},"function"==typeof p&&(p=d,d=v),d?k(x,b,q,p):setTimeout(function(){k(x,b,q,p)},4),g};g.config=function(a){return g(a)};D._defined=b;m=function(a,c,q){c.splice||(q=c,c=[]);u.call(b,a)||u.call(n,a)||(n[a]=[a,c,q])};m.amd={jQuery:!0}}(),m("node_modules/almond/almond",function(){}),function(){function x(a){function e(a){this.data="";this.read=0;if("string"==typeof a)this.data=a;else if(d.isArrayBuffer(a)||d.isArrayBufferView(a)){a=new Uint8Array(a);try{this.data=String.fromCharCode.apply(null,
a)}catch(b){for(var c=0;c<a.length;++c)this.putByte(a[c])}}else if(a instanceof e||"object"==typeof a&&"string"==typeof a.data&&"number"==typeof a.read)this.data=a.data,this.read=a.read;this._constructedStringLength=0}var d=a.util=a.util||{};(function(){if("undefined"!=typeof process&&process.nextTick)d.nextTick=process.nextTick,"function"==typeof setImmediate?d.setImmediate=setImmediate:d.setImmediate=d.nextTick;else if("function"==typeof setImmediate)d.setImmediate=setImmediate,d.nextTick=function(a){return setImmediate(a)};
else{d.setImmediate=function(a){setTimeout(a,0)};if("undefined"!=typeof window&&"function"==typeof window.postMessage){var a=[];d.setImmediate=function(b){a.push(b);1===a.length&&window.postMessage("forge.setImmediate","*")};window.addEventListener("message",function(b){b.source===window&&"forge.setImmediate"===b.data&&(b.stopPropagation(),b=a.slice(),a.length=0,b.forEach(function(a){a()}))},!0)}if("undefined"!=typeof MutationObserver){var b=Date.now(),c=!0,f=document.createElement("div"),a=[];(new MutationObserver(function(){var b=
a.slice();a.length=0;b.forEach(function(a){a()})})).observe(f,{attributes:!0});var p=d.setImmediate;d.setImmediate=function(h){15<Date.now()-b?(b=Date.now(),p(h)):(a.push(h),1===a.length&&f.setAttribute("a",c=!c))}}d.nextTick=d.setImmediate}})();d.isArray=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)};d.isArrayBuffer=function(a){return"undefined"!=typeof ArrayBuffer&&a instanceof ArrayBuffer};d.isArrayBufferView=function(a){return a&&d.isArrayBuffer(a.buffer)&&
void 0!==a.byteLength};d.ByteBuffer=e;d.ByteStringBuffer=e;d.ByteStringBuffer.prototype._optimizeConstructedString=function(a){this._constructedStringLength+=a;4096<this._constructedStringLength&&(this.data.substr(0,1),this._constructedStringLength=0)};d.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};d.ByteStringBuffer.prototype.isEmpty=function(){return 0>=this.length()};d.ByteStringBuffer.prototype.putByte=function(a){return this.putBytes(String.fromCharCode(a))};
d.ByteStringBuffer.prototype.fillWithByte=function(a,b){a=String.fromCharCode(a);for(var c=this.data;0<b;)b&1&&(c+=a),b>>>=1,0<b&&(a+=a);return this.data=c,this._optimizeConstructedString(b),this};d.ByteStringBuffer.prototype.putBytes=function(a){return this.data+=a,this._optimizeConstructedString(a.length),this};d.ByteStringBuffer.prototype.putString=function(a){return this.putBytes(d.encodeUtf8(a))};d.ByteStringBuffer.prototype.putInt16=function(a){return this.putBytes(String.fromCharCode(a>>8&
255)+String.fromCharCode(a&255))};d.ByteStringBuffer.prototype.putInt24=function(a){return this.putBytes(String.fromCharCode(a>>16&255)+String.fromCharCode(a>>8&255)+String.fromCharCode(a&255))};d.ByteStringBuffer.prototype.putInt32=function(a){return this.putBytes(String.fromCharCode(a>>24&255)+String.fromCharCode(a>>16&255)+String.fromCharCode(a>>8&255)+String.fromCharCode(a&255))};d.ByteStringBuffer.prototype.putInt16Le=function(a){return this.putBytes(String.fromCharCode(a&255)+String.fromCharCode(a>>
8&255))};d.ByteStringBuffer.prototype.putInt24Le=function(a){return this.putBytes(String.fromCharCode(a&255)+String.fromCharCode(a>>8&255)+String.fromCharCode(a>>16&255))};d.ByteStringBuffer.prototype.putInt32Le=function(a){return this.putBytes(String.fromCharCode(a&255)+String.fromCharCode(a>>8&255)+String.fromCharCode(a>>16&255)+String.fromCharCode(a>>24&255))};d.ByteStringBuffer.prototype.putInt=function(a,b){var c="";do b-=8,c+=String.fromCharCode(a>>b&255);while(0<b);return this.putBytes(c)};
d.ByteStringBuffer.prototype.putSignedInt=function(a,b){return 0>a&&(a+=2<<b-1),this.putInt(a,b)};d.ByteStringBuffer.prototype.putBuffer=function(a){return this.putBytes(a.getBytes())};d.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};d.ByteStringBuffer.prototype.getInt16=function(){var a=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,a};d.ByteStringBuffer.prototype.getInt24=function(){var a=this.data.charCodeAt(this.read)<<
16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,a};d.ByteStringBuffer.prototype.getInt32=function(){var a=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,a};d.ByteStringBuffer.prototype.getInt16Le=function(){var a=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,a};d.ByteStringBuffer.prototype.getInt24Le=
function(){var a=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,a};d.ByteStringBuffer.prototype.getInt32Le=function(){var a=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,a};d.ByteStringBuffer.prototype.getInt=function(a){var b=0;do b=(b<<8)+this.data.charCodeAt(this.read++),a-=8;while(0<a);return b};d.ByteStringBuffer.prototype.getSignedInt=
function(a){var b=this.getInt(a);a=2<<a-2;return b>=a&&(b-=a<<1),b};d.ByteStringBuffer.prototype.getBytes=function(a){var b;return a?(a=Math.min(this.length(),a),b=this.data.slice(this.read,this.read+a),this.read+=a):0===a?b="":(b=0===this.read?this.data:this.data.slice(this.read),this.clear()),b};d.ByteStringBuffer.prototype.bytes=function(a){return"undefined"==typeof a?this.data.slice(this.read):this.data.slice(this.read,this.read+a)};d.ByteStringBuffer.prototype.at=function(a){return this.data.charCodeAt(this.read+
a)};d.ByteStringBuffer.prototype.setAt=function(a,b){return this.data=this.data.substr(0,this.read+a)+String.fromCharCode(b)+this.data.substr(this.read+a+1),this};d.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};d.ByteStringBuffer.prototype.copy=function(){var a=d.createBuffer(this.data);return a.read=this.read,a};d.ByteStringBuffer.prototype.compact=function(){return 0<this.read&&(this.data=this.data.slice(this.read),this.read=0),this};d.ByteStringBuffer.prototype.clear=
function(){return this.data="",this.read=0,this};d.ByteStringBuffer.prototype.truncate=function(a){a=Math.max(0,this.length()-a);return this.data=this.data.substr(this.read,a),this.read=0,this};d.ByteStringBuffer.prototype.toHex=function(){for(var a="",b=this.read;b<this.data.length;++b){var c=this.data.charCodeAt(b);16>c&&(a+="0");a+=c.toString(16)}return a};d.ByteStringBuffer.prototype.toString=function(){return d.decodeUtf8(this.bytes())};d.DataBuffer=function(a,b){b=b||{};this.read=b.readOffset||
0;this.growSize=b.growSize||1024;var c=d.isArrayBuffer(a),f=d.isArrayBufferView(a);c||f?(c?this.data=new DataView(a):this.data=new DataView(a.buffer,a.byteOffset,a.byteLength),this.write="writeOffset"in b?b.writeOffset:this.data.byteLength):(this.data=new DataView(new ArrayBuffer(0)),this.write=0,null!==a&&void 0!==a&&this.putBytes(a),"writeOffset"in b&&(this.write=b.writeOffset))};d.DataBuffer.prototype.length=function(){return this.write-this.read};d.DataBuffer.prototype.isEmpty=function(){return 0>=
this.length()};d.DataBuffer.prototype.accommodate=function(a,b){if(this.length()>=a)return this;b=Math.max(b||this.growSize,a);var c=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),f=new Uint8Array(this.length()+b);return f.set(c),this.data=new DataView(f.buffer),this};d.DataBuffer.prototype.putByte=function(a){return this.accommodate(1),this.data.setUint8(this.write++,a),this};d.DataBuffer.prototype.fillWithByte=function(a,b){this.accommodate(b);for(var c=0;c<b;++c)this.data.setUint8(a);
return this};d.DataBuffer.prototype.putBytes=function(a,b){if(d.isArrayBufferView(a)){var c=new Uint8Array(a.buffer,a.byteOffset,a.byteLength),f=c.byteLength-c.byteOffset;this.accommodate(f);var p=new Uint8Array(this.data.buffer,this.write);return p.set(c),this.write+=f,this}if(d.isArrayBuffer(a))return c=new Uint8Array(a),this.accommodate(c.byteLength),p=new Uint8Array(this.data.buffer),p.set(c,this.write),this.write+=c.byteLength,this;if(a instanceof d.DataBuffer||"object"==typeof a&&"number"==
typeof a.read&&"number"==typeof a.write&&d.isArrayBufferView(a.data))return c=new Uint8Array(a.data.byteLength,a.read,a.length()),this.accommodate(c.byteLength),p=new Uint8Array(a.data.byteLength,this.write),p.set(c),this.write+=c.byteLength,this;a instanceof d.ByteStringBuffer&&(a=a.data,b="binary");b=b||"binary";if("string"==typeof a){if("hex"===b)return this.accommodate(Math.ceil(a.length/2)),c=new Uint8Array(this.data.buffer,this.write),this.write+=d.binary.hex.decode(a,c,this.write),this;if("base64"===
b)return this.accommodate(3*Math.ceil(a.length/4)),c=new Uint8Array(this.data.buffer,this.write),this.write+=d.binary.base64.decode(a,c,this.write),this;"utf8"===b&&(a=d.encodeUtf8(a),b="binary");if("binary"===b||"raw"===b)return this.accommodate(a.length),c=new Uint8Array(this.data.buffer,this.write),this.write+=d.binary.raw.decode(c),this;if("utf16"===b)return this.accommodate(2*a.length),c=new Uint16Array(this.data.buffer,this.write),this.write+=d.text.utf16.encode(c),this;throw Error("Invalid encoding: "+
b);}throw Error("Invalid parameter: "+a);};d.DataBuffer.prototype.putBuffer=function(a){return this.putBytes(a),a.clear(),this};d.DataBuffer.prototype.putString=function(a){return this.putBytes(a,"utf16")};d.DataBuffer.prototype.putInt16=function(a){return this.accommodate(2),this.data.setInt16(this.write,a),this.write+=2,this};d.DataBuffer.prototype.putInt24=function(a){return this.accommodate(3),this.data.setInt16(this.write,a>>8&65535),this.data.setInt8(this.write,a>>16&255),this.write+=3,this};
d.DataBuffer.prototype.putInt32=function(a){return this.accommodate(4),this.data.setInt32(this.write,a),this.write+=4,this};d.DataBuffer.prototype.putInt16Le=function(a){return this.accommodate(2),this.data.setInt16(this.write,a,!0),this.write+=2,this};d.DataBuffer.prototype.putInt24Le=function(a){return this.accommodate(3),this.data.setInt8(this.write,a>>16&255),this.data.setInt16(this.write,a>>8&65535,!0),this.write+=3,this};d.DataBuffer.prototype.putInt32Le=function(a){return this.accommodate(4),
this.data.setInt32(this.write,a,!0),this.write+=4,this};d.DataBuffer.prototype.putInt=function(a,b){this.accommodate(b/8);do b-=8,this.data.setInt8(this.write++,a>>b&255);while(0<b);return this};d.DataBuffer.prototype.putSignedInt=function(a,b){return this.accommodate(b/8),0>a&&(a+=2<<b-1),this.putInt(a,b)};d.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};d.DataBuffer.prototype.getInt16=function(){var a=this.data.getInt16(this.read);return this.read+=2,a};d.DataBuffer.prototype.getInt24=
function(){var a=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,a};d.DataBuffer.prototype.getInt32=function(){var a=this.data.getInt32(this.read);return this.read+=4,a};d.DataBuffer.prototype.getInt16Le=function(){var a=this.data.getInt16(this.read,!0);return this.read+=2,a};d.DataBuffer.prototype.getInt24Le=function(){var a=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,a};d.DataBuffer.prototype.getInt32Le=function(){var a=
this.data.getInt32(this.read,!0);return this.read+=4,a};d.DataBuffer.prototype.getInt=function(a){var b=0;do b=(b<<8)+this.data.getInt8(this.read++),a-=8;while(0<a);return b};d.DataBuffer.prototype.getSignedInt=function(a){var b=this.getInt(a);a=2<<a-2;return b>=a&&(b-=a<<1),b};d.DataBuffer.prototype.getBytes=function(a){var b;return a?(a=Math.min(this.length(),a),b=this.data.slice(this.read,this.read+a),this.read+=a):0===a?b="":(b=0===this.read?this.data:this.data.slice(this.read),this.clear()),
b};d.DataBuffer.prototype.bytes=function(a){return"undefined"==typeof a?this.data.slice(this.read):this.data.slice(this.read,this.read+a)};d.DataBuffer.prototype.at=function(a){return this.data.getUint8(this.read+a)};d.DataBuffer.prototype.setAt=function(a,b){return this.data.setUint8(a,b),this};d.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};d.DataBuffer.prototype.copy=function(){return new d.DataBuffer(this)};d.DataBuffer.prototype.compact=function(){if(0<this.read){var a=
new Uint8Array(this.data.buffer,this.read),b=new Uint8Array(a.byteLength);b.set(a);this.data=new DataView(b);this.write-=this.read;this.read=0}return this};d.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};d.DataBuffer.prototype.truncate=function(a){return this.write=Math.max(0,this.length()-a),this.read=Math.min(this.read,this.write),this};d.DataBuffer.prototype.toHex=function(){for(var a="",b=this.read;b<this.data.byteLength;++b){var c=
this.data.getUint8(b);16>c&&(a+="0");a+=c.toString(16)}return a};d.DataBuffer.prototype.toString=function(a){var b=new Uint8Array(this.data,this.read,this.length());a=a||"utf8";if("binary"===a||"raw"===a)return d.binary.raw.encode(b);if("hex"===a)return d.binary.hex.encode(b);if("base64"===a)return d.binary.base64.encode(b);if("utf8"===a)return d.text.utf8.decode(b);if("utf16"===a)return d.text.utf16.decode(b);throw Error("Invalid encoding: "+a);};d.createBuffer=function(a,b){return b=b||"raw",void 0!==
a&&"utf8"===b&&(a=d.encodeUtf8(a)),new d.ByteBuffer(a)};d.fillString=function(a,b){for(var c="";0<b;)b&1&&(c+=a),b>>>=1,0<b&&(a+=a);return c};d.xorBytes=function(a,b,c){for(var f="",p,h="",d=0,g=0;0<c;--c,++d)p=a.charCodeAt(d)^b.charCodeAt(d),10<=g&&(f+=h,h="",g=0),h+=String.fromCharCode(p),++g;return f+=h,f};d.hexToBytes=function(a){var b="",c=0;for(a.length&1&&(c=1,b+=String.fromCharCode(parseInt(a[0],16)));c<a.length;c+=2)b+=String.fromCharCode(parseInt(a.substr(c,2),16));return b};d.bytesToHex=
function(a){return d.createBuffer(a).toHex()};d.int32ToBytes=function(a){return String.fromCharCode(a>>24&255)+String.fromCharCode(a>>16&255)+String.fromCharCode(a>>8&255)+String.fromCharCode(a&255)};var k=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];d.encode64=function(a,b){for(var c="",f="",p,h,d,g=0;g<a.length;)p=
a.charCodeAt(g++),h=a.charCodeAt(g++),d=a.charCodeAt(g++),c+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(p>>2),c+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt((p&3)<<4|h>>4),isNaN(h)?c+="==":(c+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt((h&15)<<2|d>>6),c+=isNaN(d)?"=":"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(d&63)),b&&c.length>b&&(f+=c.substr(0,b)+"\r\n",c=c.substr(b));return f+=
c,f};d.decode64=function(a){a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var b="",c,f,p,h,d=0;d<a.length;)c=k[a.charCodeAt(d++)-43],f=k[a.charCodeAt(d++)-43],p=k[a.charCodeAt(d++)-43],h=k[a.charCodeAt(d++)-43],b+=String.fromCharCode(c<<2|f>>4),64!==p&&(b+=String.fromCharCode((f&15)<<4|p>>2),64!==h&&(b+=String.fromCharCode((p&3)<<6|h)));return b};d.encodeUtf8=function(a){return unescape(encodeURIComponent(a))};d.decodeUtf8=function(a){return decodeURIComponent(escape(a))};d.binary={raw:{},hex:{},base64:{}};
d.binary.raw.encode=function(a){return String.fromCharCode.apply(null,a)};d.binary.raw.decode=function(a,b,c){var f=b;f||(f=new Uint8Array(a.length));for(var p=c=c||0,h=0;h<a.length;++h)f[p++]=a.charCodeAt(h);return b?p-c:f};d.binary.hex.encode=d.bytesToHex;d.binary.hex.decode=function(a,b,c){var f=b;f||(f=new Uint8Array(Math.ceil(a.length/2)));c=c||0;var p=0,h=c;for(a.length&1&&(p=1,f[h++]=parseInt(a[0],16));p<a.length;p+=2)f[h++]=parseInt(a.substr(p,2),16);return b?h-c:f};d.binary.base64.encode=
function(a,b){for(var c="",f="",p,h,d,g=0;g<a.byteLength;)p=a[g++],h=a[g++],d=a[g++],c+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(p>>2),c+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt((p&3)<<4|h>>4),isNaN(h)?c+="==":(c+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt((h&15)<<2|d>>6),c+=isNaN(d)?"=":"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(d&63)),b&&c.length>b&&(f+=c.substr(0,
b)+"\r\n",c=c.substr(b));return f+=c,f};d.binary.base64.decode=function(a,b,c){var f=b;f||(f=new Uint8Array(3*Math.ceil(a.length/4)));a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");c=c||0;for(var p,h,d,g,n=0,l=c;n<a.length;)p=k[a.charCodeAt(n++)-43],h=k[a.charCodeAt(n++)-43],d=k[a.charCodeAt(n++)-43],g=k[a.charCodeAt(n++)-43],f[l++]=p<<2|h>>4,64!==d&&(f[l++]=(h&15)<<4|d>>2,64!==g&&(f[l++]=(d&3)<<6|g));return b?l-c:f.subarray(0,l)};d.text={utf8:{},utf16:{}};d.text.utf8.encode=function(a,b,c){a=d.encodeUtf8(a);
var f=b;f||(f=new Uint8Array(a.length));for(var p=c=c||0,h=0;h<a.length;++h)f[p++]=a.charCodeAt(h);return b?p-c:f};d.text.utf8.decode=function(a){return d.decodeUtf8(String.fromCharCode.apply(null,a))};d.text.utf16.encode=function(a,b,c){var f=b;f||(f=new Uint8Array(a.length));for(var p=new Uint16Array(f),h=c=c||0,d=c,g=0;g<a.length;++g)p[d++]=a.charCodeAt(g),h+=2;return b?h-c:f};d.text.utf16.decode=function(a){return String.fromCharCode.apply(null,new Uint16Array(a))};d.deflate=function(a,b,c){b=
d.decode64(a.deflate(d.encode64(b)).rval);c&&(a=2,b.charCodeAt(1)&32&&(a=6),b=b.substring(a,b.length-4));return b};d.inflate=function(a,b,c){a=a.inflate(d.encode64(b)).rval;return null===a?null:d.decode64(a)};var g=function(a,b,c){if(!a)throw Error("WebStorage not available.");var f;null===c?f=a.removeItem(b):(c=d.encode64(JSON.stringify(c)),f=a.setItem(b,c));if("undefined"!=typeof f&&!0!==f.rval)throw a=Error(f.error.message),a.id=f.error.id,a.name=f.error.name,a;},h=function(a,b){if(!a)throw Error("WebStorage not available.");
var c=a.getItem(b);if(a.init)if(null===c.rval){if(c.error){var f=Error(c.error.message);throw f.id=c.error.id,f.name=c.error.name,f;}c=null}else c=c.rval;return null!==c&&(c=JSON.parse(d.decode64(c))),c},c=function(a,b,c,f){var p=h(a,b);null===p&&(p={});p[c]=f;g(a,b,p)},b=function(a,b,c){a=h(a,b);return null!==a&&(a=c in a?a[c]:null),a},n=function(a,b,c){var f=h(a,b);if(null!==f&&c in f){delete f[c];c=!0;for(var p in f){c=!1;break}c&&(f=null);g(a,b,f)}},f=function(a,b){g(a,b,null)},w=function(a,b,
c){var f=null;"undefined"==typeof c&&(c=["web","flash"]);var p,h=!1,d=null,g;for(g in c){p=c[g];try{if("flash"===p||"both"===p){if(null===b[0])throw Error("Flash local storage not available.");f=a.apply(this,b);h="flash"===p}if("web"===p||"both"===p)b[0]=localStorage,f=a.apply(this,b),h=!0}catch(n){d=n}if(h)break}if(!h)throw d;return f};d.setItem=function(a,b,f,h,p){w(c,arguments,p)};d.getItem=function(a,c,f,h){return w(b,arguments,h)};d.removeItem=function(a,b,c,f){w(n,arguments,f)};d.clearItems=
function(a,b,c){w(f,arguments,c)};d.parseUrl=function(a){var b=/^(https?):\/\/([^:&^\/]*):?(\d*)(.*)$/g;b.lastIndex=0;b=b.exec(a);a=null===b?null:{full:a,scheme:b[1],host:b[2],port:b[3],path:b[4]};return a&&(a.fullHost=a.host,a.port?80!==a.port&&"http"===a.scheme?a.fullHost+=":"+a.port:443!==a.port&&"https"===a.scheme&&(a.fullHost+=":"+a.port):"http"===a.scheme?a.port=80:"https"===a.scheme&&(a.port=443),a.full=a.scheme+"://"+a.fullHost),a};var u=null;d.getQueryVariables=function(a){var b=function(a){var b=
{};a=a.split("&");for(var c=0;c<a.length;c++){var f=a[c].indexOf("="),h,d;0<f?(h=a[c].substring(0,f),d=a[c].substring(f+1)):(h=a[c],d=null);h in b||(b[h]=[]);h in Object.prototype||null===d||b[h].push(unescape(d))}return b},c;return"undefined"==typeof a?(null===u&&("undefined"!=typeof window&&window.location&&window.location.search?u=b(window.location.search.substring(1)):u={}),c=u):c=b(a),c};d.parseFragment=function(a){var b=a,c="",f=a.indexOf("?");0<f&&(b=a.substring(0,f),c=a.substring(f+1));a=
b.split("/");0<a.length&&""===a[0]&&a.shift();f=""===c?{}:d.getQueryVariables(c);return{pathString:b,queryString:c,path:a,query:f}};d.makeRequest=function(a){var b=d.parseFragment(a),c={path:b.pathString,query:b.queryString,getPath:function(a){return"undefined"==typeof a?b.path:b.path[a]},getQuery:function(a,c){var f;return"undefined"==typeof a?f=b.query:(f=b.query[a],f&&"undefined"!=typeof c&&(f=f[c])),f},getQueryLast:function(a,b){var f,h=c.getQuery(a);return h?f=h[h.length-1]:f=b,f}};return c};
d.makeLink=function(a,b,c){a=jQuery.isArray(a)?a.join("/"):a;b=jQuery.param(b||{});return c=c||"",a+(0<b.length?"?"+b:"")+(0<c.length?"#"+c:"")};d.setPath=function(a,b,c){if("object"==typeof a&&null!==a)for(var f=0,p=b.length;f<p;){var h=b[f++];if(f==p)a[h]=c;else{var d=h in a;if(!d||d&&"object"!=typeof a[h]||d&&null===a[h])a[h]={};a=a[h]}}};d.getPath=function(a,b,c){for(var f=0,p=b.length,h=!0;h&&f<p&&"object"==typeof a&&null!==a;){var d=b[f++];(h=d in a)&&(a=a[d])}return h?a:c};d.deletePath=function(a,
b){if("object"==typeof a&&null!==a)for(var c=0,f=b.length;c<f;){var p=b[c++];if(c==f)delete a[p];else{if(!(p in a&&"object"==typeof a[p]&&null!==a[p]))break;a=a[p]}}};d.isEmpty=function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0};d.format=function(a){var b=/%./g,c,f,p=0,h=[];for(f=0;c=b.exec(a);)switch(f=a.substring(f,b.lastIndex-2),0<f.length&&h.push(f),f=b.lastIndex,c=c[0][1],c){case "s":case "o":p<arguments.length?h.push(arguments[p++ +1]):h.push("<?>");break;case "%":h.push("%");
break;default:h.push("<%"+c+"?>")}return h.push(a.substring(f)),h.join("")};d.formatNumber=function(a,b,c,f){var p=isNaN(b=Math.abs(b))?2:b;b=void 0===c?",":c;f=void 0===f?".":f;c=0>a?"-":"";var h=parseInt(a=Math.abs(+a||0).toFixed(p),10)+"",d=3<h.length?h.length%3:0;return c+(d?h.substr(0,d)+f:"")+h.substr(d).replace(/(\d{3})(?=\d)/g,"$1"+f)+(p?b+Math.abs(a-h).toFixed(p).slice(2):"")};d.formatSize=function(a){return 1073741824<=a?a=d.formatNumber(a/1073741824,2,".","")+" GiB":1048576<=a?a=d.formatNumber(a/
1048576,2,".","")+" MiB":1024<=a?a=d.formatNumber(a/1024,0)+" KiB":a=d.formatNumber(a,0)+" bytes",a};d.bytesFromIP=function(a){return-1!==a.indexOf(".")?d.bytesFromIPv4(a):-1!==a.indexOf(":")?d.bytesFromIPv6(a):null};d.bytesFromIPv4=function(a){a=a.split(".");if(4!==a.length)return null;for(var b=d.createBuffer(),c=0;c<a.length;++c){var f=parseInt(a[c],10);if(isNaN(f))return null;b.putByte(f)}return b.getBytes()};d.bytesFromIPv6=function(a){var b=0;a=a.split(":").filter(function(a){return 0===a.length&&
++b,!0});for(var c=2*(8-a.length+b),f=d.createBuffer(),p=0;8>p;++p)if(a[p]&&0!==a[p].length){var h=d.hexToBytes(a[p]);2>h.length&&f.putByte(0);f.putBytes(h)}else f.fillWithByte(0,c),c=0;return f.getBytes()};d.bytesToIP=function(a){return 4===a.length?d.bytesToIPv4(a):16===a.length?d.bytesToIPv6(a):null};d.bytesToIPv4=function(a){if(4!==a.length)return null;for(var b=[],c=0;c<a.length;++c)b.push(a.charCodeAt(c));return b.join(".")};d.bytesToIPv6=function(a){if(16!==a.length)return null;for(var b=[],
c=[],f=0,p=0;p<a.length;p+=2){for(var h=d.bytesToHex(a[p]+a[p+1]);"0"===h[0]&&"0"!==h;)h=h.substr(1);if("0"===h){var g=c[c.length-1],n=b.length;g&&n===g.end+1?(g.end=n,g.end-g.start>c[f].end-c[f].start&&(f=c.length-1)):c.push({start:n,end:n})}b.push(h)}0<c.length&&(a=c[f],0<a.end-a.start&&(b.splice(a.start,a.end-a.start+1,""),0===a.start&&b.unshift(""),7===a.end&&b.push("")));return b.join(":")};d.estimateCores=function(a,b){function c(a,g,n){if(0===g){var l=Math.floor(a.reduce(function(a,b){return a+
b},0)/a.length);return d.cores=Math.max(1,l),URL.revokeObjectURL(h),b(null,d.cores)}f(n,function(b,f){a.push(p(n,f));c(a,g-1,n)})}function f(a,b){for(var c=[],p=[],d=0;d<a;++d){var g=new Worker(h);g.addEventListener("message",function(f){p.push(f.data);if(p.length===a){for(f=0;f<a;++f)c[f].terminate();b(null,p)}});c.push(g)}for(d=0;d<a;++d)c[d].postMessage(d)}function p(a,b){for(var c=[],f=0;f<a;++f)for(var p=b[f],h=c[f]=[],d=0;d<a;++d)if(f!==d){var g=b[d];(p.st>g.st&&p.st<g.et||g.st>p.st&&g.st<p.et)&&
h.push(d)}return c.reduce(function(a,b){return Math.max(a,b.length)},0)}"function"==typeof a&&(b=a,a={});a=a||{};if("cores"in d&&!a.update)return b(null,d.cores);if("undefined"!=typeof navigator&&"hardwareConcurrency"in navigator&&0<navigator.hardwareConcurrency)return d.cores=navigator.hardwareConcurrency,b(null,d.cores);if("undefined"==typeof Worker)return d.cores=1,b(null,d.cores);if("undefined"==typeof Blob)return d.cores=2,b(null,d.cores);var h=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",
function(a){a=Date.now();for(var b=a+4;Date.now()<b;);self.postMessage({st:a,et:b})})}.toString(),")()"],{type:"application/javascript"}));c([],5,16)}}if("function"!=typeof m){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),x(forge);var F=!0;m=function(a,e){e(G,module)}}var y,C=function(a,e){e.exports=function(d){var e=y.map(function(h){return a(h)}).concat(x);d=d||{};d.defined=d.defined||{};if(d.defined.util)return d.util;d.defined.util=!0;for(var g=0;g<e.length;++g)e[g](d);
return d.util}},t=m;m=function(a,e){return y="string"==typeof a?e.slice(2):a.slice(2),F?(delete m,t.apply(null,Array.prototype.slice.call(arguments,0))):(m=t,m.apply(null,Array.prototype.slice.call(arguments,0)))};m("js/util",["require","module"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function x(a){a.cipher=a.cipher||{};a.cipher.algorithms=a.cipher.algorithms||{};a.cipher.createCipher=function(d,e){var g=d;"string"==typeof g&&(g=a.cipher.getAlgorithm(g),g&&
(g=g()));if(!g)throw Error("Unsupported algorithm: "+d);return new a.cipher.BlockCipher({algorithm:g,key:e,decrypt:!1})};a.cipher.createDecipher=function(d,e){var g=d;"string"==typeof g&&(g=a.cipher.getAlgorithm(g),g&&(g=g()));if(!g)throw Error("Unsupported algorithm: "+d);return new a.cipher.BlockCipher({algorithm:g,key:e,decrypt:!0})};a.cipher.registerAlgorithm=function(d,e){d=d.toUpperCase();a.cipher.algorithms[d]=e};a.cipher.getAlgorithm=function(d){return d=d.toUpperCase(),d in a.cipher.algorithms?
a.cipher.algorithms[d]:null};var e=a.cipher.BlockCipher=function(a){this.algorithm=a.algorithm;this.mode=this.algorithm.mode;this.blockSize=this.mode.blockSize;this._finish=!1;this.output=this._input=null;this._op=a.decrypt?this.mode.decrypt:this.mode.encrypt;this._decrypt=a.decrypt;this.algorithm.initialize(a)};e.prototype.start=function(d){d=d||{};var e={},g;for(g in d)e[g]=d[g];e.decrypt=this._decrypt;this._finish=!1;this._input=a.util.createBuffer();this.output=d.output||a.util.createBuffer();
this.mode.start(e)};e.prototype.update=function(a){for(a&&this._input.putBuffer(a);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};e.prototype.finish=function(a){a&&("ECB"===this.mode.name||"CBC"===this.mode.name)&&(this.mode.pad=function(g){return a(this.blockSize,g,!1)},this.mode.unpad=function(g){return a(this.blockSize,g,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,this._decrypt||!this.mode.pad||
this.mode.pad(this._input,e)?(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e)?!1:this.mode.afterFinish&&!this.mode.afterFinish(this.output,e)?!1:!0):!1}}if("function"!=typeof m){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),x(forge);var F=!0;m=function(a,e){e(G,module)}}var y,C=function(a,e){e.exports=function(d){var e=y.map(function(h){return a(h)}).concat(x);d=d||{};d.defined=d.defined||{};if(d.defined.cipher)return d.cipher;
d.defined.cipher=!0;for(var g=0;g<e.length;++g)e[g](d);return d.cipher}},t=m;m=function(a,e){return y="string"==typeof a?e.slice(2):a.slice(2),F?(delete m,t.apply(null,Array.prototype.slice.call(arguments,0))):(m=t,m.apply(null,Array.prototype.slice.call(arguments,0)))};m("js/cipher",["require","module","./util"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function x(a){function e(h){"string"==typeof h&&(h=a.util.createBuffer(h));if(a.util.isArray(h)&&4<h.length){var c=
h;h=a.util.createBuffer();for(var b=0;b<c.length;++b)h.putByte(c[b])}return a.util.isArray(h)||(h=[h.getInt32(),h.getInt32(),h.getInt32(),h.getInt32()]),h}function d(a){a[a.length-1]=a[a.length-1]+1&4294967295}function k(a){return[a/4294967296|0,a&4294967295]}a.cipher=a.cipher||{};var g=a.cipher.modes=a.cipher.modes||{};g.ecb=function(a){a=a||{};this.name="ECB";this.cipher=a.cipher;this.blockSize=a.blockSize||16;this._ints=this.blockSize/4;this._inBlock=Array(this._ints);this._outBlock=Array(this._ints)};
g.ecb.prototype.start=function(a){};g.ecb.prototype.encrypt=function(a,c,b){if(a.length()<this.blockSize&&!(b&&0<a.length()))return!0;for(b=0;b<this._ints;++b)this._inBlock[b]=a.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(b=0;b<this._ints;++b)c.putInt32(this._outBlock[b])};g.ecb.prototype.decrypt=function(a,c,b){if(a.length()<this.blockSize&&!(b&&0<a.length()))return!0;for(b=0;b<this._ints;++b)this._inBlock[b]=a.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(b=
0;b<this._ints;++b)c.putInt32(this._outBlock[b])};g.ecb.prototype.pad=function(a,c){var b=a.length()===this.blockSize?this.blockSize:this.blockSize-a.length();return a.fillWithByte(b,b),!0};g.ecb.prototype.unpad=function(a,c){if(0<c.overflow)return!1;var b=a.length(),b=a.at(b-1);return b>this.blockSize<<2?!1:(a.truncate(b),!0)};g.cbc=function(a){a=a||{};this.name="CBC";this.cipher=a.cipher;this.blockSize=a.blockSize||16;this._ints=this.blockSize/4;this._inBlock=Array(this._ints);this._outBlock=Array(this._ints)};
g.cbc.prototype.start=function(a){if(null===a.iv){if(!this._prev)throw Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else{if(!("iv"in a))throw Error("Invalid IV parameter.");this._iv=e(a.iv);this._prev=this._iv.slice(0)}};g.cbc.prototype.encrypt=function(a,c,b){if(a.length()<this.blockSize&&!(b&&0<a.length()))return!0;for(b=0;b<this._ints;++b)this._inBlock[b]=this._prev[b]^a.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(b=0;b<this._ints;++b)c.putInt32(this._outBlock[b]);
this._prev=this._outBlock};g.cbc.prototype.decrypt=function(a,c,b){if(a.length()<this.blockSize&&!(b&&0<a.length()))return!0;for(b=0;b<this._ints;++b)this._inBlock[b]=a.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(b=0;b<this._ints;++b)c.putInt32(this._prev[b]^this._outBlock[b]);this._prev=this._inBlock.slice(0)};g.cbc.prototype.pad=function(a,c){var b=a.length()===this.blockSize?this.blockSize:this.blockSize-a.length();return a.fillWithByte(b,b),!0};g.cbc.prototype.unpad=function(a,
c){if(0<c.overflow)return!1;var b=a.length(),b=a.at(b-1);return b>this.blockSize<<2?!1:(a.truncate(b),!0)};g.cfb=function(h){h=h||{};this.name="CFB";this.cipher=h.cipher;this.blockSize=h.blockSize||16;this._ints=this.blockSize/4;this._inBlock=null;this._outBlock=Array(this._ints);this._partialBlock=Array(this._ints);this._partialOutput=a.util.createBuffer();this._partialBytes=0};g.cfb.prototype.start=function(a){if(!("iv"in a))throw Error("Invalid IV parameter.");this._iv=e(a.iv);this._inBlock=this._iv.slice(0);
this._partialBytes=0};g.cfb.prototype.encrypt=function(a,c,b){var d=a.length();if(0===d)return!0;this.cipher.encrypt(this._inBlock,this._outBlock);if(0===this._partialBytes&&d>=this.blockSize)for(var f=0;f<this._ints;++f)this._inBlock[f]=a.getInt32()^this._outBlock[f],c.putInt32(this._inBlock[f]);else{var g=(this.blockSize-d)%this.blockSize;0<g&&(g=this.blockSize-g);this._partialOutput.clear();for(f=0;f<this._ints;++f)this._partialBlock[f]=a.getInt32()^this._outBlock[f],this._partialOutput.putInt32(this._partialBlock[f]);
if(0<g)a.read-=this.blockSize;else for(f=0;f<this._ints;++f)this._inBlock[f]=this._partialBlock[f];0<this._partialBytes&&this._partialOutput.getBytes(this._partialBytes);if(0<g&&!b)return c.putBytes(this._partialOutput.getBytes(g-this._partialBytes)),this._partialBytes=g,!0;c.putBytes(this._partialOutput.getBytes(d-this._partialBytes));this._partialBytes=0}};g.cfb.prototype.decrypt=function(a,c,b){var d=a.length();if(0===d)return!0;this.cipher.encrypt(this._inBlock,this._outBlock);if(0===this._partialBytes&&
d>=this.blockSize)for(var f=0;f<this._ints;++f)this._inBlock[f]=a.getInt32(),c.putInt32(this._inBlock[f]^this._outBlock[f]);else{var g=(this.blockSize-d)%this.blockSize;0<g&&(g=this.blockSize-g);this._partialOutput.clear();for(f=0;f<this._ints;++f)this._partialBlock[f]=a.getInt32(),this._partialOutput.putInt32(this._partialBlock[f]^this._outBlock[f]);if(0<g)a.read-=this.blockSize;else for(f=0;f<this._ints;++f)this._inBlock[f]=this._partialBlock[f];0<this._partialBytes&&this._partialOutput.getBytes(this._partialBytes);
if(0<g&&!b)return c.putBytes(this._partialOutput.getBytes(g-this._partialBytes)),this._partialBytes=g,!0;c.putBytes(this._partialOutput.getBytes(d-this._partialBytes));this._partialBytes=0}};g.ofb=function(d){d=d||{};this.name="OFB";this.cipher=d.cipher;this.blockSize=d.blockSize||16;this._ints=this.blockSize/4;this._inBlock=null;this._outBlock=Array(this._ints);this._partialOutput=a.util.createBuffer();this._partialBytes=0};g.ofb.prototype.start=function(a){if(!("iv"in a))throw Error("Invalid IV parameter.");
this._iv=e(a.iv);this._inBlock=this._iv.slice(0);this._partialBytes=0};g.ofb.prototype.encrypt=function(a,c,b){var d=a.length();if(0===a.length())return!0;this.cipher.encrypt(this._inBlock,this._outBlock);if(0===this._partialBytes&&d>=this.blockSize)for(var f=0;f<this._ints;++f)c.putInt32(a.getInt32()^this._outBlock[f]),this._inBlock[f]=this._outBlock[f];else{var g=(this.blockSize-d)%this.blockSize;0<g&&(g=this.blockSize-g);this._partialOutput.clear();for(f=0;f<this._ints;++f)this._partialOutput.putInt32(a.getInt32()^
this._outBlock[f]);if(0<g)a.read-=this.blockSize;else for(f=0;f<this._ints;++f)this._inBlock[f]=this._outBlock[f];0<this._partialBytes&&this._partialOutput.getBytes(this._partialBytes);if(0<g&&!b)return c.putBytes(this._partialOutput.getBytes(g-this._partialBytes)),this._partialBytes=g,!0;c.putBytes(this._partialOutput.getBytes(d-this._partialBytes));this._partialBytes=0}};g.ofb.prototype.decrypt=g.ofb.prototype.encrypt;g.ctr=function(d){d=d||{};this.name="CTR";this.cipher=d.cipher;this.blockSize=
d.blockSize||16;this._ints=this.blockSize/4;this._inBlock=null;this._outBlock=Array(this._ints);this._partialOutput=a.util.createBuffer();this._partialBytes=0};g.ctr.prototype.start=function(a){if(!("iv"in a))throw Error("Invalid IV parameter.");this._iv=e(a.iv);this._inBlock=this._iv.slice(0);this._partialBytes=0};g.ctr.prototype.encrypt=function(a,c,b){var g=a.length();if(0===g)return!0;this.cipher.encrypt(this._inBlock,this._outBlock);if(0===this._partialBytes&&g>=this.blockSize)for(var f=0;f<
this._ints;++f)c.putInt32(a.getInt32()^this._outBlock[f]);else{var e=(this.blockSize-g)%this.blockSize;0<e&&(e=this.blockSize-e);this._partialOutput.clear();for(f=0;f<this._ints;++f)this._partialOutput.putInt32(a.getInt32()^this._outBlock[f]);0<e&&(a.read-=this.blockSize);0<this._partialBytes&&this._partialOutput.getBytes(this._partialBytes);if(0<e&&!b)return c.putBytes(this._partialOutput.getBytes(e-this._partialBytes)),this._partialBytes=e,!0;c.putBytes(this._partialOutput.getBytes(g-this._partialBytes));
this._partialBytes=0}d(this._inBlock)};g.ctr.prototype.decrypt=g.ctr.prototype.encrypt;g.gcm=function(d){d=d||{};this.name="GCM";this.cipher=d.cipher;this.blockSize=d.blockSize||16;this._ints=this.blockSize/4;this._inBlock=Array(this._ints);this._outBlock=Array(this._ints);this._partialOutput=a.util.createBuffer();this._partialBytes=0;this._R=3774873600};g.gcm.prototype.start=function(g){if(!("iv"in g))throw Error("Invalid IV parameter.");var c=a.util.createBuffer(g.iv);this._cipherLength=0;var b;
"additionalData"in g?b=a.util.createBuffer(g.additionalData):b=a.util.createBuffer();"tagLength"in g?this._tagLength=g.tagLength:this._tagLength=128;this._tag=null;if(g.decrypt&&(this._tag=a.util.createBuffer(g.tag).getBytes(),this._tag.length!==this._tagLength/8))throw Error("Authentication tag does not match tag length.");this._hashBlock=Array(this._ints);this.tag=null;this._hashSubkey=Array(this._ints);this.cipher.encrypt([0,0,0,0],this._hashSubkey);this.componentBits=4;this._m=this.generateHashTable(this._hashSubkey,
this.componentBits);g=c.length();if(12===g)this._j0=[c.getInt32(),c.getInt32(),c.getInt32(),1];else{for(this._j0=[0,0,0,0];0<c.length();)this._j0=this.ghash(this._hashSubkey,this._j0,[c.getInt32(),c.getInt32(),c.getInt32(),c.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(k(8*g)))}this._inBlock=this._j0.slice(0);d(this._inBlock);this._partialBytes=0;b=a.util.createBuffer(b);this._aDataLength=k(8*b.length());(c=b.length()%this.blockSize)&&b.fillWithByte(0,this.blockSize-c);
for(this._s=[0,0,0,0];0<b.length();)this._s=this.ghash(this._hashSubkey,this._s,[b.getInt32(),b.getInt32(),b.getInt32(),b.getInt32()])};g.gcm.prototype.encrypt=function(a,c,b){var g=a.length();if(0===g)return!0;this.cipher.encrypt(this._inBlock,this._outBlock);if(0===this._partialBytes&&g>=this.blockSize){for(var f=0;f<this._ints;++f)c.putInt32(this._outBlock[f]^=a.getInt32());this._cipherLength+=this.blockSize}else{var e=(this.blockSize-g)%this.blockSize;0<e&&(e=this.blockSize-e);this._partialOutput.clear();
for(f=0;f<this._ints;++f)this._partialOutput.putInt32(a.getInt32()^this._outBlock[f]);if(0===e||b){b?(f=g%this.blockSize,this._cipherLength+=f,this._partialOutput.truncate(this.blockSize-f)):this._cipherLength+=this.blockSize;for(f=0;f<this._ints;++f)this._outBlock[f]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}0<this._partialBytes&&this._partialOutput.getBytes(this._partialBytes);if(0<e&&!b)return a.read-=this.blockSize,c.putBytes(this._partialOutput.getBytes(e-this._partialBytes)),
this._partialBytes=e,!0;c.putBytes(this._partialOutput.getBytes(g-this._partialBytes));this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock);d(this._inBlock)};g.gcm.prototype.decrypt=function(a,c,b){var g=a.length();if(g<this.blockSize&&!(b&&0<g))return!0;this.cipher.encrypt(this._inBlock,this._outBlock);d(this._inBlock);this._hashBlock[0]=a.getInt32();this._hashBlock[1]=a.getInt32();this._hashBlock[2]=a.getInt32();this._hashBlock[3]=a.getInt32();this._s=this.ghash(this._hashSubkey,
this._s,this._hashBlock);for(a=0;a<this._ints;++a)c.putInt32(this._outBlock[a]^this._hashBlock[a]);g<this.blockSize?this._cipherLength+=g%this.blockSize:this._cipherLength+=this.blockSize};g.gcm.prototype.afterFinish=function(g,c){var b=!0;c.decrypt&&c.overflow&&g.truncate(this.blockSize-c.overflow);this.tag=a.util.createBuffer();var d=this._aDataLength.concat(k(8*this._cipherLength));this._s=this.ghash(this._hashSubkey,this._s,d);d=[];this.cipher.encrypt(this._j0,d);for(var f=0;f<this._ints;++f)this.tag.putInt32(this._s[f]^
d[f]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),c.decrypt&&this.tag.bytes()!==this._tag&&(b=!1),b};g.gcm.prototype.multiply=function(a,c){for(var b=[0,0,0,0],g=c.slice(0),f=0;128>f;++f)a[f/32|0]&1<<31-f%32&&(b[0]^=g[0],b[1]^=g[1],b[2]^=g[2],b[3]^=g[3]),this.pow(g,g);return b};g.gcm.prototype.pow=function(a,c){for(var b=a[3]&1,g=3;0<g;--g)c[g]=a[g]>>>1|(a[g-1]&1)<<31;c[0]=a[0]>>>1;b&&(c[0]^=this._R)};g.gcm.prototype.tableMultiply=function(a){for(var c=[0,0,0,0],b=0;32>b;++b){var g=
this._m[b][a[b/8|0]>>>4*(7-b%8)&15];c[0]^=g[0];c[1]^=g[1];c[2]^=g[2];c[3]^=g[3]}return c};g.gcm.prototype.ghash=function(a,c,b){return c[0]^=b[0],c[1]^=b[1],c[2]^=b[2],c[3]^=b[3],this.tableMultiply(c)};g.gcm.prototype.generateHashTable=function(a,c){for(var b=8/c,g=4*b,b=16*b,f=Array(b),d=0;d<b;++d){var e=[0,0,0,0];e[d/g|0]=1<<c-1<<(g-1-d%g)*c;f[d]=this.generateSubHashTable(this.multiply(e,a),c)}return f};g.gcm.prototype.generateSubHashTable=function(a,c){var b=1<<c,g=b>>>1,f=Array(b);f[g]=a.slice(0);
for(var d=g>>>1;0<d;)this.pow(f[2*d],f[d]=[]),d>>=1;for(d=2;d<g;){for(var e=1;e<d;++e){var q=f[d],k=f[e];f[d+e]=[q[0]^k[0],q[1]^k[1],q[2]^k[2],q[3]^k[3]]}d*=2}f[0]=[0,0,0,0];for(d=g+1;d<b;++d)e=f[d^g],f[d]=[a[0]^e[0],a[1]^e[1],a[2]^e[2],a[3]^e[3]];return f}}if("function"!=typeof m){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),x(forge);var F=!0;m=function(a,e){e(G,module)}}var y,C=function(a,e){e.exports=function(d){var e=y.map(function(g){return a(g)}).concat(x);
d=d||{};d.defined=d.defined||{};if(d.defined.cipherModes)return d.cipherModes;d.defined.cipherModes=!0;for(var g=0;g<e.length;++g)e[g](d);return d.cipherModes}},t=m;m=function(a,e){return y="string"==typeof a?e.slice(2):a.slice(2),F?(delete m,t.apply(null,Array.prototype.slice.call(arguments,0))):(m=t,m.apply(null,Array.prototype.slice.call(arguments,0)))};m("js/cipherModes",["require","module","./util"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function x(a){function e(b,
c){a.cipher.registerAlgorithm(b,function(){return new a.aes.Algorithm(b,c)})}function d(){c=!0;w=[0,1,2,4,8,16,32,64,128,27,54];for(var a=Array(256),b=0;128>b;++b)a[b]=b<<1,a[b+128]=b+128<<1^283;n=Array(256);f=Array(256);u=Array(4);q=Array(4);for(b=0;4>b;++b)u[b]=Array(256),q[b]=Array(256);for(var g=0,p=0,d,h,e,k,l,b=0;256>b;++b){k=p^p<<1^p<<2^p<<3^p<<4;k=k>>8^k&255^99;n[g]=k;f[k]=g;l=a[k];d=a[g];h=a[d];e=a[h];l^=l<<24^k<<16^k<<8^k;h=(d^h^e)<<24^(g^e)<<16^(g^h^e)<<8^g^d^e;for(var m=0;4>m;++m)u[m][g]=
l,q[m][k]=h,l=l<<24|l>>>8,h=h<<24|h>>>8;0===g?g=p=1:(g=d^a[a[a[d^e]]],p^=a[a[p]])}}function k(a,c){for(var f=a.slice(0),p,g=1,d=f.length,h=b*(d+6+1),e=d;e<h;++e)p=f[e-1],0===e%d?(p=n[p>>>16&255]<<24^n[p>>>8&255]<<16^n[p&255]<<8^n[p>>>24]^w[g]<<24,g++):6<d&&4===e%d&&(p=n[p>>>24]<<24^n[p>>>16&255]<<16^n[p>>>8&255]<<8^n[p&255]),f[e]=f[e-d]^p;if(c){for(var g=q[0],d=q[1],l=q[2],u=q[3],k=f.slice(0),h=f.length,e=0,B=h-b;e<h;e+=b,B-=b)if(0===e||e===h-b)k[e]=f[B],k[e+1]=f[B+3],k[e+2]=f[B+2],k[e+3]=f[B+1];
else for(var L=0;L<b;++L)p=f[B+L],k[e+(3&-L)]=g[n[p>>>24]]^d[n[p>>>16&255]]^l[n[p>>>8&255]]^u[n[p&255]];f=k}return f}function g(a,b,c,g){var d=a.length/4-1,h,e,k,l,w;g?(h=q[0],e=q[1],k=q[2],l=q[3],w=f):(h=u[0],e=u[1],k=u[2],l=u[3],w=n);var m,B,L,U,T,N;m=b[0]^a[0];B=b[g?3:1]^a[1];L=b[2]^a[2];b=b[g?1:3]^a[3];for(var M=3,y=1;y<d;++y)U=h[m>>>24]^e[B>>>16&255]^k[L>>>8&255]^l[b&255]^a[++M],T=h[B>>>24]^e[L>>>16&255]^k[b>>>8&255]^l[m&255]^a[++M],N=h[L>>>24]^e[b>>>16&255]^k[m>>>8&255]^l[B&255]^a[++M],b=h[b>>>
24]^e[m>>>16&255]^k[B>>>8&255]^l[L&255]^a[++M],m=U,B=T,L=N;c[0]=w[m>>>24]<<24^w[B>>>16&255]<<16^w[L>>>8&255]<<8^w[b&255]^a[++M];c[g?3:1]=w[B>>>24]<<24^w[L>>>16&255]<<16^w[b>>>8&255]<<8^w[m&255]^a[++M];c[2]=w[L>>>24]<<24^w[b>>>16&255]<<16^w[m>>>8&255]<<8^w[B&255]^a[++M];c[g?1:3]=w[b>>>24]<<24^w[m>>>16&255]<<16^w[B>>>8&255]<<8^w[L&255]^a[++M]}function h(b){b=b||{};var c="AES-"+(b.mode||"CBC").toUpperCase(),f;b.decrypt?f=a.cipher.createDecipher(c,b.key):f=a.cipher.createCipher(c,b.key);var g=f.start;
return f.start=function(b,c){var d=null;c instanceof a.util.ByteBuffer&&(d=c,c={});c=c||{};c.output=d;c.iv=b;g.call(f,c)},f}a.aes=a.aes||{};a.aes.startEncrypting=function(a,b,c,f){a=h({key:a,output:c,decrypt:!1,mode:f});return a.start(b),a};a.aes.createEncryptionCipher=function(a,b){return h({key:a,output:null,decrypt:!1,mode:b})};a.aes.startDecrypting=function(a,b,c,f){a=h({key:a,output:c,decrypt:!0,mode:f});return a.start(b),a};a.aes.createDecryptionCipher=function(a,b){return h({key:a,output:null,
decrypt:!0,mode:b})};a.aes.Algorithm=function(a,b){c||d();var f=this;f.name=a;f.mode=new b({blockSize:16,cipher:{encrypt:function(a,b){return g(f._w,a,b,!1)},decrypt:function(a,b){return g(f._w,a,b,!0)}}});f._init=!1};a.aes.Algorithm.prototype.initialize=function(b){if(!this._init){var c=b.key,f;if("string"!=typeof c||16!==c.length&&24!==c.length&&32!==c.length){if(a.util.isArray(c)&&(16===c.length||24===c.length||32===c.length)){f=c;for(var c=a.util.createBuffer(),g=0;g<f.length;++g)c.putByte(f[g])}}else c=
a.util.createBuffer(c);if(!a.util.isArray(c)){f=c;var c=[],d=f.length();if(16===d||24===d||32===d)for(d>>>=2,g=0;g<d;++g)c.push(f.getInt32())}if(!a.util.isArray(c)||4!==c.length&&6!==c.length&&8!==c.length)throw Error("Invalid key parameter.");f=-1!==["CFB","OFB","CTR","GCM"].indexOf(this.mode.name);this._w=k(c,b.decrypt&&!f);this._init=!0}};a.aes._expandKey=function(a,b){return c||d(),k(a,b)};a.aes._updateBlock=g;e("AES-ECB",a.cipher.modes.ecb);e("AES-CBC",a.cipher.modes.cbc);e("AES-CFB",a.cipher.modes.cfb);
e("AES-OFB",a.cipher.modes.ofb);e("AES-CTR",a.cipher.modes.ctr);e("AES-GCM",a.cipher.modes.gcm);var c=!1,b=4,n,f,w,u,q}if("function"!=typeof m){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),x(forge);var F=!0;m=function(a,e){e(G,module)}}var y,C=function(a,e){e.exports=function(d){var e=y.map(function(g){return a(g)}).concat(x);d=d||{};d.defined=d.defined||{};if(d.defined.aes)return d.aes;d.defined.aes=!0;for(var g=0;g<e.length;++g)e[g](d);return d.aes}},t=
m;m=function(a,e){return y="string"==typeof a?e.slice(2):a.slice(2),F?(delete m,t.apply(null,Array.prototype.slice.call(arguments,0))):(m=t,m.apply(null,Array.prototype.slice.call(arguments,0)))};m("js/aes",["require","module","./cipher","./cipherModes","./util"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function x(a){a.pki=a.pki||{};a=a.pki.oids=a.oids=a.oids||{};a["1.2.840.113549.1.1.1"]="rsaEncryption";a.rsaEncryption="1.2.840.113549.1.1.1";a["1.2.840.113549.1.1.4"]=
"md5WithRSAEncryption";a.md5WithRSAEncryption="1.2.840.113549.1.1.4";a["1.2.840.113549.1.1.5"]="sha1WithRSAEncryption";a.sha1WithRSAEncryption="1.2.840.113549.1.1.5";a["1.2.840.113549.1.1.7"]="RSAES-OAEP";a["RSAES-OAEP"]="1.2.840.113549.1.1.7";a["1.2.840.113549.1.1.8"]="mgf1";a.mgf1="1.2.840.113549.1.1.8";a["1.2.840.113549.1.1.9"]="pSpecified";a.pSpecified="1.2.840.113549.1.1.9";a["1.2.840.113549.1.1.10"]="RSASSA-PSS";a["RSASSA-PSS"]="1.2.840.113549.1.1.10";a["1.2.840.113549.1.1.11"]="sha256WithRSAEncryption";
a.sha256WithRSAEncryption="1.2.840.113549.1.1.11";a["1.2.840.113549.1.1.12"]="sha384WithRSAEncryption";a.sha384WithRSAEncryption="1.2.840.113549.1.1.12";a["1.2.840.113549.1.1.13"]="sha512WithRSAEncryption";a.sha512WithRSAEncryption="1.2.840.113549.1.1.13";a["1.3.14.3.2.7"]="desCBC";a.desCBC="1.3.14.3.2.7";a["1.3.14.3.2.26"]="sha1";a.sha1="1.3.14.3.2.26";a["2.16.840.1.101.3.4.2.1"]="sha256";a.sha256="2.16.840.1.101.3.4.2.1";a["2.16.840.1.101.3.4.2.2"]="sha384";a.sha384="2.16.840.1.101.3.4.2.2";a["2.16.840.1.101.3.4.2.3"]=
"sha512";a.sha512="2.16.840.1.101.3.4.2.3";a["1.2.840.113549.2.5"]="md5";a.md5="1.2.840.113549.2.5";a["1.2.840.113549.1.7.1"]="data";a.data="1.2.840.113549.1.7.1";a["1.2.840.113549.1.7.2"]="signedData";a.signedData="1.2.840.113549.1.7.2";a["1.2.840.113549.1.7.3"]="envelopedData";a.envelopedData="1.2.840.113549.1.7.3";a["1.2.840.113549.1.7.4"]="signedAndEnvelopedData";a.signedAndEnvelopedData="1.2.840.113549.1.7.4";a["1.2.840.113549.1.7.5"]="digestedData";a.digestedData="1.2.840.113549.1.7.5";a["1.2.840.113549.1.7.6"]=
"encryptedData";a.encryptedData="1.2.840.113549.1.7.6";a["1.2.840.113549.1.9.1"]="emailAddress";a.emailAddress="1.2.840.113549.1.9.1";a["1.2.840.113549.1.9.2"]="unstructuredName";a.unstructuredName="1.2.840.113549.1.9.2";a["1.2.840.113549.1.9.3"]="contentType";a.contentType="1.2.840.113549.1.9.3";a["1.2.840.113549.1.9.4"]="messageDigest";a.messageDigest="1.2.840.113549.1.9.4";a["1.2.840.113549.1.9.5"]="signingTime";a.signingTime="1.2.840.113549.1.9.5";a["1.2.840.113549.1.9.6"]="counterSignature";
a.counterSignature="1.2.840.113549.1.9.6";a["1.2.840.113549.1.9.7"]="challengePP";a.challengePP="1.2.840.113549.1.9.7";a["1.2.840.113549.1.9.8"]="unstructuredAddress";a.unstructuredAddress="1.2.840.113549.1.9.8";a["1.2.840.113549.1.9.14"]="extensionRequest";a.extensionRequest="1.2.840.113549.1.9.14";a["1.2.840.113549.1.9.20"]="friendlyName";a.friendlyName="1.2.840.113549.1.9.20";a["1.2.840.113549.1.9.21"]="localKeyId";a.localKeyId="1.2.840.113549.1.9.21";a["1.2.840.113549.1.9.22.1"]="x509Certificate";
a.x509Certificate="1.2.840.113549.1.9.22.1";a["1.2.840.113549.1.12.10.1.1"]="keyBag";a.keyBag="1.2.840.113549.1.12.10.1.1";a["1.2.840.113549.1.12.10.1.2"]="pkcs8ShroudedKeyBag";a.pkcs8ShroudedKeyBag="1.2.840.113549.1.12.10.1.2";a["1.2.840.113549.1.12.10.1.3"]="certBag";a.certBag="1.2.840.113549.1.12.10.1.3";a["1.2.840.113549.1.12.10.1.4"]="crlBag";a.crlBag="1.2.840.113549.1.12.10.1.4";a["1.2.840.113549.1.12.10.1.5"]="secretBag";a.secretBag="1.2.840.113549.1.12.10.1.5";a["1.2.840.113549.1.12.10.1.6"]=
"safeContentsBag";a.safeContentsBag="1.2.840.113549.1.12.10.1.6";a["1.2.840.113549.1.5.13"]="pkcs5PBES2";a.pkcs5PBES2="1.2.840.113549.1.5.13";a["1.2.840.113549.1.5.12"]="pkcs5PBKDF2";a.pkcs5PBKDF2="1.2.840.113549.1.5.12";a["1.2.840.113549.1.12.1.1"]="pbeWithSHAAnd128BitRC4";a.pbeWithSHAAnd128BitRC4="1.2.840.113549.1.12.1.1";a["1.2.840.113549.1.12.1.2"]="pbeWithSHAAnd40BitRC4";a.pbeWithSHAAnd40BitRC4="1.2.840.113549.1.12.1.2";a["1.2.840.113549.1.12.1.3"]="pbeWithSHAAnd3-KeyTripleDES-CBC";a["pbeWithSHAAnd3-KeyTripleDES-CBC"]=
"1.2.840.113549.1.12.1.3";a["1.2.840.113549.1.12.1.4"]="pbeWithSHAAnd2-KeyTripleDES-CBC";a["pbeWithSHAAnd2-KeyTripleDES-CBC"]="1.2.840.113549.1.12.1.4";a["1.2.840.113549.1.12.1.5"]="pbeWithSHAAnd128BitRC2-CBC";a["pbeWithSHAAnd128BitRC2-CBC"]="1.2.840.113549.1.12.1.5";a["1.2.840.113549.1.12.1.6"]="pbewithSHAAnd40BitRC2-CBC";a["pbewithSHAAnd40BitRC2-CBC"]="1.2.840.113549.1.12.1.6";a["1.2.840.113549.3.7"]="des-EDE3-CBC";a["des-EDE3-CBC"]="1.2.840.113549.3.7";a["2.16.840.1.101.3.4.1.2"]="aes128-CBC";
a["aes128-CBC"]="2.16.840.1.101.3.4.1.2";a["2.16.840.1.101.3.4.1.22"]="aes192-CBC";a["aes192-CBC"]="2.16.840.1.101.3.4.1.22";a["2.16.840.1.101.3.4.1.42"]="aes256-CBC";a["aes256-CBC"]="2.16.840.1.101.3.4.1.42";a["2.5.4.3"]="commonName";a.commonName="2.5.4.3";a["2.5.4.5"]="serialName";a.serialName="2.5.4.5";a["2.5.4.6"]="countryName";a.countryName="2.5.4.6";a["2.5.4.7"]="localityName";a.localityName="2.5.4.7";a["2.5.4.8"]="stateOrProvinceName";a.stateOrProvinceName="2.5.4.8";a["2.5.4.10"]="organizationName";
a.organizationName="2.5.4.10";a["2.5.4.11"]="organizationalUnitName";a.organizationalUnitName="2.5.4.11";a["2.16.840.1.113730.1.1"]="nsCertType";a.nsCertType="2.16.840.1.113730.1.1";a["2.5.29.1"]="authorityKeyIdentifier";a["2.5.29.2"]="keyAttributes";a["2.5.29.3"]="certificatePolicies";a["2.5.29.4"]="keyUsageRestriction";a["2.5.29.5"]="policyMapping";a["2.5.29.6"]="subtreesConstraint";a["2.5.29.7"]="subjectAltName";a["2.5.29.8"]="issuerAltName";a["2.5.29.9"]="subjectDirectoryAttributes";a["2.5.29.10"]=
"basicConstraints";a["2.5.29.11"]="nameConstraints";a["2.5.29.12"]="policyConstraints";a["2.5.29.13"]="basicConstraints";a["2.5.29.14"]="subjectKeyIdentifier";a.subjectKeyIdentifier="2.5.29.14";a["2.5.29.15"]="keyUsage";a.keyUsage="2.5.29.15";a["2.5.29.16"]="privateKeyUsagePeriod";a["2.5.29.17"]="subjectAltName";a.subjectAltName="2.5.29.17";a["2.5.29.18"]="issuerAltName";a.issuerAltName="2.5.29.18";a["2.5.29.19"]="basicConstraints";a.basicConstraints="2.5.29.19";a["2.5.29.20"]="cRLNumber";a["2.5.29.21"]=
"cRLReason";a["2.5.29.22"]="expirationDate";a["2.5.29.23"]="instructionCode";a["2.5.29.24"]="invalidityDate";a["2.5.29.25"]="cRLDistributionPoints";a["2.5.29.26"]="issuingDistributionPoint";a["2.5.29.27"]="deltaCRLIndicator";a["2.5.29.28"]="issuingDistributionPoint";a["2.5.29.29"]="certificateIssuer";a["2.5.29.30"]="nameConstraints";a["2.5.29.31"]="cRLDistributionPoints";a["2.5.29.32"]="certificatePolicies";a["2.5.29.33"]="policyMappings";a["2.5.29.34"]="policyConstraints";a["2.5.29.35"]="authorityKeyIdentifier";
a["2.5.29.36"]="policyConstraints";a["2.5.29.37"]="extKeyUsage";a.extKeyUsage="2.5.29.37";a["2.5.29.46"]="freshestCRL";a["2.5.29.54"]="inhibitAnyPolicy";a["1.3.6.1.5.5.7.3.1"]="serverAuth";a.serverAuth="1.3.6.1.5.5.7.3.1";a["1.3.6.1.5.5.7.3.2"]="clientAuth";a.clientAuth="1.3.6.1.5.5.7.3.2";a["1.3.6.1.5.5.7.3.3"]="codeSigning";a.codeSigning="1.3.6.1.5.5.7.3.3";a["1.3.6.1.5.5.7.3.4"]="emailProtection";a.emailProtection="1.3.6.1.5.5.7.3.4";a["1.3.6.1.5.5.7.3.8"]="timeStamping";a.timeStamping="1.3.6.1.5.5.7.3.8"}
if("function"!=typeof m){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),x(forge);var F=!0;m=function(a,e){e(G,module)}}var y,C=function(a,e){e.exports=function(d){var e=y.map(function(g){return a(g)}).concat(x);d=d||{};d.defined=d.defined||{};if(d.defined.oids)return d.oids;d.defined.oids=!0;for(var g=0;g<e.length;++g)e[g](d);return d.oids}},t=m;m=function(a,e){return y="string"==typeof a?e.slice(2):a.slice(2),F?(delete m,t.apply(null,Array.prototype.slice.call(arguments,
0))):(m=t,m.apply(null,Array.prototype.slice.call(arguments,0)))};m("js/oids",["require","module"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function x(a){var e=a.asn1=a.asn1||{};e.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};e.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,
BMPSTRING:30};e.create=function(g,d,c,b){if(a.util.isArray(b)){for(var e=[],f=0;f<b.length;++f)void 0!==b[f]&&e.push(b[f]);b=e}return{tagClass:g,type:d,constructed:c,composed:c||a.util.isArray(b),value:b}};var d=e.getBerValueLength=function(a){var d=a.getByte();if(128!==d){var c;return d&128?c=a.getInt((d&127)<<3):c=d,c}};e.fromDer=function(g,h){void 0===h&&(h=!0);"string"==typeof g&&(g=a.util.createBuffer(g));if(2>g.length()){var c=Error("Too few bytes to parse DER.");throw c.bytes=g.length(),c;
}var b=g.getByte(),c=b&192,n=b&31,f=d(g);if(g.length()<f){if(h)throw c=Error("Too few bytes to read ASN.1 value."),c.detail=g.length()+" < "+f,c;f=g.length()}var k,u=32===(b&32);k=u;if(!k&&c===e.Class.UNIVERSAL&&n===e.Type.BITSTRING&&1<f){var q=g.read;if(0===g.getByte()&&(b=g.getByte(),b&=192,b===e.Class.UNIVERSAL||b===e.Class.CONTEXT_SPECIFIC))try{(k=d(g)===f-(g.read-q))&&(++q,--f)}catch(v){}g.read=q}if(k)if(k=[],void 0===f)for(;;){if(g.bytes(2)===String.fromCharCode(0,0)){g.getBytes(2);break}k.push(e.fromDer(g,
h))}else for(q=g.length();0<f;)k.push(e.fromDer(g,h)),f-=q-g.length(),q=g.length();else{if(void 0===f){if(h)throw Error("Non-constructed ASN.1 object of indefinite length.");f=g.length()}if(n===e.Type.BMPSTRING)for(k="",q=0;q<f;q+=2)k+=String.fromCharCode(g.getInt16());else k=g.getBytes(f)}return e.create(c,n,u,k)};e.toDer=function(g){var d=a.util.createBuffer(),c=g.tagClass|g.type,b=a.util.createBuffer();if(g.composed){g.constructed?c|=32:b.putByte(0);for(var k=0;k<g.value.length;++k)void 0!==g.value[k]&&
b.putBuffer(e.toDer(g.value[k]))}else if(g.type===e.Type.BMPSTRING)for(k=0;k<g.value.length;++k)b.putInt16(g.value.charCodeAt(k));else b.putBytes(g.value);d.putByte(c);if(127>=b.length())d.putByte(b.length()&127);else{k=b.length();g="";do g+=String.fromCharCode(k&255),k>>>=8;while(0<k);d.putByte(g.length|128);for(k=g.length-1;0<=k;--k)d.putByte(g.charCodeAt(k))}return d.putBuffer(b),d};e.oidToDer=function(g){g=g.split(".");var d=a.util.createBuffer();d.putByte(40*parseInt(g[0],10)+parseInt(g[1],10));
for(var c,b,e,f,k=2;k<g.length;++k){c=!0;b=[];e=parseInt(g[k],10);do f=e&127,e>>>=7,c||(f|=128),b.push(f),c=!1;while(0<e);for(c=b.length-1;0<=c;--c)d.putByte(b[c])}return d};e.derToOid=function(g){var d;"string"==typeof g&&(g=a.util.createBuffer(g));var c=g.getByte();d=Math.floor(c/40)+"."+c%40;for(var b=0;0<g.length();)c=g.getByte(),b<<=7,c&128?b+=c&127:(d+="."+(b+c),b=0);return d};e.utcTimeToDate=function(a){var d=new Date,c=parseInt(a.substr(0,2),10),c=50<=c?1900+c:2E3+c,b=parseInt(a.substr(2,
2),10)-1,e=parseInt(a.substr(4,2),10),f=parseInt(a.substr(6,2),10),k=parseInt(a.substr(8,2),10),u=0;if(11<a.length){var q=a.charAt(10),v=10;"+"!==q&&"-"!==q&&(u=parseInt(a.substr(10,2),10),v+=2)}d.setUTCFullYear(c,b,e);d.setUTCHours(f,k,u,0);v&&(q=a.charAt(v),"+"===q||"-"===q)&&(c=parseInt(a.substr(v+1,2),10),a=parseInt(a.substr(v+4,2),10),a=6E4*(60*c+a),"+"===q?d.setTime(+d-a):d.setTime(+d+a));return d};e.generalizedTimeToDate=function(a){var d=new Date,c=parseInt(a.substr(0,4),10),b=parseInt(a.substr(4,
2),10)-1,e=parseInt(a.substr(6,2),10),f=parseInt(a.substr(8,2),10),k=parseInt(a.substr(10,2),10),u=parseInt(a.substr(12,2),10),q=0,v=0,J=!1;"Z"===a.charAt(a.length-1)&&(J=!0);var r=a.length-5,p=a.charAt(r);if("+"===p||"-"===p)v=parseInt(a.substr(r+1,2),10),r=parseInt(a.substr(r+4,2),10),v=6E4*(60*v+r),"+"===p&&(v*=-1),J=!0;return"."===a.charAt(14)&&(q=1E3*parseFloat(a.substr(14),10)),J?(d.setUTCFullYear(c,b,e),d.setUTCHours(f,k,u,q),d.setTime(+d+v)):(d.setFullYear(c,b,e),d.setHours(f,k,u,q)),d};e.dateToUtcTime=
function(a){if("string"==typeof a)return a;var d="",c=[];c.push((""+a.getUTCFullYear()).substr(2));c.push(""+(a.getUTCMonth()+1));c.push(""+a.getUTCDate());c.push(""+a.getUTCHours());c.push(""+a.getUTCMinutes());c.push(""+a.getUTCSeconds());for(a=0;a<c.length;++a)2>c[a].length&&(d+="0"),d+=c[a];return d+="Z",d};e.dateToGeneralizedTime=function(a){if("string"==typeof a)return a;var d="",c=[];c.push(""+a.getUTCFullYear());c.push(""+(a.getUTCMonth()+1));c.push(""+a.getUTCDate());c.push(""+a.getUTCHours());
c.push(""+a.getUTCMinutes());c.push(""+a.getUTCSeconds());for(a=0;a<c.length;++a)2>c[a].length&&(d+="0"),d+=c[a];return d+="Z",d};e.integerToDer=function(d){var e=a.util.createBuffer();if(-128<=d&&128>d)return e.putSignedInt(d,8);if(-32768<=d&&32768>d)return e.putSignedInt(d,16);if(-8388608<=d&&8388608>d)return e.putSignedInt(d,24);if(-2147483648<=d&&2147483648>d)return e.putSignedInt(d,32);e=Error("Integer too large; max is 32-bits.");throw e.integer=d,e;};e.derToInteger=function(d){"string"==typeof d&&
(d=a.util.createBuffer(d));var e=8*d.length();if(32<e)throw Error("Integer too large; max is 32-bits.");return d.getSignedInt(e)};e.validate=function(d,h,c,b){var k=!1;if(d.tagClass!==h.tagClass&&"undefined"!=typeof h.tagClass||d.type!==h.type&&"undefined"!=typeof h.type)b&&(d.tagClass!==h.tagClass&&b.push("["+h.name+'] Expected tag class "'+h.tagClass+'", got "'+d.tagClass+'"'),d.type!==h.type&&b.push("["+h.name+'] Expected type "'+h.type+'", got "'+d.type+'"'));else if(d.constructed===h.constructed||
"undefined"==typeof h.constructed){k=!0;if(h.value&&a.util.isArray(h.value))for(var f=0,w=0;k&&w<h.value.length;++w)k=h.value[w].optional||!1,d.value[f]&&(k=e.validate(d.value[f],h.value[w],c,b),k?++f:h.value[w].optional&&(k=!0)),!k&&b&&b.push("["+h.name+'] Tag class "'+h.tagClass+'", type "'+h.type+'" expected value length "'+h.value.length+'", got "'+d.value.length+'"');k&&c&&(h.capture&&(c[h.capture]=d.value),h.captureAsn1&&(c[h.captureAsn1]=d))}else b&&b.push("["+h.name+'] Expected constructed "'+
h.constructed+'", got "'+d.constructed+'"');return k};var k=/[^\\u0000-\\u00ff]/;e.prettyPrint=function(d,h,c){var b="";h=h||0;c=c||2;0<h&&(b+="\n");for(var n="",f=0;f<h*c;++f)n+=" ";b+=n+"Tag: ";switch(d.tagClass){case e.Class.UNIVERSAL:b+="Universal:";break;case e.Class.APPLICATION:b+="Application:";break;case e.Class.CONTEXT_SPECIFIC:b+="Context-Specific:";break;case e.Class.PRIVATE:b+="Private:"}if(d.tagClass===e.Class.UNIVERSAL)switch(b+=d.type,d.type){case e.Type.NONE:b+=" (None)";break;case e.Type.BOOLEAN:b+=
" (Boolean)";break;case e.Type.BITSTRING:b+=" (Bit string)";break;case e.Type.INTEGER:b+=" (Integer)";break;case e.Type.OCTETSTRING:b+=" (Octet string)";break;case e.Type.NULL:b+=" (Null)";break;case e.Type.OID:b+=" (Object Identifier)";break;case e.Type.ODESC:b+=" (Object Descriptor)";break;case e.Type.EXTERNAL:b+=" (External or Instance of)";break;case e.Type.REAL:b+=" (Real)";break;case e.Type.ENUMERATED:b+=" (Enumerated)";break;case e.Type.EMBEDDED:b+=" (Embedded PDV)";break;case e.Type.UTF8:b+=
" (UTF8)";break;case e.Type.ROID:b+=" (Relative Object Identifier)";break;case e.Type.SEQUENCE:b+=" (Sequence)";break;case e.Type.SET:b+=" (Set)";break;case e.Type.PRINTABLESTRING:b+=" (Printable String)";break;case e.Type.IA5String:b+=" (IA5String (ASCII))";break;case e.Type.UTCTIME:b+=" (UTC time)";break;case e.Type.GENERALIZEDTIME:b+=" (Generalized time)";break;case e.Type.BMPSTRING:b+=" (BMP String)"}else b+=d.type;b=b+"\n"+(n+"Constructed: "+d.constructed+"\n");if(d.composed){for(var w=0,u="",
f=0;f<d.value.length;++f)void 0!==d.value[f]&&(w+=1,u+=e.prettyPrint(d.value[f],h+1,c),f+1<d.value.length&&(u+=","));b+=n+"Sub values: "+w+u}else if(b+=n+"Value: ",d.type===e.Type.OID&&(h=e.derToOid(d.value),b+=h,a.pki&&a.pki.oids&&h in a.pki.oids&&(b+=" ("+a.pki.oids[h]+") ")),d.type===e.Type.INTEGER)try{b+=e.derToInteger(d.value)}catch(q){b+="0x"+a.util.bytesToHex(d.value)}else d.type===e.Type.OCTETSTRING?(k.test(d.value)||(b+="("+d.value+") "),b+="0x"+a.util.bytesToHex(d.value)):d.type===e.Type.UTF8?
b+=a.util.decodeUtf8(d.value):d.type===e.Type.PRINTABLESTRING||d.type===e.Type.IA5String?b+=d.value:k.test(d.value)?b+="0x"+a.util.bytesToHex(d.value):0===d.value.length?b+="[null]":b+=d.value;return b}}if("function"!=typeof m){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),x(forge);var F=!0;m=function(a,e){e(G,module)}}var y,C=function(a,e){e.exports=function(d){var e=y.map(function(d){return a(d)}).concat(x);d=d||{};d.defined=d.defined||{};if(d.defined.asn1)return d.asn1;
d.defined.asn1=!0;for(var g=0;g<e.length;++g)e[g](d);return d.asn1}},t=m;m=function(a,e){return y="string"==typeof a?e.slice(2):a.slice(2),F?(delete m,t.apply(null,Array.prototype.slice.call(arguments,0))):(m=t,m.apply(null,Array.prototype.slice.call(arguments,0)))};m("js/asn1",["require","module","./util","./oids"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function x(a){function e(){g=String.fromCharCode(128);g+=a.util.fillString(String.fromCharCode(0),64);
h=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9];c=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21];b=Array(64);for(var f=0;64>f;++f)b[f]=Math.floor(4294967296*Math.abs(Math.sin(f+1)));n=!0}function d(a,d,g){for(var e,k,n,r,p,H,z,A=g.length();64<=A;){k=a.h0;n=a.h1;r=a.h2;
p=a.h3;for(z=0;16>z;++z)d[z]=g.getInt32Le(),e=p^n&(r^p),e=k+e+b[z]+d[z],H=c[z],k=p,p=r,r=n,n+=e<<H|e>>>32-H;for(;32>z;++z)e=r^p&(n^r),e=k+e+b[z]+d[h[z]],H=c[z],k=p,p=r,r=n,n+=e<<H|e>>>32-H;for(;48>z;++z)e=n^r^p,e=k+e+b[z]+d[h[z]],H=c[z],k=p,p=r,r=n,n+=e<<H|e>>>32-H;for(;64>z;++z)e=r^(n|~p),e=k+e+b[z]+d[h[z]],H=c[z],k=p,p=r,r=n,n+=e<<H|e>>>32-H;a.h0=a.h0+k|0;a.h1=a.h1+n|0;a.h2=a.h2+r|0;a.h3=a.h3+p|0;A-=64}}var k=a.md5=a.md5||{};a.md=a.md||{};a.md.algorithms=a.md.algorithms||{};a.md.md5=a.md.algorithms.md5=
k;k.create=function(){n||e();var b=null,c=a.util.createBuffer(),h=Array(16),k={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,messageLength64:[0,0]};return k.start=function(){return k.messageLength=0,k.messageLength64=[0,0],c=a.util.createBuffer(),b={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},k},k.start(),k.update=function(g,e){return"utf8"===e&&(g=a.util.encodeUtf8(g)),k.messageLength+=g.length,k.messageLength64[0]+=g.length/4294967296>>>0,k.messageLength64[1]+=g.length>>>
0,c.putBytes(g),d(b,h,c),(2048<c.read||0===c.length())&&c.compact(),k},k.digest=function(){var e=a.util.createBuffer();e.putBytes(c.bytes());e.putBytes(g.substr(0,64-(k.messageLength64[1]+8&63)));e.putInt32Le(k.messageLength64[1]<<3);e.putInt32Le(k.messageLength64[0]<<3|k.messageLength64[0]>>>28);var n={h0:b.h0,h1:b.h1,h2:b.h2,h3:b.h3};d(n,h,e);e=a.util.createBuffer();return e.putInt32Le(n.h0),e.putInt32Le(n.h1),e.putInt32Le(n.h2),e.putInt32Le(n.h3),e},k};var g=null,h=null,c=null,b=null,n=!1}if("function"!=
typeof m){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),x(forge);var F=!0;m=function(a,e){e(G,module)}}var y,C=function(a,e){e.exports=function(d){var e=y.map(function(d){return a(d)}).concat(x);d=d||{};d.defined=d.defined||{};if(d.defined.md5)return d.md5;d.defined.md5=!0;for(var g=0;g<e.length;++g)e[g](d);return d.md5}},t=m;m=function(a,e){return y="string"==typeof a?e.slice(2):a.slice(2),F?(delete m,t.apply(null,Array.prototype.slice.call(arguments,0))):
(m=t,m.apply(null,Array.prototype.slice.call(arguments,0)))};m("js/md5",["require","module","./util"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function x(a){function e(a,c,b){for(var d,f,g,e,k,v,J,r,p=b.length();64<=p;){f=a.h0;g=a.h1;e=a.h2;k=a.h3;v=a.h4;for(r=0;16>r;++r)d=b.getInt32(),c[r]=d,J=k^g&(e^k),d=(f<<5|f>>>27)+J+v+1518500249+d,v=k,k=e,e=g<<30|g>>>2,g=f,f=d;for(;20>r;++r)d=c[r-3]^c[r-8]^c[r-14]^c[r-16],d=d<<1|d>>>31,c[r]=d,J=k^g&(e^k),d=(f<<5|f>>>27)+
J+v+1518500249+d,v=k,k=e,e=g<<30|g>>>2,g=f,f=d;for(;32>r;++r)d=c[r-3]^c[r-8]^c[r-14]^c[r-16],d=d<<1|d>>>31,c[r]=d,J=g^e^k,d=(f<<5|f>>>27)+J+v+1859775393+d,v=k,k=e,e=g<<30|g>>>2,g=f,f=d;for(;40>r;++r)d=c[r-6]^c[r-16]^c[r-28]^c[r-32],d=d<<2|d>>>30,c[r]=d,J=g^e^k,d=(f<<5|f>>>27)+J+v+1859775393+d,v=k,k=e,e=g<<30|g>>>2,g=f,f=d;for(;60>r;++r)d=c[r-6]^c[r-16]^c[r-28]^c[r-32],d=d<<2|d>>>30,c[r]=d,J=g&e|k&(g^e),d=(f<<5|f>>>27)+J+v+2400959708+d,v=k,k=e,e=g<<30|g>>>2,g=f,f=d;for(;80>r;++r)d=c[r-6]^c[r-16]^c[r-
28]^c[r-32],d=d<<2|d>>>30,c[r]=d,J=g^e^k,d=(f<<5|f>>>27)+J+v+3395469782+d,v=k,k=e,e=g<<30|g>>>2,g=f,f=d;a.h0=a.h0+f|0;a.h1=a.h1+g|0;a.h2=a.h2+e|0;a.h3=a.h3+k|0;a.h4=a.h4+v|0;p-=64}}var d=a.sha1=a.sha1||{};a.md=a.md||{};a.md.algorithms=a.md.algorithms||{};a.md.sha1=a.md.algorithms.sha1=d;d.create=function(){g||(k=String.fromCharCode(128),k+=a.util.fillString(String.fromCharCode(0),64),g=!0);var d=null,c=a.util.createBuffer(),b=Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,
messageLength64:[0,0]};return n.start=function(){return n.messageLength=0,n.messageLength64=[0,0],c=a.util.createBuffer(),d={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(f,g){return"utf8"===g&&(f=a.util.encodeUtf8(f)),n.messageLength+=f.length,n.messageLength64[0]+=f.length/4294967296>>>0,n.messageLength64[1]+=f.length>>>0,c.putBytes(f),e(d,b,c),(2048<c.read||0===c.length())&&c.compact(),n},n.digest=function(){var f=a.util.createBuffer();f.putBytes(c.bytes());
f.putBytes(k.substr(0,64-(n.messageLength64[1]+8&63)));f.putInt32(n.messageLength64[0]<<3|n.messageLength64[0]>>>28);f.putInt32(n.messageLength64[1]<<3);var g={h0:d.h0,h1:d.h1,h2:d.h2,h3:d.h3,h4:d.h4};e(g,b,f);f=a.util.createBuffer();return f.putInt32(g.h0),f.putInt32(g.h1),f.putInt32(g.h2),f.putInt32(g.h3),f.putInt32(g.h4),f},n};var k=null,g=!1}if("function"!=typeof m){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),x(forge);var F=!0;m=function(a,e){e(G,module)}}var y,
C=function(a,e){e.exports=function(d){var e=y.map(function(d){return a(d)}).concat(x);d=d||{};d.defined=d.defined||{};if(d.defined.sha1)return d.sha1;d.defined.sha1=!0;for(var g=0;g<e.length;++g)e[g](d);return d.sha1}},t=m;m=function(a,e){return y="string"==typeof a?e.slice(2):a.slice(2),F?(delete m,t.apply(null,Array.prototype.slice.call(arguments,0))):(m=t,m.apply(null,Array.prototype.slice.call(arguments,0)))};m("js/sha1",["require","module","./util"],function(){C.apply(null,Array.prototype.slice.call(arguments,
0))})}(),function(){function x(a){function e(a,b,d){for(var f,g,e,k,v,J,r,p,H,z,A,m,l,E=d.length();64<=E;){for(v=0;16>v;++v)b[v]=d.getInt32();for(;64>v;++v)f=b[v-2],f=(f>>>17|f<<15)^(f>>>19|f<<13)^f>>>10,g=b[v-15],g=(g>>>7|g<<25)^(g>>>18|g<<14)^g>>>3,b[v]=f+b[v-7]+g+b[v-16]|0;J=a.h0;r=a.h1;p=a.h2;H=a.h3;z=a.h4;A=a.h5;m=a.h6;l=a.h7;for(v=0;64>v;++v)f=(z>>>6|z<<26)^(z>>>11|z<<21)^(z>>>25|z<<7),e=m^z&(A^m),g=(J>>>2|J<<30)^(J>>>13|J<<19)^(J>>>22|J<<10),k=J&r|p&(J^r),f=l+f+e+h[v]+b[v],g+=k,l=m,m=A,A=z,
z=H+f|0,H=p,p=r,r=J,J=f+g|0;a.h0=a.h0+J|0;a.h1=a.h1+r|0;a.h2=a.h2+p|0;a.h3=a.h3+H|0;a.h4=a.h4+z|0;a.h5=a.h5+A|0;a.h6=a.h6+m|0;a.h7=a.h7+l|0;E-=64}}var d=a.sha256=a.sha256||{};a.md=a.md||{};a.md.algorithms=a.md.algorithms||{};a.md.sha256=a.md.algorithms.sha256=d;d.create=function(){g||(k=String.fromCharCode(128),k+=a.util.fillString(String.fromCharCode(0),64),h=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,
2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,
2428436474,2756734187,3204031479,3329325298],g=!0);var c=null,b=a.util.createBuffer(),d=Array(64),f={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,messageLength64:[0,0]};return f.start=function(){return f.messageLength=0,f.messageLength64=[0,0],b=a.util.createBuffer(),c={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},f},f.start(),f.update=function(g,k){return"utf8"===k&&(g=a.util.encodeUtf8(g)),f.messageLength+=g.length,
f.messageLength64[0]+=g.length/4294967296>>>0,f.messageLength64[1]+=g.length>>>0,b.putBytes(g),e(c,d,b),(2048<b.read||0===b.length())&&b.compact(),f},f.digest=function(){var g=a.util.createBuffer();g.putBytes(b.bytes());g.putBytes(k.substr(0,64-(f.messageLength64[1]+8&63)));g.putInt32(f.messageLength64[0]<<3|f.messageLength64[0]>>>28);g.putInt32(f.messageLength64[1]<<3);var h={h0:c.h0,h1:c.h1,h2:c.h2,h3:c.h3,h4:c.h4,h5:c.h5,h6:c.h6,h7:c.h7};e(h,d,g);g=a.util.createBuffer();return g.putInt32(h.h0),
g.putInt32(h.h1),g.putInt32(h.h2),g.putInt32(h.h3),g.putInt32(h.h4),g.putInt32(h.h5),g.putInt32(h.h6),g.putInt32(h.h7),g},f};var k=null,g=!1,h=null}if("function"!=typeof m){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),x(forge);var F=!0;m=function(a,e){e(G,module)}}var y,C=function(a,e){e.exports=function(d){var e=y.map(function(d){return a(d)}).concat(x);d=d||{};d.defined=d.defined||{};if(d.defined.sha256)return d.sha256;d.defined.sha256=!0;for(var g=0;g<
e.length;++g)e[g](d);return d.sha256}},t=m;m=function(a,e){return y="string"==typeof a?e.slice(2):a.slice(2),F?(delete m,t.apply(null,Array.prototype.slice.call(arguments,0))):(m=t,m.apply(null,Array.prototype.slice.call(arguments,0)))};m("js/sha256",["require","module","./util"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function x(a){function e(a,b,d){for(var g,e,h,k,r,p,H,z,A,m,l,E,K,B,L,U,T,N,M,y,t,x,P,O,R,V=d.length();128<=V;){for(R=0;16>R;++R)b[R][0]=d.getInt32()>>>
0,b[R][1]=d.getInt32()>>>0;for(;80>R;++R)r=b[R-2],A=r[0],r=r[1],g=((A>>>19|r<<13)^(r>>>29|A<<3)^A>>>6)>>>0,e=((A<<13|r>>>19)^(r<<3|A>>>29)^(A<<26|r>>>6))>>>0,r=b[R-15],A=r[0],r=r[1],h=((A>>>1|r<<31)^(A>>>8|r<<24)^A>>>7)>>>0,k=((A<<31|r>>>1)^(A<<24|r>>>8)^(A<<25|r>>>7))>>>0,A=b[R-7],m=b[R-16],r=e+A[1]+k+m[1],b[R][0]=g+A[0]+h+m[0]+(r/4294967296>>>0)>>>0,b[R][1]=r>>>0;A=a[0][0];m=a[0][1];l=a[1][0];E=a[1][1];K=a[2][0];B=a[2][1];L=a[3][0];U=a[3][1];T=a[4][0];N=a[4][1];M=a[5][0];y=a[5][1];t=a[6][0];x=a[6][1];
P=a[7][0];O=a[7][1];for(R=0;80>R;++R)g=((T>>>14|N<<18)^(T>>>18|N<<14)^(N>>>9|T<<23))>>>0,r=((T<<18|N>>>14)^(T<<14|N>>>18)^(N<<23|T>>>9))>>>0,e=(t^T&(M^t))>>>0,p=(x^N&(y^x))>>>0,h=((A>>>28|m<<4)^(m>>>2|A<<30)^(m>>>7|A<<25))>>>0,k=((A<<4|m>>>28)^(m<<30|A>>>2)^(m<<25|A>>>7))>>>0,H=(A&l|K&(A^l))>>>0,z=(m&E|B&(m^E))>>>0,r=O+r+p+c[R][1]+b[R][1],g=P+g+e+c[R][0]+b[R][0]+(r/4294967296>>>0)>>>0,e=r>>>0,r=k+z,h=h+H+(r/4294967296>>>0)>>>0,k=r>>>0,P=t,O=x,t=M,x=y,M=T,y=N,r=U+e,T=L+g+(r/4294967296>>>0)>>>0,N=r>>>
0,L=K,U=B,K=l,B=E,l=A,E=m,r=e+k,A=g+h+(r/4294967296>>>0)>>>0,m=r>>>0;r=a[0][1]+m;a[0][0]=a[0][0]+A+(r/4294967296>>>0)>>>0;a[0][1]=r>>>0;r=a[1][1]+E;a[1][0]=a[1][0]+l+(r/4294967296>>>0)>>>0;a[1][1]=r>>>0;r=a[2][1]+B;a[2][0]=a[2][0]+K+(r/4294967296>>>0)>>>0;a[2][1]=r>>>0;r=a[3][1]+U;a[3][0]=a[3][0]+L+(r/4294967296>>>0)>>>0;a[3][1]=r>>>0;r=a[4][1]+N;a[4][0]=a[4][0]+T+(r/4294967296>>>0)>>>0;a[4][1]=r>>>0;r=a[5][1]+y;a[5][0]=a[5][0]+M+(r/4294967296>>>0)>>>0;a[5][1]=r>>>0;r=a[6][1]+x;a[6][0]=a[6][0]+t+
(r/4294967296>>>0)>>>0;a[6][1]=r>>>0;r=a[7][1]+O;a[7][0]=a[7][0]+P+(r/4294967296>>>0)>>>0;a[7][1]=r>>>0;V-=128}}var d=a.sha512=a.sha512||{};a.md=a.md||{};a.md.algorithms=a.md.algorithms||{};a.md.sha512=a.md.algorithms.sha512=d;var k=a.sha384=a.sha512.sha384=a.sha512.sha384||{};k.create=function(){return d.create("SHA-384")};a.md.sha384=a.md.algorithms.sha384=k;a.sha512.sha256=a.sha512.sha256||{create:function(){return d.create("SHA-512/256")}};a.md["sha512/256"]=a.md.algorithms["sha512/256"]=a.sha512.sha256;
a.sha512.sha224=a.sha512.sha224||{create:function(){return d.create("SHA-512/224")}};a.md["sha512/224"]=a.md.algorithms["sha512/224"]=a.sha512.sha224;d.create=function(d){h||(g=String.fromCharCode(128),g+=a.util.fillString(String.fromCharCode(0),128),c=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,
1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],
[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,
3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],
[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],b={"SHA-512":[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],"SHA-384":[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,
3204075428]],"SHA-512/256":[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],"SHA-512/224":[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]]},h=!0);"undefined"==typeof d&&(d="SHA-512");if(d in b){for(var f=b[d],k=null,u=a.util.createBuffer(),
q=Array(80),v=0;80>v;++v)q[v]=Array(2);var J={algorithm:d.replace("-","").toLowerCase(),blockLength:128,digestLength:64,messageLength:0,messageLength128:[0,0,0,0]};return J.start=function(){J.messageLength=0;J.messageLength128=[0,0,0,0];u=a.util.createBuffer();k=Array(f.length);for(var b=0;b<f.length;++b)k[b]=f[b].slice(0);return J},J.start(),J.update=function(b,c){"utf8"===c&&(b=a.util.encodeUtf8(b));J.messageLength+=b.length;for(var f=b.length,f=[f/4294967296>>>0,f>>>0],d=3;0<=d;--d)J.messageLength128[d]+=
f[1],f[1]=f[0]+(J.messageLength128[d]/4294967296>>>0),J.messageLength128[d]>>>=0,f[0]=f[1]/4294967296>>>0;return u.putBytes(b),e(k,q,u),(2048<u.read||0===u.length())&&u.compact(),J},J.digest=function(){var b=a.util.createBuffer();b.putBytes(u.bytes());b.putBytes(g.substr(0,128-(J.messageLength128[3]+16&127)));for(var c=[],f=0;3>f;++f)c[f]=J.messageLength128[f]<<3|J.messageLength128[f-1]>>>28;c[3]=J.messageLength128[3]<<3;b.putInt32(c[0]);b.putInt32(c[1]);b.putInt32(c[2]);b.putInt32(c[3]);c=Array(k.length);
for(f=0;f<k.length;++f)c[f]=k[f].slice(0);e(c,q,b);var b=a.util.createBuffer(),h;"SHA-512"===d?h=c.length:"SHA-384"===d?h=c.length-2:h=c.length-4;for(f=0;f<h;++f)b.putInt32(c[f][0]),f===h-1&&"SHA-512/224"===d||b.putInt32(c[f][1]);return b},J}throw Error("Invalid SHA-512 algorithm: "+d);};var g=null,h=!1,c=null,b=null}if("function"!=typeof m){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),x(forge);var F=!0;m=function(a,e){e(G,module)}}var y,C=function(a,e){e.exports=
function(d){var e=y.map(function(d){return a(d)}).concat(x);d=d||{};d.defined=d.defined||{};if(d.defined.sha512)return d.sha512;d.defined.sha512=!0;for(var g=0;g<e.length;++g)e[g](d);return d.sha512}},t=m;m=function(a,e){return y="string"==typeof a?e.slice(2):a.slice(2),F?(delete m,t.apply(null,Array.prototype.slice.call(arguments,0))):(m=t,m.apply(null,Array.prototype.slice.call(arguments,0)))};m("js/sha512",["require","module","./util"],function(){C.apply(null,Array.prototype.slice.call(arguments,
0))})}(),function(){function x(a){a.md=a.md||{};a.md.algorithms={md5:a.md5,sha1:a.sha1,sha256:a.sha256};a.md.md5=a.md5;a.md.sha1=a.sha1;a.md.sha256=a.sha256}if("function"!=typeof m){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),x(forge);var F=!0;m=function(a,e){e(G,module)}}var y,C=function(a,e){e.exports=function(d){var e=y.map(function(d){return a(d)}).concat(x);d=d||{};d.defined=d.defined||{};if(d.defined.md)return d.md;d.defined.md=!0;for(var g=0;g<e.length;++g)e[g](d);
return d.md}},t=m;m=function(a,e){return y="string"==typeof a?e.slice(2):a.slice(2),F?(delete m,t.apply(null,Array.prototype.slice.call(arguments,0))):(m=t,m.apply(null,Array.prototype.slice.call(arguments,0)))};m("js/md","require module ./md5 ./sha1 ./sha256 ./sha512".split(" "),function(){C.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function x(a){(a.hmac=a.hmac||{}).create=function(){var e=null,d=null,k=null,g={};return g.start=function(g,c){if(null!==g)if("string"==typeof g){g=
g.toLowerCase();if(!(g in a.md.algorithms))throw Error('Unknown hash algorithm "'+g+'"');e=a.md.algorithms[g].create()}else e=g;if(null!==c){if("string"==typeof c)c=a.util.createBuffer(c);else if(a.util.isArray(c)){var b=c;c=a.util.createBuffer();for(var n=0;n<b.length;++n)c.putByte(b[n])}var f=c.length();f>e.blockLength&&(e.start(),e.update(c.bytes()),c=e.digest());d=a.util.createBuffer();k=a.util.createBuffer();f=c.length();for(n=0;n<f;++n)b=c.at(n),d.putByte(54^b),k.putByte(92^b);if(f<e.blockLength)for(b=
e.blockLength-f,n=0;n<b;++n)d.putByte(54),k.putByte(92);d=d.bytes();k=k.bytes()}e.start();e.update(d)},g.update=function(a){e.update(a)},g.getMac=function(){var a=e.digest().bytes();return e.start(),e.update(k),e.update(a),e.digest()},g.digest=g.getMac,g}}if("function"!=typeof m){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),x(forge);var F=!0;m=function(a,e){e(G,module)}}var y,C=function(a,e){e.exports=function(d){var e=y.map(function(d){return a(d)}).concat(x);
d=d||{};d.defined=d.defined||{};if(d.defined.hmac)return d.hmac;d.defined.hmac=!0;for(var g=0;g<e.length;++g)e[g](d);return d.hmac}},t=m;m=function(a,e){return y="string"==typeof a?e.slice(2):a.slice(2),F?(delete m,t.apply(null,Array.prototype.slice.call(arguments,0))):(m=t,m.apply(null,Array.prototype.slice.call(arguments,0)))};m("js/hmac",["require","module","./md","./util"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function x(a){function e(a){for(var d=a.name+
": ",e=[],c=function(a,b){return" "+b},b=0;b<a.values.length;++b)e.push(a.values[b].replace(/^(\S+\r\n)/,c));d+=e.join(",")+"\r\n";e=0;a=-1;for(b=0;b<d.length;++b,++e)if(65<e&&-1!==a)e=d[a],","===e?(++a,d=d.substr(0,a)+"\r\n "+d.substr(a)):d=d.substr(0,a)+"\r\n"+e+d.substr(a+1),e=b-a-1,a=-1,++b;else if(" "===d[b]||"\t"===d[b]||","===d[b])a=b;return d}var d=a.pem=a.pem||{};d.encode=function(d,g){g=g||{};var h="-----BEGIN "+d.type+"-----\r\n",c;d.procType&&(c={name:"Proc-Type",values:[String(d.procType.version),
d.procType.type]},h+=e(c));d.contentDomain&&(c={name:"Content-Domain",values:[d.contentDomain]},h+=e(c));d.dekInfo&&(c={name:"DEK-Info",values:[d.dekInfo.algorithm]},d.dekInfo.parameters&&c.values.push(d.dekInfo.parameters),h+=e(c));if(d.headers)for(c=0;c<d.headers.length;++c)h+=e(d.headers[c]);return d.procType&&(h+="\r\n"),h+=a.util.encode64(d.body,g.maxline||64)+"\r\n",h+="-----END "+d.type+"-----\r\n",h};d.decode=function(d){for(var g=[],e=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,
c=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,b=/\r?\n/,n;;){n=e.exec(d);if(!n)break;var f={type:n[1],procType:null,contentDomain:null,dekInfo:null,headers:[],body:a.util.decode64(n[3])};g.push(f);if(n[2]){for(var w=n[2].split(b),u=0;n&&u<w.length;){n=w[u].replace(/\s+$/,"");for(var q=u+1;q<w.length;++q){var v=w[q];if(!/\s/.test(v[0]))break;n+=v;u=q}if(n=n.match(c)){for(var q={name:n[1],values:[]},v=n[2].split(","),J=0;J<v.length;++J)q.values.push(v[J].replace(/^\s+/,""));if(f.procType)if(f.contentDomain||
"Content-Domain"!==q.name)if(f.dekInfo||"DEK-Info"!==q.name)f.headers.push(q);else{if(0===q.values.length)throw Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');f.dekInfo={algorithm:v[0],parameters:v[1]||null}}else f.contentDomain=v[0]||"";else{if("Proc-Type"!==q.name)throw Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(2!==q.values.length)throw Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');
f.procType={version:v[0],type:v[1]}}}++u}if("ENCRYPTED"===f.procType&&!f.dekInfo)throw Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".');}}if(0===g.length)throw Error("Invalid PEM formatted message.");return g}}if("function"!=typeof m){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),x(forge);var F=!0;m=function(a,e){e(G,module)}}var y,C=function(a,e){e.exports=function(d){var e=y.map(function(d){return a(d)}).concat(x);
d=d||{};d.defined=d.defined||{};if(d.defined.pem)return d.pem;d.defined.pem=!0;for(var g=0;g<e.length;++g)e[g](d);return d.pem}},t=m;m=function(a,e){return y="string"==typeof a?e.slice(2):a.slice(2),F?(delete m,t.apply(null,Array.prototype.slice.call(arguments,0))):(m=t,m.apply(null,Array.prototype.slice.call(arguments,0)))};m("js/pem",["require","module","./util"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function x(a){function e(b,c){a.cipher.registerAlgorithm(b,
function(){return new a.des.Algorithm(b,c)})}function d(a,d,e,k){var p=32===a.length?3:9,H;3===p?H=k?[30,-2,-2]:[0,32,2]:H=k?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];k=d[0];var z=d[1];d=(k>>>4^z)&252645135;z^=d;k^=d<<4;d=(k>>>16^z)&65535;z^=d;k^=d<<16;d=(z>>>2^k)&858993459;k^=d;z^=d<<2;d=(z>>>8^k)&16711935;k^=d;z^=d<<8;d=(k>>>1^z)&1431655765;z^=d;k^=d<<1;k=k<<1|k>>>31;for(var z=z<<1|z>>>31,A=0;A<p;A+=3){for(var m=H[A+1],l=H[A+2],E=H[A];E!=m;E+=l){var K=z^a[E],B=(z>>>4|z<<28)^a[E+1];d=
k;k=z;z=d^(h[K>>>24&63]|b[K>>>16&63]|f[K>>>8&63]|u[K&63]|g[B>>>24&63]|c[B>>>16&63]|n[B>>>8&63]|w[B&63])}d=k;k=z;z=d}k=k>>>1|k<<31;z=z>>>1|z<<31;d=(k>>>1^z)&1431655765;z^=d;k^=d<<1;d=(z>>>8^k)&16711935;k^=d;z^=d<<8;d=(z>>>2^k)&858993459;k^=d;z^=d<<2;d=(k>>>16^z)&65535;z^=d;k^=d<<16;d=(k>>>4^z)&252645135;e[0]=k^d<<4;e[1]=z^d}function k(b){b=b||{};var c="DES-"+(b.mode||"CBC").toUpperCase(),d;b.decrypt?d=a.cipher.createDecipher(c,b.key):d=a.cipher.createCipher(c,b.key);var f=d.start;return d.start=function(b,
c){var g=null;c instanceof a.util.ByteBuffer&&(g=c,c={});c=c||{};c.output=g;c.iv=b;f.call(d,c)},d}a.des=a.des||{};a.des.startEncrypting=function(a,b,c,d){a=k({key:a,output:c,decrypt:!1,mode:d||(null===b?"ECB":"CBC")});return a.start(b),a};a.des.createEncryptionCipher=function(a,b){return k({key:a,output:null,decrypt:!1,mode:b})};a.des.startDecrypting=function(a,b,c,d){a=k({key:a,output:c,decrypt:!0,mode:d||(null===b?"ECB":"CBC")});return a.start(b),a};a.des.createDecryptionCipher=function(a,b){return k({key:a,
output:null,decrypt:!0,mode:b})};a.des.Algorithm=function(a,b){var c=this;c.name=a;c.mode=new b({blockSize:8,cipher:{encrypt:function(a,b){return d(c._keys,a,b,!1)},decrypt:function(a,b){return d(c._keys,a,b,!0)}}});c._init=!1};a.des.Algorithm.prototype.initialize=function(b){if(!this._init){b=a.util.createBuffer(b.key);if(0===this.name.indexOf("3DES")&&24!==b.length())throw Error("Invalid Triple-DES key size: "+8*b.length());for(var c=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,
516,536871424,536871428,66048,66052,536936960,536936964],d=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],f=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],g=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],e=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],
k=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],h=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],u=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],l=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],n=[0,268435456,8,268435464,0,268435456,
8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],w=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],B=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],L=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],U=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],m=8<b.length()?3:
1,N=[],M=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],y=0,t,x=0;x<m;x++){var P=b.getInt32(),O=b.getInt32();t=(P>>>4^O)&252645135;O^=t;P^=t<<4;t=(O>>>-16^P)&65535;P^=t;O^=t<<-16;t=(P>>>2^O)&858993459;O^=t;P^=t<<2;t=(O>>>-16^P)&65535;P^=t;O^=t<<-16;t=(P>>>1^O)&1431655765;O^=t;P^=t<<1;t=(O>>>8^P)&16711935;P^=t;O^=t<<8;t=(P>>>1^O)&1431655765;O^=t;P^=t<<1;t=P<<8|O>>>20&240;for(var P=O<<24|O<<8&16711680|O>>>8&65280|O>>>24&240,O=t,R=0;R<M.length;++R){M[R]?(P=P<<2|P>>>26,O=O<<2|O>>>26):(P=P<<1|P>>>27,O=O<<1|O>>>27);
var P=P&-15,O=O&-15,V=c[P>>>28]|d[P>>>24&15]|f[P>>>20&15]|g[P>>>16&15]|e[P>>>12&15]|k[P>>>8&15]|h[P>>>4&15],Y=u[O>>>28]|l[O>>>24&15]|n[O>>>20&15]|w[O>>>16&15]|B[O>>>12&15]|L[O>>>8&15]|U[O>>>4&15];t=(Y>>>16^V)&65535;N[y++]=V^t;N[y++]=Y^t<<16}}this._keys=N;this._init=!0}};e("DES-ECB",a.cipher.modes.ecb);e("DES-CBC",a.cipher.modes.cbc);e("DES-CFB",a.cipher.modes.cfb);e("DES-OFB",a.cipher.modes.ofb);e("DES-CTR",a.cipher.modes.ctr);e("3DES-ECB",a.cipher.modes.ecb);e("3DES-CBC",a.cipher.modes.cbc);e("3DES-CFB",
a.cipher.modes.cfb);e("3DES-OFB",a.cipher.modes.ofb);e("3DES-CTR",a.cipher.modes.ctr);var g=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,
0,65540,66560,0,16842756],h=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,
-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],c=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,
8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],b=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],n=[256,34078976,34078720,1107296512,
524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,
524288,0,1074266112,34078976,1073742080],f=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,
4194320,536887312,0,541081600,536870912,4194320,536887312],w=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,
67108866,67110912,2048,2097154],u=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,
268435456,268701696]}if("function"!=typeof m){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),x(forge);var F=!0;m=function(a,e){e(G,module)}}var y,C=function(a,e){e.exports=function(d){var e=y.map(function(d){return a(d)}).concat(x);d=d||{};d.defined=d.defined||{};if(d.defined.des)return d.des;d.defined.des=!0;for(var g=0;g<e.length;++g)e[g](d);return d.des}},t=m;m=function(a,e){return y="string"==typeof a?e.slice(2):a.slice(2),F?(delete m,t.apply(null,Array.prototype.slice.call(arguments,
0))):(m=t,m.apply(null,Array.prototype.slice.call(arguments,0)))};m("js/des",["require","module","./cipher","./cipherModes","./util"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function x(a){var e=a.pkcs5=a.pkcs5||{},d="undefined"!=typeof process&&process.versions&&process.versions.node,k;d&&!a.disableNativeCode&&(k=G("crypto"));a.pbkdf2=e.pbkdf2=function(g,e,c,b,n,f){function w(){if(m>v)return f(null,p);r.start(null,null);r.update(e);r.update(a.util.int32ToBytes(m));
H=A=r.digest().getBytes();l=2;u()}function u(){if(l<=c)return r.start(null,null),r.update(A),z=r.digest().getBytes(),H=a.util.xorBytes(H,z,q),A=z,++l,a.util.setImmediate(u);p+=m<v?H:H.substr(0,J);++m;w()}"function"==typeof n&&(f=n,n=null);if(d&&!a.disableNativeCode&&k.pbkdf2&&(null===n||"object"!=typeof n)&&(4<k.pbkdf2Sync.length||!n||"sha1"===n))return"string"!=typeof n&&(n="sha1"),e=new Buffer(e,"binary"),f?4===k.pbkdf2Sync.length?k.pbkdf2(g,e,c,b,function(a,b){if(a)return f(a);f(null,b.toString("binary"))}):
k.pbkdf2(g,e,c,b,n,function(a,b){if(a)return f(a);f(null,b.toString("binary"))}):4===k.pbkdf2Sync.length?k.pbkdf2Sync(g,e,c,b).toString("binary"):k.pbkdf2Sync(g,e,c,b,n).toString("binary");if("undefined"==typeof n||null===n)n=a.md.sha1.create();if("string"==typeof n){if(!(n in a.md.algorithms))throw Error("Unknown hash algorithm: "+n);n=a.md[n].create()}var q=n.digestLength;if(b>4294967295*q){g=Error("Derived key is too long.");if(f)return f(g);throw g;}var v=Math.ceil(b/q),J=b-(v-1)*q,r=a.hmac.create();
r.start(n,g);var p="",H,z,A;if(!f){for(var m=1;m<=v;++m){r.start(null,null);r.update(e);r.update(a.util.int32ToBytes(m));H=A=r.digest().getBytes();for(var l=2;l<=c;++l)r.start(null,null),r.update(A),z=r.digest().getBytes(),H=a.util.xorBytes(H,z,q),A=z;p+=m<v?H:H.substr(0,J)}return p}m=1;w()}}if("function"!=typeof m){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),x(forge);var F=!0;m=function(a,e){e(G,module)}}var y,C=function(a,e){e.exports=function(d){var e=
y.map(function(d){return a(d)}).concat(x);d=d||{};d.defined=d.defined||{};if(d.defined.pbkdf2)return d.pbkdf2;d.defined.pbkdf2=!0;for(var g=0;g<e.length;++g)e[g](d);return d.pbkdf2}},t=m;m=function(a,e){return y="string"==typeof a?e.slice(2):a.slice(2),F?(delete m,t.apply(null,Array.prototype.slice.call(arguments,0))):(m=t,m.apply(null,Array.prototype.slice.call(arguments,0)))};m("js/pbkdf2",["require","module","./hmac","./md","./util"],function(){C.apply(null,Array.prototype.slice.call(arguments,
0))})}(),function(){function x(a){var e="undefined"!=typeof process&&process.versions&&process.versions.node,d=null;!a.disableNativeCode&&e&&!process.versions["node-webkit"]&&(d=G("crypto"));(a.prng=a.prng||{}).create=function(e){function g(a){if(32<=b.pools[0].messageLength)return h(),a();b.seedFile(32-b.pools[0].messageLength<<5,function(c,d){if(c)return a(c);b.collect(d);h();a()})}function h(){var a=b.plugin.md.create();a.update(b.pools[0].digest().getBytes());b.pools[0].start();for(var c=1,d=
1;32>d;++d)c=31===c?2147483648:c<<2,0===c%b.reseeds&&(a.update(b.pools[d].digest().getBytes()),b.pools[d].start());c=a.digest().getBytes();a.start();a.update(c);a=a.digest().getBytes();b.key=b.plugin.formatKey(c);b.seed=b.plugin.formatSeed(a);b.reseeds=4294967295===b.reseeds?0:b.reseeds+1;b.generated=0}function c(b){var c=null;if("undefined"!=typeof window){var d=window.crypto||window.msCrypto;d&&d.getRandomValues&&(c=function(a){return d.getRandomValues(a)})}var f=a.util.createBuffer();if(c)for(;f.length()<
b;){var g=Math.max(1,Math.min(b-f.length(),65536)/4),e=new Uint32Array(Math.floor(g));try{for(c(e),g=0;g<e.length;++g)f.putInt32(e[g])}catch(p){if(!("undefined"!=typeof QuotaExceededError&&p instanceof QuotaExceededError))throw p;}}if(f.length()<b)for(c=Math.floor(13282.910588546147);f.length()<b;)for(g=16807*(c&65535),c=16807*(c>>16),g+=(c&32767)<<16,g+=c>>15,g=(g&2147483647)+(g>>31),c=g&4294967295,g=0;3>g;++g)e=c>>>(g<<3),e^=Math.floor(51.886369486508386),f.putByte(String.fromCharCode(e&255));return f.getBytes(b)}
var b={plugin:e,key:null,seed:null,time:null,reseeds:0,generated:0};e=e.md;for(var n=Array(32),f=0;32>f;++f)n[f]=e.create();return b.pools=n,b.pool=0,b.generate=function(c,d){function f(z){if(z)return d(z);if(H.length()>=c)return d(null,H.getBytes(c));1048575<b.generated&&(b.key=null);if(null===b.key)return a.util.nextTick(function(){g(f)});z=e(b.key,b.seed);b.generated+=z.length;H.putBytes(z);b.key=h(e(b.key,k(b.seed)));b.seed=p(e(b.key,b.seed));a.util.setImmediate(f)}if(!d)return b.generateSync(c);
var e=b.plugin.cipher,k=b.plugin.increment,h=b.plugin.formatKey,p=b.plugin.formatSeed,H=a.util.createBuffer();b.key=null;f()},b.generateSync=function(c){var d=b.plugin.cipher,f=b.plugin.increment,g=b.plugin.formatKey,e=b.plugin.formatSeed;b.key=null;for(var k=a.util.createBuffer();k.length()<c;){1048575<b.generated&&(b.key=null);null===b.key&&(32<=b.pools[0].messageLength||b.collect(b.seedFileSync(32-b.pools[0].messageLength<<5)),h());var p=d(b.key,b.seed);b.generated+=p.length;k.putBytes(p);b.key=
g(d(b.key,f(b.seed)));b.seed=e(d(b.key,b.seed))}return k.getBytes(c)},d?(b.seedFile=function(a,b){d.randomBytes(a,function(a,c){if(a)return b(a);b(null,c.toString())})},b.seedFileSync=function(a){return d.randomBytes(a).toString()}):(b.seedFile=function(a,b){try{b(null,c(a))}catch(d){b(d)}},b.seedFileSync=c),b.collect=function(a){for(var c=a.length,d=0;d<c;++d)b.pools[b.pool].update(a.substr(d,1)),b.pool=31===b.pool?0:b.pool+1},b.collectInt=function(a,c){for(var d="",f=0;f<c;f+=8)d+=String.fromCharCode(a>>
f&255);b.collect(d)},b.registerWorker=function(a){a===self?b.seedFile=function(a,b){function c(a){a=a.data;a.forge&&a.forge.prng&&(self.removeEventListener("message",c),b(a.forge.prng.err,a.forge.prng.bytes))}self.addEventListener("message",c);self.postMessage({forge:{prng:{needed:a}}})}:a.addEventListener("message",function(c){c=c.data;c.forge&&c.forge.prng&&b.seedFile(c.forge.prng.needed,function(b,c){a.postMessage({forge:{prng:{err:b,bytes:c}}})})})},b}}if("function"!=typeof m){if("object"!=typeof module||
!module.exports)return"undefined"==typeof forge&&(forge={}),x(forge);var F=!0;m=function(a,e){e(G,module)}}var y,C=function(a,e){e.exports=function(d){var e=y.map(function(d){return a(d)}).concat(x);d=d||{};d.defined=d.defined||{};if(d.defined.prng)return d.prng;d.defined.prng=!0;for(var g=0;g<e.length;++g)e[g](d);return d.prng}},t=m;m=function(a,e){return y="string"==typeof a?e.slice(2):a.slice(2),F?(delete m,t.apply(null,Array.prototype.slice.call(arguments,0))):(m=t,m.apply(null,Array.prototype.slice.call(arguments,
0)))};m("js/prng",["require","module","./md","./util"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function x(a){a.random&&a.random.getBytes||function(e){function d(){var b=a.prng.create(k);return b.getBytes=function(a,c){return b.generate(a,c)},b.getBytesSync=function(a){return b.generate(a)},b}var k={},g=Array(4),h=a.util.createBuffer();k.formatKey=function(b){var c=a.util.createBuffer(b);return b=Array(4),b[0]=c.getInt32(),b[1]=c.getInt32(),b[2]=c.getInt32(),
b[3]=c.getInt32(),a.aes._expandKey(b,!1)};k.formatSeed=function(b){var c=a.util.createBuffer(b);return b=Array(4),b[0]=c.getInt32(),b[1]=c.getInt32(),b[2]=c.getInt32(),b[3]=c.getInt32(),b};k.cipher=function(b,c){return a.aes._updateBlock(b,c,g,!1),h.putInt32(g[0]),h.putInt32(g[1]),h.putInt32(g[2]),h.putInt32(g[3]),h.getBytes()};k.increment=function(a){return++a[3],a};k.md=a.md.sha256;var c=d(),b="undefined"!=typeof process&&process.versions&&process.versions.node,n=null;if("undefined"!=typeof window){var f=
window.crypto||window.msCrypto;f&&f.getRandomValues&&(n=function(a){return f.getRandomValues(a)})}if(a.disableNativeCode||!b&&!n){"undefined"==typeof window||void 0===window.document;c.collectInt(+new Date,32);if("undefined"!=typeof navigator){var b="",w;for(w in navigator)try{"string"==typeof navigator[w]&&(b+=navigator[w])}catch(u){}c.collect(b);b=null}e&&(e().mousemove(function(a){c.collectInt(a.clientX,16);c.collectInt(a.clientY,16)}),e().keypress(function(a){c.collectInt(a.charCode,8)}))}if(a.random)for(w in c)a.random[w]=
c[w];else a.random=c;a.random.createInstance=d}("undefined"!=typeof jQuery?jQuery:null)}if("function"!=typeof m){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),x(forge);var F=!0;m=function(a,e){e(G,module)}}var y,C=function(a,e){e.exports=function(d){var e=y.map(function(d){return a(d)}).concat(x);d=d||{};d.defined=d.defined||{};if(d.defined.random)return d.random;d.defined.random=!0;for(var g=0;g<e.length;++g)e[g](d);return d.random}},t=m;m=function(a,e){return y=
"string"==typeof a?e.slice(2):a.slice(2),F?(delete m,t.apply(null,Array.prototype.slice.call(arguments,0))):(m=t,m.apply(null,Array.prototype.slice.call(arguments,0)))};m("js/random","require module ./aes ./md ./prng ./util".split(" "),function(){C.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function x(a){var e=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,
129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,
2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],d=[1,2,3,5];a.rc2=a.rc2||{};a.rc2.expandKey=function(d,k){"string"==typeof d&&(d=a.util.createBuffer(d));k=k||128;var c=d,b=d.length(),n=k,f=Math.ceil(n/8),n=255>>(n&7),w;for(w=b;128>w;w++)c.putByte(e[c.at(w-1)+c.at(w-b)&255]);c.setAt(128-f,e[c.at(128-
f)&n]);for(w=127-f;0<=w;w--)c.setAt(w,e[c.at(w+1)^c.at(w+f)]);return c};var k=function(g,e,c){var b=!1,k=null,f=null,w=null,u,q,v,m,r=[];g=a.rc2.expandKey(g,e);for(v=0;64>v;v++)r.push(g.getInt16Le());c?(u=function(a){for(v=0;4>v;v++){a[v]+=r[m]+(a[(v+3)%4]&a[(v+2)%4])+(~a[(v+3)%4]&a[(v+1)%4]);var b=a[v],c=d[v];a[v]=b<<c&65535|(b&65535)>>16-c;m++}},q=function(a){for(v=0;4>v;v++)a[v]+=r[a[(v+3)%4]&63]}):(u=function(a){for(v=3;0<=v;v--){var b=a[v],c=d[v];a[v]=(b&65535)>>c|b<<16-c&65535;a[v]-=r[m]+(a[(v+
3)%4]&a[(v+2)%4])+(~a[(v+3)%4]&a[(v+1)%4]);m--}},q=function(a){for(v=3;0<=v;v--)a[v]-=r[a[(v+3)%4]&63]});var p=null;return p={start:function(c,d){c&&"string"==typeof c&&(c=a.util.createBuffer(c));b=!1;k=a.util.createBuffer();f=d||new a.util.createBuffer;w=c;p.output=f},update:function(a){for(b||k.putBuffer(a);8<=k.length();){a=[[5,u],[1,q],[6,u],[1,q],[5,u]];var d=[];for(v=0;4>v;v++){var g=k.getInt16Le();null!==w&&(c?g^=w.getInt16Le():w.putInt16Le(g));d.push(g&65535)}m=c?0:63;for(g=0;g<a.length;g++)for(var e=
0;e<a[g][0];e++)a[g][1](d);for(v=0;4>v;v++)null!==w&&(c?w.putInt16Le(d[v]):d[v]^=w.getInt16Le()),f.putInt16Le(d[v])}},finish:function(a){var d=!0;if(c)if(a)d=a(8,k,!c);else{var g=8===k.length()?8:8-k.length();k.fillWithByte(g,g)}d&&(b=!0,p.update());!c&&(d=0===k.length())&&(a?d=a(8,f,!c):(a=f.length(),g=f.at(a-1),g>a?d=!1:f.truncate(g)));return d}},p};a.rc2.startEncrypting=function(d,e,c){d=a.rc2.createEncryptionCipher(d,128);return d.start(e,c),d};a.rc2.createEncryptionCipher=function(a,d){return k(a,
d,!0)};a.rc2.startDecrypting=function(d,e,c){d=a.rc2.createDecryptionCipher(d,128);return d.start(e,c),d};a.rc2.createDecryptionCipher=function(a,d){return k(a,d,!1)}}if("function"!=typeof m){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),x(forge);var F=!0;m=function(a,e){e(G,module)}}var y,C=function(a,e){e.exports=function(d){var e=y.map(function(d){return a(d)}).concat(x);d=d||{};d.defined=d.defined||{};if(d.defined.rc2)return d.rc2;d.defined.rc2=!0;for(var g=
0;g<e.length;++g)e[g](d);return d.rc2}},t=m;m=function(a,e){return y="string"==typeof a?e.slice(2):a.slice(2),F?(delete m,t.apply(null,Array.prototype.slice.call(arguments,0))):(m=t,m.apply(null,Array.prototype.slice.call(arguments,0)))};m("js/rc2",["require","module","./util"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function x(a){function e(a,b,c){this.data=[];null!=a&&("number"==typeof a?this.fromNumber(a,b,c):null==b&&"string"!=typeof a?this.fromString(a,
256):this.fromString(a,b))}function d(){return new e(null)}function k(a,b,c,d,f,g){for(;0<=--g;){var e=b*this.data[a++]+c.data[d]+f;f=Math.floor(e/67108864);c.data[d++]=e&67108863}return f}function g(a,b,c,d,f,g){var e=b&32767;for(b>>=15;0<=--g;){var p=this.data[a]&32767,k=this.data[a++]>>15,l=b*p+k*e,p=e*p+((l&32767)<<15)+c.data[d]+(f&1073741823);f=(p>>>30)+(l>>>15)+b*k+(f>>>30);c.data[d++]=p&1073741823}return f}function h(a,b,c,d,f,g){var e=b&16383;for(b>>=14;0<=--g;){var p=this.data[a]&16383,k=
this.data[a++]>>14,l=b*p+k*e,p=e*p+((l&16383)<<14)+c.data[d]+f;f=(p>>28)+(l>>14)+b*k;c.data[d++]=p&268435455}return f}function c(a,b){var c=W[a.charCodeAt(b)];return null==c?-1:c}function b(a){var b=d();return b.fromInt(a),b}function n(a){var b=1,c;return 0!=(c=a>>>16)&&(a=c,b+=16),0!=(c=a>>8)&&(a=c,b+=8),0!=(c=a>>4)&&(a=c,b+=4),0!=(c=a>>2)&&(a=c,b+=2),0!=a>>1&&(b+=1),b}function f(a){this.m=a}function w(a){this.m=a;this.mp=a.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<a.DB-
15)-1;this.mt2=2*a.t}function u(a,b){return a&b}function q(a,b){return a|b}function v(a,b){return a^b}function m(a,b){return a&~b}function r(){}function p(a){return a}function H(a){this.r2=d();this.q3=d();e.ONE.dlShiftTo(2*a.t,this.r2);this.mu=this.r2.divide(a);this.m=a}function z(){return{nextBytes:function(a){for(var b=0;b<a.length;++b)a[b]=Math.floor(51.886369486508386)}}}var A;"undefined"==typeof navigator?(e.prototype.am=h,A=28):"Microsoft Internet Explorer"==navigator.appName?(e.prototype.am=
g,A=30):"Netscape"!=navigator.appName?(e.prototype.am=k,A=26):(e.prototype.am=h,A=28);e.prototype.DB=A;e.prototype.DM=(1<<A)-1;e.prototype.DV=1<<A;e.prototype.FV=Math.pow(2,52);e.prototype.F1=52-A;e.prototype.F2=2*A-52;var W=[],l;A=48;for(l=0;9>=l;++l)W[A++]=l;A=97;for(l=10;36>l;++l)W[A++]=l;A=65;for(l=10;36>l;++l)W[A++]=l;f.prototype.convert=function(a){return 0>a.s||0<=a.compareTo(this.m)?a.mod(this.m):a};f.prototype.revert=function(a){return a};f.prototype.reduce=function(a){a.divRemTo(this.m,
null,a)};f.prototype.mulTo=function(a,b,c){a.multiplyTo(b,c);this.reduce(c)};f.prototype.sqrTo=function(a,b){a.squareTo(b);this.reduce(b)};w.prototype.convert=function(a){var b=d();return a.abs().dlShiftTo(this.m.t,b),b.divRemTo(this.m,null,b),0>a.s&&0<b.compareTo(e.ZERO)&&this.m.subTo(b,b),b};w.prototype.revert=function(a){var b=d();return a.copyTo(b),this.reduce(b),b};w.prototype.reduce=function(a){for(;a.t<=this.mt2;)a.data[a.t++]=0;for(var b=0;b<this.m.t;++b){var c=a.data[b]&32767,d=c*this.mpl+
((c*this.mph+(a.data[b]>>15)*this.mpl&this.um)<<15)&a.DM,c=b+this.m.t;for(a.data[c]+=this.m.am(0,d,a,b,0,this.m.t);a.data[c]>=a.DV;)a.data[c]-=a.DV,a.data[++c]++}a.clamp();a.drShiftTo(this.m.t,a);0<=a.compareTo(this.m)&&a.subTo(this.m,a)};w.prototype.mulTo=function(a,b,c){a.multiplyTo(b,c);this.reduce(c)};w.prototype.sqrTo=function(a,b){a.squareTo(b);this.reduce(b)};e.prototype.copyTo=function(a){for(var b=this.t-1;0<=b;--b)a.data[b]=this.data[b];a.t=this.t;a.s=this.s};e.prototype.fromInt=function(a){this.t=
1;this.s=0>a?-1:0;0<a?this.data[0]=a:-1>a?this.data[0]=a+this.DV:this.t=0};e.prototype.fromString=function(a,b){var d;if(16==b)d=4;else if(8==b)d=3;else if(256==b)d=8;else if(2==b)d=1;else if(32==b)d=5;else{if(4!=b){this.fromRadix(a,b);return}d=2}this.s=this.t=0;for(var f=a.length,g=!1,p=0;0<=--f;){var k=8==d?a[f]&255:c(a,f);0>k?"-"==a.charAt(f)&&(g=!0):(g=!1,0==p?this.data[this.t++]=k:p+d>this.DB?(this.data[this.t-1]|=(k&(1<<this.DB-p)-1)<<p,this.data[this.t++]=k>>this.DB-p):this.data[this.t-1]|=
k<<p,p+=d,p>=this.DB&&(p-=this.DB))}8==d&&0!=(a[0]&128)&&(this.s=-1,0<p&&(this.data[this.t-1]|=(1<<this.DB-p)-1<<p));this.clamp();g&&e.ZERO.subTo(this,this)};e.prototype.clamp=function(){for(var a=this.s&this.DM;0<this.t&&this.data[this.t-1]==a;)--this.t};e.prototype.dlShiftTo=function(a,b){var c;for(c=this.t-1;0<=c;--c)b.data[c+a]=this.data[c];for(c=a-1;0<=c;--c)b.data[c]=0;b.t=this.t+a;b.s=this.s};e.prototype.drShiftTo=function(a,b){for(var c=a;c<this.t;++c)b.data[c-a]=this.data[c];b.t=Math.max(this.t-
a,0);b.s=this.s};e.prototype.lShiftTo=function(a,b){var c=a%this.DB,d=this.DB-c,f=(1<<d)-1,g=Math.floor(a/this.DB),e=this.s<<c&this.DM,p;for(p=this.t-1;0<=p;--p)b.data[p+g+1]=this.data[p]>>d|e,e=(this.data[p]&f)<<c;for(p=g-1;0<=p;--p)b.data[p]=0;b.data[g]=e;b.t=this.t+g+1;b.s=this.s;b.clamp()};e.prototype.rShiftTo=function(a,b){b.s=this.s;var c=Math.floor(a/this.DB);if(c>=this.t)b.t=0;else{var d=a%this.DB,f=this.DB-d,g=(1<<d)-1;b.data[0]=this.data[c]>>d;for(var e=c+1;e<this.t;++e)b.data[e-c-1]|=(this.data[e]&
g)<<f,b.data[e-c]=this.data[e]>>d;0<d&&(b.data[this.t-c-1]|=(this.s&g)<<f);b.t=this.t-c;b.clamp()}};e.prototype.subTo=function(a,b){for(var c=0,d=0,f=Math.min(a.t,this.t);c<f;)d+=this.data[c]-a.data[c],b.data[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d-=a.s;c<this.t;)d+=this.data[c],b.data[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d-=a.data[c],b.data[c++]=d&this.DM,d>>=this.DB;d-=a.s}b.s=0>d?-1:0;-1>d?b.data[c++]=this.DV+d:0<d&&(b.data[c++]=d);b.t=c;b.clamp()};e.prototype.multiplyTo=
function(a,b){var c=this.abs(),d=a.abs(),f=c.t;for(b.t=f+d.t;0<=--f;)b.data[f]=0;for(f=0;f<d.t;++f)b.data[f+c.t]=c.am(0,d.data[f],b,f,0,c.t);b.s=0;b.clamp();this.s!=a.s&&e.ZERO.subTo(b,b)};e.prototype.squareTo=function(a){for(var b=this.abs(),c=a.t=2*b.t;0<=--c;)a.data[c]=0;for(c=0;c<b.t-1;++c){var d=b.am(c,b.data[c],a,2*c,0,1);(a.data[c+b.t]+=b.am(c+1,2*b.data[c],a,2*c+1,d,b.t-c-1))>=b.DV&&(a.data[c+b.t]-=b.DV,a.data[c+b.t+1]=1)}0<a.t&&(a.data[a.t-1]+=b.am(c,b.data[c],a,2*c,0,1));a.s=0;a.clamp()};
e.prototype.divRemTo=function(a,b,c){var f=a.abs();if(!(0>=f.t)){var g=this.abs();if(g.t<f.t)null!=b&&b.fromInt(0),null!=c&&this.copyTo(c);else{null==c&&(c=d());var p=d(),k=this.s;a=a.s;var l=this.DB-n(f.data[f.t-1]);0<l?(f.lShiftTo(l,p),g.lShiftTo(l,c)):(f.copyTo(p),g.copyTo(c));f=p.t;g=p.data[f-1];if(0!=g){var h=g*(1<<this.F1)+(1<f?p.data[f-2]>>this.F2:0),z=this.FV/h,h=(1<<this.F1)/h,H=1<<this.F2,u=c.t,q=u-f,A=null==b?d():b;p.dlShiftTo(q,A);0<=c.compareTo(A)&&(c.data[c.t++]=1,c.subTo(A,c));e.ONE.dlShiftTo(f,
A);for(A.subTo(p,p);p.t<f;)p.data[p.t++]=0;for(;0<=--q;){var w=c.data[--u]==g?this.DM:Math.floor(c.data[u]*z+(c.data[u-1]+H)*h);if((c.data[u]+=p.am(0,w,c,q,0,f))<w)for(p.dlShiftTo(q,A),c.subTo(A,c);c.data[u]<--w;)c.subTo(A,c)}null!=b&&(c.drShiftTo(f,b),k!=a&&e.ZERO.subTo(b,b));c.t=f;c.clamp();0<l&&c.rShiftTo(l,c);0>k&&e.ZERO.subTo(c,c)}}}};e.prototype.invDigit=function(){if(1>this.t)return 0;var a=this.data[0];if(0==(a&1))return 0;var b=a&3;return b=b*(2-(a&15)*b)&15,b=b*(2-(a&255)*b)&255,b=b*(2-
((a&65535)*b&65535))&65535,b=b*(2-a*b%this.DV)%this.DV,0<b?this.DV-b:-b};e.prototype.isEven=function(){return 0==(0<this.t?this.data[0]&1:this.s)};e.prototype.exp=function(a,b){if(4294967295<a||1>a)return e.ONE;var c=d(),f=d(),g=b.convert(this),p=n(a)-1;for(g.copyTo(c);0<=--p;)if(b.sqrTo(c,f),0<(a&1<<p))b.mulTo(f,g,c);else var k=c,c=f,f=k;return b.revert(c)};e.prototype.toString=function(a){if(0>this.s)return"-"+this.negate().toString(a);if(16==a)a=4;else if(8==a)a=3;else if(2==a)a=1;else if(32==
a)a=5;else{if(4!=a)return this.toRadix(a);a=2}var b=(1<<a)-1,c,d=!1,f="",g=this.t,p=this.DB-g*this.DB%a;if(0<g--)for(p<this.DB&&0<(c=this.data[g]>>p)&&(d=!0,f="0123456789abcdefghijklmnopqrstuvwxyz".charAt(c));0<=g;)p<a?(c=(this.data[g]&(1<<p)-1)<<a-p,c|=this.data[--g]>>(p+=this.DB-a)):(c=this.data[g]>>(p-=a)&b,0>=p&&(p+=this.DB,--g)),0<c&&(d=!0),d&&(f+="0123456789abcdefghijklmnopqrstuvwxyz".charAt(c));return d?f:"0"};e.prototype.negate=function(){var a=d();return e.ZERO.subTo(this,a),a};e.prototype.abs=
function(){return 0>this.s?this.negate():this};e.prototype.compareTo=function(a){var b=this.s-a.s;if(0!=b)return b;var c=this.t,b=c-a.t;if(0!=b)return 0>this.s?-b:b;for(;0<=--c;)if(0!=(b=this.data[c]-a.data[c]))return b;return 0};e.prototype.bitLength=function(){return 0>=this.t?0:this.DB*(this.t-1)+n(this.data[this.t-1]^this.s&this.DM)};e.prototype.mod=function(a){var b=d();return this.abs().divRemTo(a,null,b),0>this.s&&0<b.compareTo(e.ZERO)&&a.subTo(b,b),b};e.prototype.modPowInt=function(a,b){var c;
return 256>a||b.isEven()?c=new f(b):c=new w(b),this.exp(a,c)};e.ZERO=b(0);e.ONE=b(1);r.prototype.convert=p;r.prototype.revert=p;r.prototype.mulTo=function(a,b,c){a.multiplyTo(b,c)};r.prototype.sqrTo=function(a,b){a.squareTo(b)};H.prototype.convert=function(a){if(0>a.s||a.t>2*this.m.t)return a.mod(this.m);if(0>a.compareTo(this.m))return a;var b=d();return a.copyTo(b),this.reduce(b),b};H.prototype.revert=function(a){return a};H.prototype.reduce=function(a){a.drShiftTo(this.m.t-1,this.r2);a.t>this.m.t+
1&&(a.t=this.m.t+1,a.clamp());this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);for(this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);0>a.compareTo(this.r2);)a.dAddOffset(1,this.m.t+1);for(a.subTo(this.r2,a);0<=a.compareTo(this.m);)a.subTo(this.m,a)};H.prototype.mulTo=function(a,b,c){a.multiplyTo(b,c);this.reduce(c)};H.prototype.sqrTo=function(a,b){a.squareTo(b);this.reduce(b)};var E=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,
151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],K=67108864/E[E.length-1];e.prototype.chunkSize=function(a){return Math.floor(Math.LN2*this.DB/Math.log(a))};e.prototype.toRadix=function(a){null==a&&(a=10);if(0==this.signum()||2>a||36<a)return"0";var c=this.chunkSize(a),c=Math.pow(a,c),f=b(c),g=d(),p=
d(),e="";for(this.divRemTo(f,g,p);0<g.signum();)e=(c+p.intValue()).toString(a).substr(1)+e,g.divRemTo(f,g,p);return p.intValue().toString(a)+e};e.prototype.fromRadix=function(a,b){this.fromInt(0);null==b&&(b=10);for(var d=this.chunkSize(b),f=Math.pow(b,d),g=!1,p=0,k=0,l=0;l<a.length;++l){var h=c(a,l);0>h?"-"==a.charAt(l)&&0==this.signum()&&(g=!0):(k=b*k+h,++p>=d&&(this.dMultiply(f),this.dAddOffset(k,0),p=0,k=0))}0<p&&(this.dMultiply(Math.pow(b,p)),this.dAddOffset(k,0));g&&e.ZERO.subTo(this,this)};
e.prototype.fromNumber=function(a,b,c){if("number"==typeof b)if(2>a)this.fromInt(1);else for(this.fromNumber(a,c),this.testBit(a-1)||this.bitwiseTo(e.ONE.shiftLeft(a-1),q,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(b);)this.dAddOffset(2,0),this.bitLength()>a&&this.subTo(e.ONE.shiftLeft(a-1),this);else{c=[];var d=a&7;c.length=(a>>3)+1;b.nextBytes(c);0<d?c[0]&=(1<<d)-1:c[0]=0;this.fromString(c,256)}};e.prototype.bitwiseTo=function(a,b,c){var d,f,g=Math.min(a.t,this.t);for(d=0;d<
g;++d)c.data[d]=b(this.data[d],a.data[d]);if(a.t<this.t){f=a.s&this.DM;for(d=g;d<this.t;++d)c.data[d]=b(this.data[d],f);c.t=this.t}else{f=this.s&this.DM;for(d=g;d<a.t;++d)c.data[d]=b(f,a.data[d]);c.t=a.t}c.s=b(this.s,a.s);c.clamp()};e.prototype.changeBit=function(a,b){var c=e.ONE.shiftLeft(a);return this.bitwiseTo(c,b,c),c};e.prototype.addTo=function(a,b){for(var c=0,d=0,f=Math.min(a.t,this.t);c<f;)d+=this.data[c]+a.data[c],b.data[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d+=a.s;c<this.t;)d+=
this.data[c],b.data[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d+=a.data[c],b.data[c++]=d&this.DM,d>>=this.DB;d+=a.s}b.s=0>d?-1:0;0<d?b.data[c++]=d:-1>d&&(b.data[c++]=this.DV+d);b.t=c;b.clamp()};e.prototype.dMultiply=function(a){this.data[this.t]=this.am(0,a-1,this,0,0,this.t);++this.t;this.clamp()};e.prototype.dAddOffset=function(a,b){if(0!=a){for(;this.t<=b;)this.data[this.t++]=0;for(this.data[b]+=a;this.data[b]>=this.DV;)this.data[b]-=this.DV,++b>=this.t&&(this.data[this.t++]=
0),++this.data[b]}};e.prototype.multiplyLowerTo=function(a,b,c){var d=Math.min(this.t+a.t,b);c.s=0;for(c.t=d;0<d;)c.data[--d]=0;var f;for(f=c.t-this.t;d<f;++d)c.data[d+this.t]=this.am(0,a.data[d],c,d,0,this.t);for(f=Math.min(a.t,b);d<f;++d)this.am(0,a.data[d],c,d,0,b-d);c.clamp()};e.prototype.multiplyUpperTo=function(a,b,c){--b;var d=c.t=this.t+a.t-b;for(c.s=0;0<=--d;)c.data[d]=0;for(d=Math.max(b-this.t,0);d<a.t;++d)c.data[this.t+d-b]=this.am(b-d,a.data[d],c,0,0,this.t+d-b);c.clamp();c.drShiftTo(1,
c)};e.prototype.modInt=function(a){if(0>=a)return 0;var b=this.DV%a,c=0>this.s?a-1:0;if(0<this.t)if(0==b)c=this.data[0]%a;else for(var d=this.t-1;0<=d;--d)c=(b*c+this.data[d])%a;return c};e.prototype.millerRabin=function(a){var b=this.subtract(e.ONE),c=b.getLowestSetBit();if(0>=c)return!1;for(var d=b.shiftRight(c),f=z(),g,p=0;p<a;++p){do g=new e(this.bitLength(),f);while(0>=g.compareTo(e.ONE)||0<=g.compareTo(b));g=g.modPow(d,this);if(0!=g.compareTo(e.ONE)&&0!=g.compareTo(b)){for(var k=1;k++<c&&0!=
g.compareTo(b);)if(g=g.modPowInt(2,this),0==g.compareTo(e.ONE))return!1;if(0!=g.compareTo(b))return!1}}return!0};e.prototype.clone=function(){var a=d();return this.copyTo(a),a};e.prototype.intValue=function(){if(0>this.s){if(1==this.t)return this.data[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this.data[0];if(0==this.t)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]};e.prototype.byteValue=function(){return 0==this.t?this.s:this.data[0]<<24>>24};e.prototype.shortValue=
function(){return 0==this.t?this.s:this.data[0]<<16>>16};e.prototype.signum=function(){return 0>this.s?-1:0>=this.t||1==this.t&&0>=this.data[0]?0:1};e.prototype.toByteArray=function(){var a=this.t,b=[];b[0]=this.s;var c=this.DB-a*this.DB%8,d,f=0;if(0<a--)for(c<this.DB&&(d=this.data[a]>>c)!=(this.s&this.DM)>>c&&(b[f++]=d|this.s<<this.DB-c);0<=a;)if(8>c?(d=(this.data[a]&(1<<c)-1)<<8-c,d|=this.data[--a]>>(c+=this.DB-8)):(d=this.data[a]>>(c-=8)&255,0>=c&&(c+=this.DB,--a)),0!=(d&128)&&(d|=-256),0==f&&
(this.s&128)!=(d&128)&&++f,0<f||d!=this.s)b[f++]=d;return b};e.prototype.equals=function(a){return 0==this.compareTo(a)};e.prototype.min=function(a){return 0>this.compareTo(a)?this:a};e.prototype.max=function(a){return 0<this.compareTo(a)?this:a};e.prototype.and=function(a){var b=d();return this.bitwiseTo(a,u,b),b};e.prototype.or=function(a){var b=d();return this.bitwiseTo(a,q,b),b};e.prototype.xor=function(a){var b=d();return this.bitwiseTo(a,v,b),b};e.prototype.andNot=function(a){var b=d();return this.bitwiseTo(a,
m,b),b};e.prototype.not=function(){for(var a=d(),b=0;b<this.t;++b)a.data[b]=this.DM&~this.data[b];return a.t=this.t,a.s=~this.s,a};e.prototype.shiftLeft=function(a){var b=d();return 0>a?this.rShiftTo(-a,b):this.lShiftTo(a,b),b};e.prototype.shiftRight=function(a){var b=d();return 0>a?this.lShiftTo(-a,b):this.rShiftTo(a,b),b};e.prototype.getLowestSetBit=function(){for(var a=0;a<this.t;++a)if(0!=this.data[a]){var b=a*this.DB;var c=this.data[a];if(0==c)a=-1;else var d=0,a=(0==(c&65535)&&(c>>=16,d+=16),
0==(c&255)&&(c>>=8,d+=8),0==(c&15)&&(c>>=4,d+=4),0==(c&3)&&(c>>=2,d+=2),0==(c&1)&&++d,d);return b+a}return 0>this.s?this.t*this.DB:-1};e.prototype.bitCount=function(){for(var a=0,b=this.s&this.DM,c=0;c<this.t;++c){for(var d=this.data[c]^b,f=0;0!=d;)d&=d-1,++f;a+=f}return a};e.prototype.testBit=function(a){var b=Math.floor(a/this.DB);return b>=this.t?0!=this.s:0!=(this.data[b]&1<<a%this.DB)};e.prototype.setBit=function(a){return this.changeBit(a,q)};e.prototype.clearBit=function(a){return this.changeBit(a,
m)};e.prototype.flipBit=function(a){return this.changeBit(a,v)};e.prototype.add=function(a){var b=d();return this.addTo(a,b),b};e.prototype.subtract=function(a){var b=d();return this.subTo(a,b),b};e.prototype.multiply=function(a){var b=d();return this.multiplyTo(a,b),b};e.prototype.divide=function(a){var b=d();return this.divRemTo(a,b,null),b};e.prototype.remainder=function(a){var b=d();return this.divRemTo(a,null,b),b};e.prototype.divideAndRemainder=function(a){var b=d(),c=d();return this.divRemTo(a,
b,c),[b,c]};e.prototype.modPow=function(a,c){var g=a.bitLength(),p,e=b(1),k;if(0>=g)return e;18>g?p=1:48>g?p=3:144>g?p=4:768>g?p=5:p=6;8>g?k=new f(c):c.isEven()?k=new H(c):k=new w(c);var l=[],h=3,z=p-1,u=(1<<p)-1;l[1]=k.convert(this);if(1<p)for(g=d(),k.sqrTo(l[1],g);h<=u;)l[h]=d(),k.mulTo(g,l[h-2],l[h]),h+=2;for(var q=a.t-1,A,v=!0,m=d(),r,g=n(a.data[q])-1;0<=q;){g>=z?A=a.data[q]>>g-z&u:(A=(a.data[q]&(1<<g+1)-1)<<z-g,0<q&&(A|=a.data[q-1]>>this.DB+g-z));for(h=p;0==(A&1);)A>>=1,--h;0>(g-=h)&&(g+=this.DB,
--q);if(v)l[A].copyTo(e),v=!1;else{for(;1<h;)k.sqrTo(e,m),k.sqrTo(m,e),h-=2;0<h?k.sqrTo(e,m):(r=e,e=m,m=r);k.mulTo(m,l[A],e)}for(;0<=q&&0==(a.data[q]&1<<g);)k.sqrTo(e,m),r=e,e=m,m=r,0>--g&&(g=this.DB-1,--q)}return k.revert(e)};e.prototype.modInverse=function(a){var c=a.isEven();if(this.isEven()&&c||0==a.signum())return e.ZERO;for(var d=a.clone(),f=this.clone(),g=b(1),p=b(0),k=b(0),l=b(1);0!=d.signum();){for(;d.isEven();)d.rShiftTo(1,d),c?(g.isEven()&&p.isEven()||(g.addTo(this,g),p.subTo(a,p)),g.rShiftTo(1,
g)):p.isEven()||p.subTo(a,p),p.rShiftTo(1,p);for(;f.isEven();)f.rShiftTo(1,f),c?(k.isEven()&&l.isEven()||(k.addTo(this,k),l.subTo(a,l)),k.rShiftTo(1,k)):l.isEven()||l.subTo(a,l),l.rShiftTo(1,l);0<=d.compareTo(f)?(d.subTo(f,d),c&&g.subTo(k,g),p.subTo(l,p)):(f.subTo(d,f),c&&k.subTo(g,k),l.subTo(p,l))}return 0!=f.compareTo(e.ONE)?e.ZERO:0<=l.compareTo(a)?l.subtract(a):0>l.signum()?(l.addTo(a,l),0>l.signum()?l.add(a):l):l};e.prototype.pow=function(a){return this.exp(a,new r)};e.prototype.gcd=function(a){var b=
0>this.s?this.negate():this.clone();a=0>a.s?a.negate():a.clone();0>b.compareTo(a)&&(a=b=a);var c=b.getLowestSetBit(),d=a.getLowestSetBit();if(0>d)return b;c<d&&(d=c);for(0<d&&(b.rShiftTo(d,b),a.rShiftTo(d,a));0<b.signum();)0<(c=b.getLowestSetBit())&&b.rShiftTo(c,b),0<(c=a.getLowestSetBit())&&a.rShiftTo(c,a),0<=b.compareTo(a)?(b.subTo(a,b),b.rShiftTo(1,b)):(a.subTo(b,a),a.rShiftTo(1,a));return 0<d&&a.lShiftTo(d,a),a};e.prototype.isProbablePrime=function(a){var b,c=this.abs();if(1==c.t&&c.data[0]<=
E[E.length-1]){for(b=0;b<E.length;++b)if(c.data[0]==E[b])return!0;return!1}if(c.isEven())return!1;for(b=1;b<E.length;){for(var d=E[b],f=b+1;f<E.length&&d<K;)d*=E[f++];for(d=c.modInt(d);b<f;)if(0==d%E[b++])return!1}return c.millerRabin(a)};a.jsbn=a.jsbn||{};a.jsbn.BigInteger=e}if("function"!=typeof m){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),x(forge);var F=!0;m=function(a,e){e(G,module)}}var y,C=function(a,e){e.exports=function(d){var e=y.map(function(d){return a(d)}).concat(x);
d=d||{};d.defined=d.defined||{};if(d.defined.jsbn)return d.jsbn;d.defined.jsbn=!0;for(var g=0;g<e.length;++g)e[g](d);return d.jsbn}},t=m;m=function(a,e){return y="string"==typeof a?e.slice(2):a.slice(2),F?(delete m,t.apply(null,Array.prototype.slice.call(arguments,0))):(m=t,m.apply(null,Array.prototype.slice.call(arguments,0)))};m("js/jsbn",["require","module"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function x(a){function e(d,g,e){e||(e=a.md.sha1.create());
for(var c="",b=Math.ceil(g/e.digestLength),n=0;n<b;++n){var f=String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255);e.start();e.update(d+f);c+=e.digest().getBytes()}return c.substring(0,g)}var d=a.pkcs1=a.pkcs1||{};d.encode_rsa_oaep=function(d,g,h,c,b){var n,f,w,u;"string"==typeof h?(n=h,f=c||void 0,w=b||void 0):h&&(n=h.label||void 0,f=h.seed||void 0,w=h.md||void 0,h.mgf1&&h.mgf1.md&&(u=h.mgf1.md));w?w.start():w=a.md.sha1.create();u||(u=w);d=Math.ceil(d.n.bitLength()/8);h=d-2*w.digestLength-2;if(g.length>
h)throw u=Error("RSAES-OAEP input message length is too long."),u.length=g.length,u.maxLength=h,u;n||(n="");w.update(n,"raw");n=w.digest();c="";h-=g.length;for(b=0;b<h;b++)c+="\x00";g=n.getBytes()+c+"\u0001"+g;if(!f)f=a.random.getBytes(w.digestLength);else if(f.length!==w.digestLength)throw u=Error("Invalid RSAES-OAEP seed. The seed length must match the digest length."),u.seedLength=f.length,u.digestLength=w.digestLength,u;d=e(f,d-w.digestLength-1,u);g=a.util.xorBytes(g,d,g.length);w=e(g,w.digestLength,
u);return"\x00"+a.util.xorBytes(f,w,f.length)+g};d.decode_rsa_oaep=function(d,g,h,c){var b,n,f;"string"==typeof h?(b=h,n=c||void 0):h&&(b=h.label||void 0,n=h.md||void 0,h.mgf1&&h.mgf1.md&&(f=h.mgf1.md));h=Math.ceil(d.n.bitLength()/8);if(g.length!==h)throw f=Error("RSAES-OAEP encoded message length is invalid."),f.length=g.length,f.expectedLength=h,f;void 0===n?n=a.md.sha1.create():n.start();f||(f=n);if(h<2*n.digestLength+2)throw Error("RSAES-OAEP key is too short for the hash function.");b||(b="");
n.update(b,"raw");b=n.digest().getBytes();d=g.charAt(0);c=g.substring(1,n.digestLength+1);g=g.substring(1+n.digestLength);var w=e(g,n.digestLength,f);c=a.util.xorBytes(c,w,c.length);f=e(c,h-n.digestLength-1,f);g=a.util.xorBytes(g,f,g.length);h=g.substring(0,n.digestLength);f="\x00"!==d;for(d=0;d<n.digestLength;++d)f|=b.charAt(d)!==h.charAt(d);b=1;for(n=d=n.digestLength;n<g.length;n++)h=g.charCodeAt(n),c=h&1^1,f|=h&(b?65534:0),b&=c,d+=b;if(f||1!==g.charCodeAt(d))throw Error("Invalid RSAES-OAEP padding.");
return g.substring(d+1)}}if("function"!=typeof m){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),x(forge);var F=!0;m=function(a,e){e(G,module)}}var y,C=function(a,e){e.exports=function(d){var e=y.map(function(d){return a(d)}).concat(x);d=d||{};d.defined=d.defined||{};if(d.defined.pkcs1)return d.pkcs1;d.defined.pkcs1=!0;for(var g=0;g<e.length;++g)e[g](d);return d.pkcs1}},t=m;m=function(a,e){return y="string"==typeof a?e.slice(2):a.slice(2),F?(delete m,t.apply(null,
Array.prototype.slice.call(arguments,0))):(m=t,m.apply(null,Array.prototype.slice.call(arguments,0)))};m("js/pkcs1",["require","module","./util","./random","./sha1"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function x(a){function e(a,b,c,f){return"workers"in c?k(a,b,c,f):d(a,b,c,f)}function d(b,c,f,e){var k=g(b,c),p=0,H=h(k.bitLength());"millerRabinTests"in f&&(H=f.millerRabinTests);var z=10;"maxBlockTime"in f&&(z=f.maxBlockTime);var A=+new Date;do{k.bitLength()>
b&&(k=g(b,c));if(k.isProbablePrime(H))return e(null,k);k.dAddOffset(n[p++%8],0)}while(0>z||+new Date-A<z);a.util.setImmediate(function(){d(b,c,f,e)})}function k(c,f,e,k){function h(){function a(e){if(!v){--m;var l=e.data;if(l.found){for(e=0;e<d.length;++e)d[e].terminate();return v=!0,k(null,new b(l.prime,16))}p.bitLength()>c&&(p=g(c,f));l=p.toString(16);e.target.postMessage({hex:l,workLoad:z});p.dAddOffset(n,0)}}H=Math.max(1,H);for(var d=[],e=0;e<H;++e)d[e]=new Worker(w);for(var m=H,e=0;e<H;++e)d[e].addEventListener("message",
a);var v=!1}if("undefined"==typeof Worker)return d(c,f,e,k);var p=g(c,f),H=e.workers,z=e.workLoad||100,n=30*z/8,w=e.workerScript||"forge/prime.worker.js";if(-1===H)return a.util.estimateCores(function(a,b){a&&(b=2);H=b-1;h()});h()}function g(a,c){var d=new b(a,c),g=a-1;return d.testBit(g)||d.bitwiseTo(b.ONE.shiftLeft(g),w,d),d.dAddOffset(31-d.mod(f).byteValue(),0),d}function h(a){return 100>=a?27:150>=a?18:200>=a?15:250>=a?12:300>=a?9:350>=a?8:400>=a?7:500>=a?6:600>=a?5:800>=a?4:1250>=a?3:2}if(!a.prime){var c=
a.prime=a.prime||{},b=a.jsbn.BigInteger,n=[6,4,2,4,2,4,6,2],f=new b(null);f.fromInt(30);var w=function(a,b){return a|b};c.generateProbablePrime=function(b,c,d){"function"==typeof c&&(d=c,c={});c=c||{};var f=c.algorithm||"PRIMEINC";"string"==typeof f&&(f={name:f});f.options=f.options||{};var g=c.prng||a.random;c={nextBytes:function(a){for(var b=g.getBytesSync(a.length),c=0;c<a.length;++c)a[c]=b.charCodeAt(c)}};if("PRIMEINC"===f.name)return e(b,c,f.options,d);throw Error("Invalid prime generation algorithm: "+
f.name);}}}if("function"!=typeof m){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),x(forge);var F=!0;m=function(a,e){e(G,module)}}var y,C=function(a,e){e.exports=function(d){var e=y.map(function(d){return a(d)}).concat(x);d=d||{};d.defined=d.defined||{};if(d.defined.prime)return d.prime;d.defined.prime=!0;for(var g=0;g<e.length;++g)e[g](d);return d.prime}},t=m;m=function(a,e){return y="string"==typeof a?e.slice(2):a.slice(2),F?(delete m,t.apply(null,Array.prototype.slice.call(arguments,
0))):(m=t,m.apply(null,Array.prototype.slice.call(arguments,0)))};m("js/prime",["require","module","./util","./jsbn","./random"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function x(a){function e(b,c,d){var f=a.util.createBuffer();c=Math.ceil(c.n.bitLength()/8);if(b.length>c-11)throw f=Error("Message is too long for PKCS#1 v1.5 padding."),f.length=b.length,f.max=c-11,f;f.putByte(0);f.putByte(d);c=c-3-b.length;if(0===d||1===d){d=0===d?0:255;for(var g=0;g<c;++g)f.putByte(d)}else for(;0<
c;){for(var e=0,k=a.random.getBytes(c),g=0;g<c;++g)d=k.charCodeAt(g),0===d?++e:f.putByte(d);c=e}return f.putByte(0),f.putBytes(b),f}function d(b,c,d,f){c=Math.ceil(c.n.bitLength()/8);b=a.util.createBuffer(b);var g=b.getByte(),e=b.getByte();if(0!==g||d&&0!==e&&1!==e||!d&&2!=e||d&&0===e&&"undefined"==typeof f)throw Error("Encryption block is invalid.");d=0;if(0===e)for(d=c-3-f,f=0;f<d;++f){if(0!==b.getByte())throw Error("Encryption block is invalid.");}else if(1===e)for(d=0;1<b.length();){if(255!==
b.getByte()){--b.read;break}++d}else if(2===e)for(d=0;1<b.length();){if(0===b.getByte()){--b.read;break}++d}if(0!==b.getByte()||d!==c-3-b.length())throw Error("Encryption block is invalid.");return b.getBytes()}function k(b,d,f){function g(){e(b.pBits,function(a,c){if(a)return f(a);b.p=c;if(null!==b.q)return k(a,b.q);e(b.qBits,k)})}function e(b,c){a.prime.generateProbablePrime(b,h,c)}function k(a,d){if(a)return f(a);b.q=d;if(0>b.p.compareTo(b.q)){var h=b.p;b.p=b.q;b.q=h}0!==b.p.subtract(c.ONE).gcd(b.e).compareTo(c.ONE)?
(b.p=null,g()):0!==b.q.subtract(c.ONE).gcd(b.e).compareTo(c.ONE)?(b.q=null,e(b.qBits,k)):(b.p1=b.p.subtract(c.ONE),b.q1=b.q.subtract(c.ONE),b.phi=b.p1.multiply(b.q1),0!==b.phi.gcd(b.e).compareTo(c.ONE)?(b.p=b.q=null,g()):(b.n=b.p.multiply(b.q),b.n.bitLength()!==b.bits?(b.q=null,e(b.qBits,k)):(h=b.e.modInverse(b.phi),b.keys={privateKey:n.rsa.setPrivateKey(b.n,b.e,h,b.p,b.q,h.mod(b.p1),h.mod(b.q1),b.q.modInverse(b.p)),publicKey:n.rsa.setPublicKey(b.n,b.e)},f(null,b.keys))))}"function"==typeof d&&(f=
d,d={});d=d||{};var h={algorithm:{name:d.algorithm||"PRIMEINC",options:{workers:d.workers||2,workLoad:d.workLoad||100,workerScript:d.workerScript}}};"prng"in d&&(h.prng=d.prng);g()}function g(b){b=b.toString(16);return"8"<=b[0]&&(b="00"+b),a.util.hexToBytes(b)}function h(a){return 100>=a?27:150>=a?18:200>=a?15:250>=a?12:300>=a?9:350>=a?8:400>=a?7:500>=a?6:600>=a?5:800>=a?4:1250>=a?3:2}if("undefined"==typeof c)var c=a.jsbn.BigInteger;var b=a.asn1;a.pki=a.pki||{};a.pki.rsa=a.rsa=a.rsa||{};var n=a.pki,
f=[6,4,2,4,2,4,6,2],w={name:"PrivateKeyInfo",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:b.Class.UNIVERSAL,
type:b.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},u={name:"RSAPrivateKey",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},
{name:"RSAPrivateKey.privateExponent",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",
tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},q={name:"RSAPublicKey",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,
constructed:!1,capture:"publicKeyExponent"}]},m=a.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:b.Class.UNIVERSAL,
type:b.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},J=function(a){var c;if(a.algorithm in n.oids){c=n.oids[a.algorithm];var d=b.oidToDer(c).getBytes();c=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[]);var f=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[]);f.value.push(b.create(b.Class.UNIVERSAL,b.Type.OID,!1,d));f.value.push(b.create(b.Class.UNIVERSAL,
b.Type.NULL,!1,""));a=b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,a.digest().getBytes());return c.value.push(f),c.value.push(a),b.toDer(c).getBytes()}c=Error("Unknown message digest algorithm.");throw c.algorithm=a.algorithm,c;},r=function(b,d,f){if(f)return b.modPow(d.e,d.n);if(!d.p||!d.q)return b.modPow(d.d,d.n);d.dP||(d.dP=d.d.mod(d.p.subtract(c.ONE)));d.dQ||(d.dQ=d.d.mod(d.q.subtract(c.ONE)));d.qInv||(d.qInv=d.q.modInverse(d.p));do f=(new c(a.util.bytesToHex(a.random.getBytes(d.n.bitLength()/
8)),16)).mod(d.n);while(f.equals(c.ZERO));b=b.multiply(f.modPow(d.e,d.n)).mod(d.n);var g=b.mod(d.p).modPow(d.dP,d.p);for(b=b.mod(d.q).modPow(d.dQ,d.q);0>g.compareTo(b);)g=g.add(d.p);b=g.subtract(b).multiply(d.qInv).mod(d.p).multiply(d.q).add(b);return b=b.multiply(f.modInverse(d.n)).mod(d.n),b};n.rsa.encrypt=function(b,d,f){var g=f,k,l=Math.ceil(d.n.bitLength()/8);!1!==f&&!0!==f?(g=2===f,k=e(b,d,f)):(k=a.util.createBuffer(),k.putBytes(b));b=new c(k.toHex(),16);d=r(b,d,g).toString(16);g=a.util.createBuffer();
for(l-=Math.ceil(d.length/2);0<l;)g.putByte(0),--l;return g.putBytes(a.util.hexToBytes(d)),g.getBytes()};n.rsa.decrypt=function(b,f,g,e){var k=Math.ceil(f.n.bitLength()/8);if(b.length!==k)throw f=Error("Encrypted message length is invalid."),f.length=b.length,f.expected=k,f;b=new c(a.util.createBuffer(b).toHex(),16);if(0<=b.compareTo(f.n))throw Error("Encrypted message is invalid.");b=r(b,f,g).toString(16);for(var l=a.util.createBuffer(),k=k-Math.ceil(b.length/2);0<k;)l.putByte(0),--k;return l.putBytes(a.util.hexToBytes(b)),
!1!==e?d(l.getBytes(),f,g):l.getBytes()};n.rsa.createKeyPairGenerationState=function(b,d,f){"string"==typeof b&&(b=parseInt(b,10));b=b||2048;f=f||{};var g=f.prng||a.random;f=f.algorithm||"PRIMEINC";var e;if("PRIMEINC"!==f)throw Error("Invalid key generation algorithm: "+f);return e={algorithm:f,state:0,bits:b,rng:{nextBytes:function(a){for(var b=g.getBytesSync(a.length),c=0;c<a.length;++c)a[c]=b.charCodeAt(c)}},eInt:d||65537,e:new c(null),p:null,q:null,qBits:b>>1,pBits:b-(b>>1),pqState:0,num:null,
keys:null},e.e.fromInt(e.eInt),e};n.rsa.stepKeyPairGenerationState=function(a,b){"algorithm"in a||(a.algorithm="PRIMEINC");var d=new c(null);d.fromInt(30);for(var g=0,e=function(a,b){return a|b},k=+new Date,u,q=0;null===a.keys&&(0>=b||q<b);){if(0===a.state){u=null===a.p?a.pBits:a.qBits;var w=u-1;0===a.pqState?(a.num=new c(u,a.rng),a.num.testBit(w)||a.num.bitwiseTo(c.ONE.shiftLeft(w),e,a.num),a.num.dAddOffset(31-a.num.mod(d).byteValue(),0),g=0,++a.pqState):1===a.pqState?a.num.bitLength()>u?a.pqState=
0:a.num.isProbablePrime(h(a.num.bitLength()))?++a.pqState:a.num.dAddOffset(f[g++%8],0):2===a.pqState?a.pqState=0===a.num.subtract(c.ONE).gcd(a.e).compareTo(c.ONE)?3:0:3===a.pqState&&(a.pqState=0,null===a.p?a.p=a.num:a.q=a.num,null!==a.p&&null!==a.q&&++a.state,a.num=null)}else 1===a.state?(0>a.p.compareTo(a.q)&&(a.num=a.p,a.p=a.q,a.q=a.num),++a.state):2===a.state?(a.p1=a.p.subtract(c.ONE),a.q1=a.q.subtract(c.ONE),a.phi=a.p1.multiply(a.q1),++a.state):3===a.state?0===a.phi.gcd(a.e).compareTo(c.ONE)?
++a.state:(a.p=null,a.q=null,a.state=0):4===a.state?(a.n=a.p.multiply(a.q),a.n.bitLength()===a.bits?++a.state:(a.q=null,a.state=0)):5===a.state&&(u=a.e.modInverse(a.phi),a.keys={privateKey:n.rsa.setPrivateKey(a.n,a.e,u,a.p,a.q,u.mod(a.p1),u.mod(a.q1),a.q.modInverse(a.p)),publicKey:n.rsa.setPublicKey(a.n,a.e)});u=+new Date;q+=u-k;k=u}return null!==a.keys};n.rsa.generateKeyPair=function(a,b,c,d){1===arguments.length?"object"==typeof a?(c=a,a=void 0):"function"==typeof a&&(d=a,a=void 0):2===arguments.length?
"number"==typeof a?"function"==typeof b?(d=b,b=void 0):"number"!=typeof b&&(c=b,b=void 0):(c=a,d=b,a=void 0,b=void 0):3===arguments.length&&("number"==typeof b?"function"==typeof c&&(d=c,c=void 0):(d=c,c=b,b=void 0));c=c||{};void 0===a&&(a=c.bits||2048);void 0===b&&(b=c.e||65537);var f=n.rsa.createKeyPairGenerationState(a,b,c);if(!d)return n.rsa.stepKeyPairGenerationState(f,0),f.keys;k(f,c,d)};n.setRsaPublicKey=n.rsa.setPublicKey=function(c,f){var g={n:c,e:f};return g.encrypt=function(b,c,d){"string"==
typeof c?c=c.toUpperCase():void 0===c&&(c="RSAES-PKCS1-V1_5");if("RSAES-PKCS1-V1_5"===c)c={encode:function(a,b,c){return e(a,b,2).getBytes()}};else if("RSA-OAEP"===c||"RSAES-OAEP"===c)c={encode:function(b,c){return a.pkcs1.encode_rsa_oaep(c,b,d)}};else if(-1!==["RAW","NONE","NULL",null].indexOf(c))c={encode:function(a){return a}};else if("string"==typeof c)throw Error('Unsupported encryption scheme: "'+c+'".');b=c.encode(b,g,!0);return n.rsa.encrypt(b,g,!0)},g.verify=function(a,c,f){"string"==typeof f?
f=f.toUpperCase():void 0===f&&(f="RSASSA-PKCS1-V1_5");if("RSASSA-PKCS1-V1_5"===f)f={verify:function(a,c){c=d(c,g,!0);var f=b.fromDer(c);return a===f.value[1].value}};else if("NONE"===f||"NULL"===f||null===f)f={verify:function(a,b){return b=d(b,g,!0),a===b}};c=n.rsa.decrypt(c,g,!0,!1);return f.verify(a,c,g.n.bitLength())},g};n.setRsaPrivateKey=n.rsa.setPrivateKey=function(b,c,f,g,e,k,h,u){var q={n:b,e:c,d:f,p:g,q:e,dP:k,dQ:h,qInv:u};return q.decrypt=function(b,c,f){"string"==typeof c?c=c.toUpperCase():
void 0===c&&(c="RSAES-PKCS1-V1_5");b=n.rsa.decrypt(b,q,!1,!1);if("RSAES-PKCS1-V1_5"===c)c={decode:d};else if("RSA-OAEP"===c||"RSAES-OAEP"===c)c={decode:function(b,c){return a.pkcs1.decode_rsa_oaep(c,b,f)}};else{if(-1===["RAW","NONE","NULL",null].indexOf(c))throw Error('Unsupported encryption scheme: "'+c+'".');c={decode:function(a){return a}}}return c.decode(b,q,!1)},q.sign=function(a,b){var c=!1;"string"==typeof b&&(b=b.toUpperCase());if(void 0===b||"RSASSA-PKCS1-V1_5"===b)b={encode:J},c=1;else if("NONE"===
b||"NULL"===b||null===b)b={encode:function(){return a}},c=1;var d=b.encode(a,q.n.bitLength());return n.rsa.encrypt(d,q,c)},q};n.wrapRsaPrivateKey=function(a){return b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,b.integerToDer(0).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(n.oids.rsaEncryption).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.NULL,!1,"")]),b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,
!1,b.toDer(a).getBytes())])};n.privateKeyFromAsn1=function(d){var f={},g=[];b.validate(d,w,f,g)&&(d=b.fromDer(a.util.createBuffer(f.privateKey)));f={};g=[];if(!b.validate(d,u,f,g))throw d=Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey."),d.errors=g,d;var e,k,l,h,q,m,v,r;return e=a.util.createBuffer(f.privateKeyModulus).toHex(),k=a.util.createBuffer(f.privateKeyPublicExponent).toHex(),l=a.util.createBuffer(f.privateKeyPrivateExponent).toHex(),h=a.util.createBuffer(f.privateKeyPrime1).toHex(),
q=a.util.createBuffer(f.privateKeyPrime2).toHex(),m=a.util.createBuffer(f.privateKeyExponent1).toHex(),v=a.util.createBuffer(f.privateKeyExponent2).toHex(),r=a.util.createBuffer(f.privateKeyCoefficient).toHex(),n.setRsaPrivateKey(new c(e,16),new c(k,16),new c(l,16),new c(h,16),new c(q,16),new c(m,16),new c(v,16),new c(r,16))};n.privateKeyToAsn1=n.privateKeyToRSAPrivateKey=function(a){return b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,b.integerToDer(0).getBytes()),
b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,g(a.n)),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,g(a.e)),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,g(a.d)),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,g(a.p)),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,g(a.q)),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,g(a.dP)),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,g(a.dQ)),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,g(a.qInv))])};n.publicKeyFromAsn1=function(d){var f={},g=[];if(b.validate(d,m,f,g)){g=
b.derToOid(f.publicKeyOid);if(g!==n.oids.rsaEncryption)throw f=Error("Cannot read public key. Unknown OID."),f.oid=g,f;d=f.rsaPublicKey}g=[];if(!b.validate(d,q,f,g))throw f=Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey."),f.errors=g,f;g=a.util.createBuffer(f.publicKeyModulus).toHex();f=a.util.createBuffer(f.publicKeyExponent).toHex();return n.setRsaPublicKey(new c(g,16),new c(f,16))};n.publicKeyToAsn1=n.publicKeyToSubjectPublicKeyInfo=function(a){return b.create(b.Class.UNIVERSAL,
b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(n.oids.rsaEncryption).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.NULL,!1,"")]),b.create(b.Class.UNIVERSAL,b.Type.BITSTRING,!1,[n.publicKeyToRSAPublicKey(a)])])};n.publicKeyToRSAPublicKey=function(a){return b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,g(a.n)),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,g(a.e))])}}if("function"!=typeof m){if("object"!=
typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),x(forge);var F=!0;m=function(a,e){e(G,module)}}var y,C=function(a,e){e.exports=function(d){var e=y.map(function(d){return a(d)}).concat(x);d=d||{};d.defined=d.defined||{};if(d.defined.rsa)return d.rsa;d.defined.rsa=!0;for(var g=0;g<e.length;++g)e[g](d);return d.rsa}},t=m;m=function(a,e){return y="string"==typeof a?e.slice(2):a.slice(2),F?(delete m,t.apply(null,Array.prototype.slice.call(arguments,0))):(m=t,m.apply(null,Array.prototype.slice.call(arguments,
0)))};m("js/rsa","require module ./asn1 ./jsbn ./oids ./pkcs1 ./prime ./random ./util".split(" "),function(){C.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function x(a){function e(a,b){return a.start().update(b).digest().getBytes()}if("undefined"==typeof d)var d=a.jsbn.BigInteger;var k=a.asn1,g=a.pki=a.pki||{};g.pbe=a.pbe=a.pbe||{};var h=g.oids,c={name:"EncryptedPrivateKeyInfo",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",
tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:k.Class.UNIVERSAL,type:k.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:k.Class.UNIVERSAL,type:k.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},b={name:"PBES2Algorithms",tagClass:k.Class.UNIVERSAL,
type:k.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:k.Class.UNIVERSAL,type:k.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:k.Class.UNIVERSAL,type:k.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",
tagClass:k.Class.UNIVERSAL,type:k.Type.INTEGER,onstructed:!0,capture:"kdfIterationCount"}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:k.Class.UNIVERSAL,type:k.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:k.Class.UNIVERSAL,type:k.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},n={name:"pkcs-12PbeParams",tagClass:k.Class.UNIVERSAL,
type:k.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:k.Class.UNIVERSAL,type:k.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:k.Class.UNIVERSAL,type:k.Type.INTEGER,constructed:!1,capture:"iterations"}]};g.encryptPrivateKeyInfo=function(b,c,d){d=d||{};d.saltSize=d.saltSize||8;d.count=d.count||2048;d.algorithm=d.algorithm||"aes128";var e=a.random.getBytesSync(d.saltSize),n=d.count,m=k.integerToDer(n),r;if(0===d.algorithm.indexOf("aes")||
"des"===d.algorithm){var p,H;switch(d.algorithm){case "aes128":p=r=16;d=h["aes128-CBC"];H=a.aes.createEncryptionCipher;break;case "aes192":r=24;p=16;d=h["aes192-CBC"];H=a.aes.createEncryptionCipher;break;case "aes256":r=32;p=16;d=h["aes256-CBC"];H=a.aes.createEncryptionCipher;break;case "des":p=r=8;d=h.desCBC;H=a.des.createEncryptionCipher;break;default:throw e=Error("Cannot encrypt private key. Unknown encryption algorithm."),e.algorithm=d.algorithm,e;}var z=a.pkcs5.pbkdf2(c,e,n,r);c=a.random.getBytesSync(p);
n=H(z);n.start(c);n.update(k.toDer(b));n.finish();b=n.output.getBytes();e=k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.UNIVERSAL,k.Type.OID,!1,k.oidToDer(h.pkcs5PBES2).getBytes()),k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.UNIVERSAL,k.Type.OID,!1,k.oidToDer(h.pkcs5PBKDF2).getBytes()),k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.UNIVERSAL,k.Type.OCTETSTRING,!1,e),k.create(k.Class.UNIVERSAL,k.Type.INTEGER,
!1,m.getBytes())])]),k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.UNIVERSAL,k.Type.OID,!1,k.oidToDer(d).getBytes()),k.create(k.Class.UNIVERSAL,k.Type.OCTETSTRING,!1,c)])])])}else{if("3des"!==d.algorithm)throw e=Error("Cannot encrypt private key. Unknown encryption algorithm."),e.algorithm=d.algorithm,e;r=24;d=new a.util.ByteBuffer(e);z=g.pbe.generatePkcs12Key(c,d,1,n,r);c=g.pbe.generatePkcs12Key(c,d,2,n,r);n=a.des.createEncryptionCipher(z);n.start(c);n.update(k.toDer(b));n.finish();
b=n.output.getBytes();e=k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.UNIVERSAL,k.Type.OID,!1,k.oidToDer(h["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.UNIVERSAL,k.Type.OCTETSTRING,!1,e),k.create(k.Class.UNIVERSAL,k.Type.INTEGER,!1,m.getBytes())])])}return k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[e,k.create(k.Class.UNIVERSAL,k.Type.OCTETSTRING,!1,b)])};g.decryptPrivateKeyInfo=function(b,d){var e=null,h={},n=
[];if(!k.validate(b,c,h,n))throw e=Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo."),e.errors=n,e;n=k.derToOid(h.encryptionOid);n=g.pbe.getCipher(n,h.encryptionParams,d);h=a.util.createBuffer(h.encryptedData);return n.update(h),n.finish()&&(e=k.fromDer(n.output)),e};g.encryptedPrivateKeyToPem=function(b,c){var d={type:"ENCRYPTED PRIVATE KEY",body:k.toDer(b).getBytes()};return a.pem.encode(d,{maxline:c})};g.encryptedPrivateKeyFromPem=function(b){b=
a.pem.decode(b)[0];if("ENCRYPTED PRIVATE KEY"!==b.type){var c=Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw c.headerType=b.type,c;}if(b.procType&&"ENCRYPTED"===b.procType.type)throw Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return k.fromDer(b.body)};g.encryptRsaPrivateKey=function(b,c,d){d=d||{};if(!d.legacy)return b=g.wrapRsaPrivateKey(g.privateKeyToAsn1(b)),b=g.encryptPrivateKeyInfo(b,c,d),g.encryptedPrivateKeyToPem(b);
var e,h,n;switch(d.algorithm){case "aes128":d="AES-128-CBC";h=16;e=a.random.getBytesSync(16);n=a.aes.createEncryptionCipher;break;case "aes192":d="AES-192-CBC";h=24;e=a.random.getBytesSync(16);n=a.aes.createEncryptionCipher;break;case "aes256":d="AES-256-CBC";h=32;e=a.random.getBytesSync(16);n=a.aes.createEncryptionCipher;break;case "3des":d="DES-EDE3-CBC";h=24;e=a.random.getBytesSync(8);n=a.des.createEncryptionCipher;break;case "des":d="DES-CBC";h=8;e=a.random.getBytesSync(8);n=a.des.createEncryptionCipher;
break;default:throw b=Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+d.algorithm+'".'),b.algorithm=d.algorithm,b;}c=a.pbe.opensslDeriveBytes(c,e.substr(0,8),h);c=n(c);c.start(e);c.update(k.toDer(g.privateKeyToAsn1(b)));c.finish();b={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:d,parameters:a.util.bytesToHex(e).toUpperCase()},body:c.output.getBytes()};return a.pem.encode(b)};g.decryptRsaPrivateKey=function(b,c){var d=null,e=a.pem.decode(b)[0];
if("ENCRYPTED PRIVATE KEY"!==e.type&&"PRIVATE KEY"!==e.type&&"RSA PRIVATE KEY"!==e.type)throw d=Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".'),d.headerType=d,d;if(e.procType&&"ENCRYPTED"===e.procType.type){var h,n;switch(e.dekInfo.algorithm){case "DES-CBC":h=8;n=a.des.createDecryptionCipher;break;case "DES-EDE3-CBC":h=24;n=a.des.createDecryptionCipher;break;case "AES-128-CBC":h=16;n=a.aes.createDecryptionCipher;
break;case "AES-192-CBC":h=24;n=a.aes.createDecryptionCipher;break;case "AES-256-CBC":h=32;n=a.aes.createDecryptionCipher;break;case "RC2-40-CBC":h=5;n=function(b){return a.rc2.createDecryptionCipher(b,40)};break;case "RC2-64-CBC":h=8;n=function(b){return a.rc2.createDecryptionCipher(b,64)};break;case "RC2-128-CBC":h=16;n=function(b){return a.rc2.createDecryptionCipher(b,128)};break;default:throw d=Error('Could not decrypt private key; unsupported encryption algorithm "'+e.dekInfo.algorithm+'".'),
d.algorithm=e.dekInfo.algorithm,d;}var m=a.util.hexToBytes(e.dekInfo.parameters);h=a.pbe.opensslDeriveBytes(c,m.substr(0,8),h);n=n(h);n.start(m);n.update(a.util.createBuffer(e.body));if(!n.finish())return d;d=n.output.getBytes()}else d=e.body;return"ENCRYPTED PRIVATE KEY"===e.type?d=g.decryptPrivateKeyInfo(k.fromDer(d),c):d=k.fromDer(d),null!==d&&(d=g.privateKeyFromAsn1(d)),d};g.pbe.generatePkcs12Key=function(b,c,d,g,e,k){var h,p;if("undefined"==typeof k||null===k)k=a.md.sha1.create();var n=k.digestLength,
z=k.blockLength,A=new a.util.ByteBuffer,m=new a.util.ByteBuffer;if(null!==b&&void 0!==b){for(p=0;p<b.length;p++)m.putInt16(b.charCodeAt(p));m.putInt16(0)}b=m.length();var l=c.length(),E=new a.util.ByteBuffer;E.fillWithByte(d,z);var t=z*Math.ceil(l/z);d=new a.util.ByteBuffer;for(p=0;p<t;p++)d.putByte(c.at(p%l));t=z*Math.ceil(b/z);c=new a.util.ByteBuffer;for(p=0;p<t;p++)c.putByte(m.at(p%b));m=d;m.putBuffer(c);c=Math.ceil(e/n);for(d=1;d<=c;d++){t=new a.util.ByteBuffer;t.putBytes(E.bytes());t.putBytes(m.bytes());
for(p=0;p<g;p++)k.start(),k.update(t.getBytes()),t=k.digest();var B=new a.util.ByteBuffer;for(p=0;p<z;p++)B.putByte(t.at(p%n));var y=Math.ceil(l/z)+Math.ceil(b/z),x=new a.util.ByteBuffer;for(h=0;h<y;h++){var C=new a.util.ByteBuffer(m.getBytes(z)),F=511;for(p=B.length()-1;0<=p;p--)F>>=8,F+=B.at(p)+C.at(p),C.setAt(p,F&255);x.putBuffer(C)}m=x;A.putBuffer(t)}return A.truncate(A.length()-e),A};g.pbe.getCipher=function(a,b,c){switch(a){case g.oids.pkcs5PBES2:return g.pbe.getCipherForPBES2(a,b,c);case g.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case g.oids["pbewithSHAAnd40BitRC2-CBC"]:return g.pbe.getCipherForPKCS12PBE(a,
b,c);default:throw b=Error("Cannot read encrypted PBE data block. Unsupported OID."),b.oid=a,b.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],b;}};g.pbe.getCipherForPBES2=function(c,d,e){var h={};c=[];if(!k.validate(d,b,h,c)){var n=Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw n.errors=c,n;}c=k.derToOid(h.kdfOid);if(c!==g.oids.pkcs5PBKDF2)throw n=Error("Cannot read encrypted private key. Unsupported key derivation function OID."),
n.oid=c,n.supportedOids=["pkcs5PBKDF2"],n;c=k.derToOid(h.encOid);if(c!==g.oids["aes128-CBC"]&&c!==g.oids["aes192-CBC"]&&c!==g.oids["aes256-CBC"]&&c!==g.oids["des-EDE3-CBC"]&&c!==g.oids.desCBC)throw n=Error("Cannot read encrypted private key. Unsupported encryption scheme OID."),n.oid=c,n.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],n;d=h.kdfSalt;var m=a.util.createBuffer(h.kdfIterationCount),m=m.getInt(m.length()<<3),r;switch(g.oids[c]){case "aes128-CBC":r=16;n=a.aes.createDecryptionCipher;
break;case "aes192-CBC":r=24;n=a.aes.createDecryptionCipher;break;case "aes256-CBC":r=32;n=a.aes.createDecryptionCipher;break;case "des-EDE3-CBC":r=24;n=a.des.createDecryptionCipher;break;case "desCBC":r=8,n=a.des.createDecryptionCipher}c=a.pkcs5.pbkdf2(e,d,m,r);h=h.encIv;n=n(c);return n.start(h),n};g.pbe.getCipherForPKCS12PBE=function(b,c,d){var e={},h=[];if(!k.validate(c,n,e,h))throw d=Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo."),
d.errors=h,d;var h=a.util.createBuffer(e.salt),e=a.util.createBuffer(e.iterations),e=e.getInt(e.length()<<3),m;switch(b){case g.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:m=24;c=8;b=a.des.startDecrypting;break;case g.oids["pbewithSHAAnd40BitRC2-CBC"]:m=5;c=8;b=function(b,c){var d=a.rc2.createDecryptionCipher(b,40);return d.start(c,null),d};break;default:throw d=Error("Cannot read PKCS #12 PBE data block. Unsupported OID."),d.oid=b,d;}m=g.pbe.generatePkcs12Key(d,h,1,e,m);d=g.pbe.generatePkcs12Key(d,h,
2,e,c);return b(m,d)};g.pbe.opensslDeriveBytes=function(b,c,d,g){if("undefined"==typeof g||null===g)g=a.md.md5.create();null===c&&(c="");for(var k=[e(g,b+c)],h=16,n=1;h<d;++n,h+=16)k.push(e(g,k[n-1]+b+c));return k.join("").substr(0,d)}}if("function"!=typeof m){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),x(forge);var F=!0;m=function(a,e){e(G,module)}}var y,C=function(a,e){e.exports=function(d){var e=y.map(function(d){return a(d)}).concat(x);d=d||{};d.defined=
d.defined||{};if(d.defined.pbe)return d.pbe;d.defined.pbe=!0;for(var g=0;g<e.length;++g)e[g](d);return d.pbe}},t=m;m=function(a,e){return y="string"==typeof a?e.slice(2):a.slice(2),F?(delete m,t.apply(null,Array.prototype.slice.call(arguments,0))):(m=t,m.apply(null,Array.prototype.slice.call(arguments,0)))};m("js/pbe","require module ./aes ./asn1 ./des ./md ./oids ./pem ./pbkdf2 ./random ./rc2 ./rsa ./util".split(" "),function(){C.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function x(a){var e=
a.asn1,d=a.pkcs7asn1=a.pkcs7asn1||{};a.pkcs7=a.pkcs7||{};a.pkcs7.asn1=d;a={name:"ContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};d.contentInfoValidator=a;var k={name:"EncryptedContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,
constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,
captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};d.envelopedDataValidator={name:"EnvelopedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,
captureAsn1:"recipientInfos"}].concat(k)};d.encryptedDataValidator={name:"EncryptedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"}].concat(k)};d.signedDataValidator={name:"SignedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},
{name:"SignedData.DigestAlgorithms",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},a,{name:"SignedData.Certificates",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,capture:"signerInfos",optional:!0,value:[{name:"SignerInfo",tagClass:e.Class.UNIVERSAL,
type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"serial"}]},
{name:"SignerInfo.digestAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},
{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]}]}]};d.recipientInfoValidator={name:"RecipientInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,
constructed:!0,value:[{name:"RecipientInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"serial"}]},
{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter"}]},{name:"RecipientInfo.encryptedKey",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}}if("function"!=
typeof m){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),x(forge);var F=!0;m=function(a,e){e(G,module)}}var y,C=function(a,e){e.exports=function(d){var e=y.map(function(d){return a(d)}).concat(x);d=d||{};d.defined=d.defined||{};if(d.defined.pkcs7asn1)return d.pkcs7asn1;d.defined.pkcs7asn1=!0;for(var g=0;g<e.length;++g)e[g](d);return d.pkcs7asn1}},t=m;m=function(a,e){return y="string"==typeof a?e.slice(2):a.slice(2),F?(delete m,t.apply(null,Array.prototype.slice.call(arguments,
0))):(m=t,m.apply(null,Array.prototype.slice.call(arguments,0)))};m("js/pkcs7asn1",["require","module","./asn1","./util"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function x(a){a.mgf=a.mgf||{};(a.mgf.mgf1=a.mgf1=a.mgf1||{}).create=function(e){return{generate:function(d,k){for(var g=new a.util.ByteBuffer,h=Math.ceil(k/e.digestLength),c=0;c<h;c++){var b=new a.util.ByteBuffer;b.putInt32(c);e.start();e.update(d+b.getBytes());g.putBuffer(e.digest())}return g.truncate(g.length()-
k),g.getBytes()}}}}if("function"!=typeof m){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),x(forge);var F=!0;m=function(a,e){e(G,module)}}var y,C=function(a,e){e.exports=function(d){var e=y.map(function(d){return a(d)}).concat(x);d=d||{};d.defined=d.defined||{};if(d.defined.mgf1)return d.mgf1;d.defined.mgf1=!0;for(var g=0;g<e.length;++g)e[g](d);return d.mgf1}},t=m;m=function(a,e){return y="string"==typeof a?e.slice(2):a.slice(2),F?(delete m,t.apply(null,Array.prototype.slice.call(arguments,
0))):(m=t,m.apply(null,Array.prototype.slice.call(arguments,0)))};m("js/mgf1",["require","module","./util"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function x(a){a.mgf=a.mgf||{};a.mgf.mgf1=a.mgf1}if("function"!=typeof m){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),x(forge);var F=!0;m=function(a,e){e(G,module)}}var y,C=function(a,e){e.exports=function(d){var e=y.map(function(d){return a(d)}).concat(x);d=d||{};d.defined=
d.defined||{};if(d.defined.mgf)return d.mgf;d.defined.mgf=!0;for(var g=0;g<e.length;++g)e[g](d);return d.mgf}},t=m;m=function(a,e){return y="string"==typeof a?e.slice(2):a.slice(2),F?(delete m,t.apply(null,Array.prototype.slice.call(arguments,0))):(m=t,m.apply(null,Array.prototype.slice.call(arguments,0)))};m("js/mgf",["require","module","./mgf1"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function x(a){(a.pss=a.pss||{}).create=function(e){3===arguments.length&&
(e={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var d=e.md,k=e.mgf,g=d.digestLength,h=e.salt||null;"string"==typeof h&&(h=a.util.createBuffer(h));var c;if("saltLength"in e)c=e.saltLength;else{if(null===h)throw Error("Salt length not specified or specific salt not given.");c=h.length()}if(null!==h&&h.length()!==c)throw Error("Given salt length does not match length of given salt.");var b=e.prng||a.random,n={};return n.encode=function(f,e){var n,q=e-1,m=Math.ceil(q/8),J=f.digest().getBytes();
if(m<g+c+2)throw Error("Message is too long to encrypt.");var r;null===h?r=b.getBytesSync(c):r=h.bytes();n=new a.util.ByteBuffer;n.fillWithByte(0,8);n.putBytes(J);n.putBytes(r);d.start();d.update(n.getBytes());J=d.digest().getBytes();n=new a.util.ByteBuffer;n.fillWithByte(0,m-c-g-2);n.putByte(1);n.putBytes(r);var p=n.getBytes(),H=m-g-1,z=k.generate(J,H);r="";for(n=0;n<H;n++)r+=String.fromCharCode(p.charCodeAt(n)^z.charCodeAt(n));q=65280>>8*m-q&255;return r=String.fromCharCode(r.charCodeAt(0)&~q)+
r.substr(1),r+J+String.fromCharCode(188)},n.verify=function(b,e,h){var n;n=h-1;h=Math.ceil(n/8);e=e.substr(-h);if(h<g+c+2)throw Error("Inconsistent parameters to PSS signature verification.");if(188!==e.charCodeAt(h-1))throw Error("Encoded message does not end in 0xBC.");var m=h-g-1,J=e.substr(0,m);e=e.substr(m,g);var r=65280>>8*h-n&255;if(0!==(J.charCodeAt(0)&r))throw Error("Bits beyond keysize not zero as expected.");var p=k.generate(e,m),H="";for(n=0;n<m;n++)H+=String.fromCharCode(J.charCodeAt(n)^
p.charCodeAt(n));H=String.fromCharCode(H.charCodeAt(0)&~r)+H.substr(1);h=h-g-c-2;for(n=0;n<h;n++)if(0!==H.charCodeAt(n))throw Error("Leftmost octets not zero as expected");if(1!==H.charCodeAt(h))throw Error("Inconsistent PSS signature, 0x01 marker not found");h=H.substr(-c);m=new a.util.ByteBuffer;m.fillWithByte(0,8);m.putBytes(b);m.putBytes(h);d.start();d.update(m.getBytes());b=d.digest().getBytes();return e===b},n}}if("function"!=typeof m){if("object"!=typeof module||!module.exports)return"undefined"==
typeof forge&&(forge={}),x(forge);var F=!0;m=function(a,e){e(G,module)}}var y,C=function(a,e){e.exports=function(d){var e=y.map(function(d){return a(d)}).concat(x);d=d||{};d.defined=d.defined||{};if(d.defined.pss)return d.pss;d.defined.pss=!0;for(var g=0;g<e.length;++g)e[g](d);return d.pss}},t=m;m=function(a,e){return y="string"==typeof a?e.slice(2):a.slice(2),F?(delete m,t.apply(null,Array.prototype.slice.call(arguments,0))):(m=t,m.apply(null,Array.prototype.slice.call(arguments,0)))};m("js/pss",
["require","module","./random","./util"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function x(a){function e(a,b){"string"==typeof b&&(b={shortName:b});for(var c=null,d,f=0;null===c&&f<a.attributes.length;++f)d=a.attributes[f],b.type&&b.type===d.type?c=d:b.name&&b.name===d.name?c=d:b.shortName&&b.shortName===d.shortName&&(c=d);return c}function d(c){var d=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[]),f;c=c.attributes;for(var e=0;e<c.length;++e){f=c[e];var g=
f.value,k=b.Type.PRINTABLESTRING;"valueTagClass"in f&&(k=f.valueTagClass,k===b.Type.UTF8&&(g=a.util.encodeUtf8(g)));f=b.create(b.Class.UNIVERSAL,b.Type.SET,!0,[b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(f.type).getBytes()),b.create(b.Class.UNIVERSAL,k,!1,g)])]);d.value.push(f)}return d}function k(a){for(var c,d=0;d<a.length;++d){c=a[d];"undefined"==typeof c.name&&(c.type&&c.type in n.oids?c.name=n.oids[c.type]:c.shortName&&c.shortName in m&&
(c.name=n.oids[m[c.shortName]]));if("undefined"==typeof c.type){if(!(c.name&&c.name in n.oids))throw a=Error("Attribute type not specified."),a.attribute=c,a;c.type=n.oids[c.name]}"undefined"==typeof c.shortName&&c.name&&c.name in m&&(c.shortName=m[c.name]);if(c.type===f.extensionRequest&&(c.valueConstructed=!0,c.valueTagClass=b.Type.SEQUENCE,!c.value&&c.extensions)){c.value=[];for(var e=0;e<c.extensions.length;++e)c.value.push(n.certificateExtensionToAsn1(g(c.extensions[e])))}if("undefined"==typeof c.value)throw a=
Error("Attribute value not specified."),a.attribute=c,a;}}function g(c,d){d=d||{};"undefined"==typeof c.name&&c.id&&c.id in n.oids&&(c.name=n.oids[c.id]);if("undefined"==typeof c.id){if(!(c.name&&c.name in n.oids)){var e=Error("Extension ID not specified.");throw e.extension=c,e;}c.id=n.oids[c.name]}if("undefined"!=typeof c.value)return c;if("keyUsage"===c.name){var g=e=0,k=0;c.digitalSignature&&(g|=128,e=7);c.nonRepudiation&&(g|=64,e=6);c.keyEncipherment&&(g|=32,e=5);c.dataEncipherment&&(g|=16,e=
4);c.keyAgreement&&(g|=8,e=3);c.keyCertSign&&(g|=4,e=2);c.cRLSign&&(g|=2,e=1);c.encipherOnly&&(g|=1,e=0);c.decipherOnly&&(k|=128,e=7);e=String.fromCharCode(e);0!==k?e+=String.fromCharCode(g)+String.fromCharCode(k):0!==g&&(e+=String.fromCharCode(g));c.value=b.create(b.Class.UNIVERSAL,b.Type.BITSTRING,!1,e)}else if("basicConstraints"===c.name)c.value=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[]),c.cA&&c.value.value.push(b.create(b.Class.UNIVERSAL,b.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in
c&&c.value.value.push(b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,b.integerToDer(c.pathLenConstraint).getBytes()));else if("extKeyUsage"===c.name)for(g in c.value=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[]),e=c.value.value,c)!0===c[g]&&(g in f?e.push(b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(f[g]).getBytes())):-1!==g.indexOf(".")&&e.push(b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(g).getBytes())));else if("nsCertType"===c.name)g=e=0,c.client&&(g|=128,e=7),c.server&&(g|=64,
e=6),c.email&&(g|=32,e=5),c.objsign&&(g|=16,e=4),c.reserved&&(g|=8,e=3),c.sslCA&&(g|=4,e=2),c.emailCA&&(g|=2,e=1),c.objCA&&(g|=1,e=0),e=String.fromCharCode(e),0!==g&&(e+=String.fromCharCode(g)),c.value=b.create(b.Class.UNIVERSAL,b.Type.BITSTRING,!1,e);else if("subjectAltName"===c.name||"issuerAltName"===c.name)for(c.value=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[]),k=0;k<c.altNames.length;++k){g=c.altNames[k];e=g.value;if(7===g.type&&g.ip){if(e=a.util.bytesFromIP(g.ip),null===e)throw e=Error('Extension "ip" value is not a valid IPv4 or IPv6 address.'),
e.extension=c,e;}else 8===g.type&&(g.oid?e=b.oidToDer(b.oidToDer(g.oid)):e=b.oidToDer(e));c.value.value.push(b.create(b.Class.CONTEXT_SPECIFIC,g.type,!1,e))}else"subjectKeyIdentifier"===c.name&&d.cert&&(e=d.cert.generateSubjectKeyIdentifier(),c.subjectKeyIdentifier=e.toHex(),c.value=b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,e.getBytes()));if("undefined"==typeof c.value)throw e=Error("Extension value not specified."),e.extension=c,e;return c}function h(a,c){switch(a){case f["RSASSA-PSS"]:var d=
[];return void 0!==c.hash.algorithmOid&&d.push(b.create(b.Class.CONTEXT_SPECIFIC,0,!0,[b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(c.hash.algorithmOid).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.NULL,!1,"")])])),void 0!==c.mgf.algorithmOid&&d.push(b.create(b.Class.CONTEXT_SPECIFIC,1,!0,[b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(c.mgf.algorithmOid).getBytes()),b.create(b.Class.UNIVERSAL,
b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(c.mgf.hash.algorithmOid).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.NULL,!1,"")])])])),void 0!==c.saltLength&&d.push(b.create(b.Class.CONTEXT_SPECIFIC,2,!0,[b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,b.integerToDer(c.saltLength).getBytes())])),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,d);default:return b.create(b.Class.UNIVERSAL,b.Type.NULL,!1,"")}}function c(c){var d=b.create(b.Class.CONTEXT_SPECIFIC,0,!0,[]);if(0===
c.attributes.length)return d;c=c.attributes;for(var f=0;f<c.length;++f){var e=c[f],g=e.value,k=b.Type.UTF8;"valueTagClass"in e&&(k=e.valueTagClass);k===b.Type.UTF8&&(g=a.util.encodeUtf8(g));var h=!1;"valueConstructed"in e&&(h=e.valueConstructed);e=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(e.type).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.SET,!0,[b.create(b.Class.UNIVERSAL,k,h,g)])]);d.value.push(e)}return d}var b=a.asn1,n=a.pki=a.pki||{},
f=n.oids,m={};m.CN=f.commonName;m.commonName="CN";m.C=f.countryName;m.countryName="C";m.L=f.localityName;m.localityName="L";m.ST=f.stateOrProvinceName;m.stateOrProvinceName="ST";m.O=f.organizationName;m.organizationName="O";m.OU=f.organizationalUnitName;m.organizationalUnitName="OU";m.E=f.emailAddress;m.emailAddress="E";var u=a.pki.rsa.publicKeyValidator,q={name:"Certificate",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:b.Class.UNIVERSAL,
type:b.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:b.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",
tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:b.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",
tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:b.Class.UNIVERSAL,type:b.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:b.Class.UNIVERSAL,type:b.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:b.Class.UNIVERSAL,
type:b.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:b.Class.UNIVERSAL,type:b.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},u,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:b.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,
optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:b.Class.UNIVERSAL,type:b.Type.BITSTRING,constructed:!1,capture:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:b.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:b.Class.UNIVERSAL,type:b.Type.BITSTRING,constructed:!1,capture:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:b.Class.CONTEXT_SPECIFIC,
type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:b.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:b.Class.UNIVERSAL,
type:b.Type.BITSTRING,constructed:!1,capture:"certSignature"}]},v={name:"rsapss",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:b.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:b.Class.UNIVERSAL,type:b.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"hashOid"}]}]},
{name:"rsapss.maskGenAlgorithm",tagClass:b.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:b.Class.UNIVERSAL,type:b.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",
tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:b.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:b.Class.UNIVERSAL,type:b.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:b.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:b.Class.UNIVERSAL,type:b.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},
J={name:"CertificationRequest",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[{name:"CertificationRequestInfo",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,
captureAsn1:"certificationRequestInfoSubject"},u,{name:"CertificationRequestInfo.attributes",tagClass:b.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:b.Class.UNIVERSAL,
type:b.Type.SET,constructed:!0}]}]}]},{name:"CertificationRequest.signatureAlgorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:b.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:b.Class.UNIVERSAL,type:b.Type.BITSTRING,
constructed:!1,capture:"csrSignature"}]};n.RDNAttributesAsArray=function(a,c){for(var d=[],e,g,k,h=0;h<a.value.length;++h){e=a.value[h];for(var n=0;n<e.value.length;++n)k={},g=e.value[n],k.type=b.derToOid(g.value[0].value),k.value=g.value[1].value,k.valueTagClass=g.value[1].type,k.type in f&&(k.name=f[k.type],k.name in m&&(k.shortName=m[k.name])),c&&(c.update(k.type),c.update(k.value)),d.push(k)}return d};n.CRIAttributesAsArray=function(a){for(var c=[],d=0;d<a.length;++d)for(var e=a[d],g=b.derToOid(e.value[0].value),
e=e.value[1].value,k=0;k<e.length;++k){var h={};h.type=g;h.value=e[k].value;h.valueTagClass=e[k].type;h.type in f&&(h.name=f[h.type],h.name in m&&(h.shortName=m[h.name]));if(h.type===f.extensionRequest){h.extensions=[];for(var q=0;q<h.value.length;++q)h.extensions.push(n.certificateExtensionFromAsn1(h.value[q]))}c.push(h)}return c};var r=function(a,c,d){var e={};if(a!==f["RSASSA-PSS"])return e;d&&(e={hash:{algorithmOid:f.sha1},mgf:{algorithmOid:f.mgf1,hash:{algorithmOid:f.sha1}},saltLength:20});d=
{};a=[];if(!b.validate(c,v,d,a))throw c=Error("Cannot read RSASSA-PSS parameter block."),c.errors=a,c;return void 0!==d.hashOid&&(e.hash=e.hash||{},e.hash.algorithmOid=b.derToOid(d.hashOid)),void 0!==d.maskGenOid&&(e.mgf=e.mgf||{},e.mgf.algorithmOid=b.derToOid(d.maskGenOid),e.mgf.hash=e.mgf.hash||{},e.mgf.hash.algorithmOid=b.derToOid(d.maskGenHashOid)),void 0!==d.saltLength&&(e.saltLength=d.saltLength.charCodeAt(0)),e};n.certificateFromPem=function(c,d,f){c=a.pem.decode(c)[0];if("CERTIFICATE"!==c.type&&
"X509 CERTIFICATE"!==c.type&&"TRUSTED CERTIFICATE"!==c.type)throw d=Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".'),d.headerType=c.type,d;if(c.procType&&"ENCRYPTED"===c.procType.type)throw Error("Could not convert certificate from PEM; PEM is encrypted.");f=b.fromDer(c.body,f);return n.certificateFromAsn1(f,d)};n.certificateToPem=function(c,d){var f={type:"CERTIFICATE",body:b.toDer(n.certificateToAsn1(c)).getBytes()};
return a.pem.encode(f,{maxline:d})};n.publicKeyFromPem=function(c){c=a.pem.decode(c)[0];if("PUBLIC KEY"!==c.type&&"RSA PUBLIC KEY"!==c.type){var d=Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw d.headerType=c.type,d;}if(c.procType&&"ENCRYPTED"===c.procType.type)throw Error("Could not convert public key from PEM; PEM is encrypted.");c=b.fromDer(c.body);return n.publicKeyFromAsn1(c)};n.publicKeyToPem=function(c,d){var f={type:"PUBLIC KEY",
body:b.toDer(n.publicKeyToAsn1(c)).getBytes()};return a.pem.encode(f,{maxline:d})};n.publicKeyToRSAPublicKeyPem=function(c,d){var f={type:"RSA PUBLIC KEY",body:b.toDer(n.publicKeyToRSAPublicKey(c)).getBytes()};return a.pem.encode(f,{maxline:d})};n.getPublicKeyFingerprint=function(c,d){d=d||{};var f=d.md||a.md.sha1.create(),e;switch(d.type||"RSAPublicKey"){case "RSAPublicKey":e=b.toDer(n.publicKeyToRSAPublicKey(c)).getBytes();break;case "SubjectPublicKeyInfo":e=b.toDer(n.publicKeyToAsn1(c)).getBytes();
break;default:throw Error('Unknown fingerprint type "'+d.type+'".');}f.start();f.update(e);f=f.digest();if("hex"===d.encoding)return f=f.toHex(),d.delimiter?f.match(/.{2}/g).join(d.delimiter):f;if("binary"===d.encoding)return f.getBytes();if(d.encoding)throw Error('Unknown encoding "'+d.encoding+'".');return f};n.certificationRequestFromPem=function(c,d,f){c=a.pem.decode(c)[0];if("CERTIFICATE REQUEST"!==c.type)throw d=Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".'),
d.headerType=c.type,d;if(c.procType&&"ENCRYPTED"===c.procType.type)throw Error("Could not convert certification request from PEM; PEM is encrypted.");f=b.fromDer(c.body,f);return n.certificationRequestFromAsn1(f,d)};n.certificationRequestToPem=function(c,d){var f={type:"CERTIFICATE REQUEST",body:b.toDer(n.certificationRequestToAsn1(c)).getBytes()};return a.pem.encode(f,{maxline:d})};n.createCertificate=function(){var c={};return c.version=2,c.serialNumber="00",c.signatureOid=null,c.signature=null,
c.siginfo={},c.siginfo.algorithmOid=null,c.validity={},c.validity.notBefore=new Date,c.validity.notAfter=new Date,c.issuer={},c.issuer.getField=function(a){return e(c.issuer,a)},c.issuer.addField=function(a){k([a]);c.issuer.attributes.push(a)},c.issuer.attributes=[],c.issuer.hash=null,c.subject={},c.subject.getField=function(a){return e(c.subject,a)},c.subject.addField=function(a){k([a]);c.subject.attributes.push(a)},c.subject.attributes=[],c.subject.hash=null,c.extensions=[],c.publicKey=null,c.md=
null,c.setSubject=function(a,b){k(a);c.subject.attributes=a;delete c.subject.uniqueId;b&&(c.subject.uniqueId=b);c.subject.hash=null},c.setIssuer=function(a,b){k(a);c.issuer.attributes=a;delete c.issuer.uniqueId;b&&(c.issuer.uniqueId=b);c.issuer.hash=null},c.setExtensions=function(a){for(var b=0;b<a.length;++b)g(a[b],{cert:c});c.extensions=a},c.getExtension=function(a){"string"==typeof a&&(a={name:a});for(var b=null,d,f=0;null===b&&f<c.extensions.length;++f)d=c.extensions[f],a.id&&d.id===a.id?b=d:
a.name&&d.name===a.name&&(b=d);return b},c.sign=function(d,e){c.md=e||a.md.sha1.create();var g=f[c.md.algorithm+"WithRSAEncryption"];if(!g)throw g=Error("Could not compute certificate digest. Unknown message digest algorithm OID."),g.algorithm=c.md.algorithm,g;c.signatureOid=c.siginfo.algorithmOid=g;c.tbsCertificate=n.getTBSCertificate(c);g=b.toDer(c.tbsCertificate);c.md.update(g.getBytes());c.signature=d.sign(c.md)},c.verify=function(d){var e=!1;if(!c.issued(d)){var e=c.subject,g=Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");
throw g.expectedIssuer=d.issuer.attributes,g.actualIssuer=e.attributes,g;}g=d.md;if(null===g){if(d.signatureOid in f)switch(f[d.signatureOid]){case "sha1WithRSAEncryption":g=a.md.sha1.create();break;case "md5WithRSAEncryption":g=a.md.md5.create();break;case "sha256WithRSAEncryption":g=a.md.sha256.create();break;case "RSASSA-PSS":g=a.md.sha256.create()}if(null===g)throw g=Error("Could not compute certificate digest. Unknown signature OID."),g.signatureOid=d.signatureOid,g;var k=d.tbsCertificate||n.getTBSCertificate(d),
k=b.toDer(k);g.update(k.getBytes())}if(null!==g){var h;switch(d.signatureOid){case f.sha1WithRSAEncryption:h=void 0;break;case f["RSASSA-PSS"]:e=f[d.signatureParameters.mgf.hash.algorithmOid];if(void 0===e||void 0===a.md[e])throw g=Error("Unsupported MGF hash function."),g.oid=d.signatureParameters.mgf.hash.algorithmOid,g.name=e,g;h=f[d.signatureParameters.mgf.algorithmOid];if(void 0===h||void 0===a.mgf[h])throw g=Error("Unsupported MGF function."),g.oid=d.signatureParameters.mgf.algorithmOid,g.name=
h,g;h=a.mgf[h].create(a.md[e].create());e=f[d.signatureParameters.hash.algorithmOid];if(void 0===e||void 0===a.md[e])throw{message:"Unsupported RSASSA-PSS hash function.",oid:d.signatureParameters.hash.algorithmOid,name:e};h=a.pss.create(a.md[e].create(),h,d.signatureParameters.saltLength)}e=c.publicKey.verify(g.digest().getBytes(),d.signature,h)}return e},c.isIssuer=function(a){var b=!1,d=c.issuer;a=a.subject;if(d.hash&&a.hash)b=d.hash===a.hash;else if(d.attributes.length===a.attributes.length)for(var b=
!0,f,e,g=0;b&&g<d.attributes.length;++g)if(f=d.attributes[g],e=a.attributes[g],f.type!==e.type||f.value!==e.value)b=!1;return b},c.issued=function(a){return a.isIssuer(c)},c.generateSubjectKeyIdentifier=function(){return n.getPublicKeyFingerprint(c.publicKey,{type:"RSAPublicKey"})},c.verifySubjectKeyIdentifier=function(){for(var b=f.subjectKeyIdentifier,d=0;d<c.extensions.length;++d){var e=c.extensions[d];if(e.id===b)return b=c.generateSubjectKeyIdentifier().getBytes(),a.util.hexToBytes(e.subjectKeyIdentifier)===
b}return!1},c};n.certificateFromAsn1=function(c,d){var g={},h=[];if(!b.validate(c,q,g,h))throw g=Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate."),g.errors=h,g;if("string"!=typeof g.certSignature){for(var h="\x00",m=0;m<g.certSignature.length;++m)h+=b.toDer(g.certSignature[m]).getBytes();g.certSignature=h}h=b.derToOid(g.publicKeyOid);if(h!==n.oids.rsaEncryption)throw Error("Cannot read public key. OID is not RSA.");var l=n.createCertificate();l.version=g.certVersion?
g.certVersion.charCodeAt(0):0;h=a.util.createBuffer(g.certSerialNumber);l.serialNumber=h.toHex();l.signatureOid=a.asn1.derToOid(g.certSignatureOid);l.signatureParameters=r(l.signatureOid,g.certSignatureParams,!0);l.siginfo.algorithmOid=a.asn1.derToOid(g.certinfoSignatureOid);l.siginfo.parameters=r(l.siginfo.algorithmOid,g.certinfoSignatureParams,!1);h=a.util.createBuffer(g.certSignature);++h.read;l.signature=h.getBytes();h=[];void 0!==g.certValidity1UTCTime&&h.push(b.utcTimeToDate(g.certValidity1UTCTime));
void 0!==g.certValidity2GeneralizedTime&&h.push(b.generalizedTimeToDate(g.certValidity2GeneralizedTime));void 0!==g.certValidity3UTCTime&&h.push(b.utcTimeToDate(g.certValidity3UTCTime));void 0!==g.certValidity4GeneralizedTime&&h.push(b.generalizedTimeToDate(g.certValidity4GeneralizedTime));if(2<h.length)throw Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(2>h.length)throw Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");
l.validity.notBefore=h[0];l.validity.notAfter=h[1];l.tbsCertificate=g.tbsCertificate;if(d){l.md=null;if(l.signatureOid in f)switch(h=f[l.signatureOid],h){case "sha1WithRSAEncryption":l.md=a.md.sha1.create();break;case "md5WithRSAEncryption":l.md=a.md.md5.create();break;case "sha256WithRSAEncryption":l.md=a.md.sha256.create();break;case "RSASSA-PSS":l.md=a.md.sha256.create()}if(null===l.md)throw g=Error("Could not compute certificate digest. Unknown signature OID."),g.signatureOid=l.signatureOid,g;
h=b.toDer(l.tbsCertificate);l.md.update(h.getBytes())}h=a.md.sha1.create();l.issuer.getField=function(a){return e(l.issuer,a)};l.issuer.addField=function(a){k([a]);l.issuer.attributes.push(a)};l.issuer.attributes=n.RDNAttributesAsArray(g.certIssuer,h);g.certIssuerUniqueId&&(l.issuer.uniqueId=g.certIssuerUniqueId);l.issuer.hash=h.digest().toHex();h=a.md.sha1.create();return l.subject.getField=function(a){return e(l.subject,a)},l.subject.addField=function(a){k([a]);l.subject.attributes.push(a)},l.subject.attributes=
n.RDNAttributesAsArray(g.certSubject,h),g.certSubjectUniqueId&&(l.subject.uniqueId=g.certSubjectUniqueId),l.subject.hash=h.digest().toHex(),g.certExtensions?l.extensions=n.certificateExtensionsFromAsn1(g.certExtensions):l.extensions=[],l.publicKey=n.publicKeyFromAsn1(g.subjectPublicKeyInfo),l};n.certificateExtensionsFromAsn1=function(a){for(var b=[],c=0;c<a.value.length;++c)for(var d=a.value[c],f=0;f<d.value.length;++f)b.push(n.certificateExtensionFromAsn1(d.value[f]));return b};n.certificateExtensionFromAsn1=
function(c){var d={};d.id=b.derToOid(c.value[0].value);d.critical=!1;c.value[1].type===b.Type.BOOLEAN?(d.critical=0!==c.value[1].value.charCodeAt(0),d.value=c.value[2].value):d.value=c.value[1].value;if(d.id in f)if(d.name=f[d.id],"keyUsage"===d.name){c=b.fromDer(d.value);var g=0,e=0;1<c.value.length&&(g=c.value.charCodeAt(1),e=2<c.value.length?c.value.charCodeAt(2):0);d.digitalSignature=128===(g&128);d.nonRepudiation=64===(g&64);d.keyEncipherment=32===(g&32);d.dataEncipherment=16===(g&16);d.keyAgreement=
8===(g&8);d.keyCertSign=4===(g&4);d.cRLSign=2===(g&2);d.encipherOnly=1===(g&1);d.decipherOnly=128===(e&128)}else if("basicConstraints"===d.name)c=b.fromDer(d.value),0<c.value.length&&c.value[0].type===b.Type.BOOLEAN?d.cA=0!==c.value[0].value.charCodeAt(0):d.cA=!1,g=null,0<c.value.length&&c.value[0].type===b.Type.INTEGER?g=c.value[0].value:1<c.value.length&&(g=c.value[1].value),null!==g&&(d.pathLenConstraint=b.derToInteger(g));else if("extKeyUsage"===d.name)for(c=b.fromDer(d.value),g=0;g<c.value.length;++g)e=
b.derToOid(c.value[g].value),e in f?d[f[e]]=!0:d[e]=!0;else if("nsCertType"===d.name)c=b.fromDer(d.value),g=0,1<c.value.length&&(g=c.value.charCodeAt(1)),d.client=128===(g&128),d.server=64===(g&64),d.email=32===(g&32),d.objsign=16===(g&16),d.reserved=8===(g&8),d.sslCA=4===(g&4),d.emailCA=2===(g&2),d.objCA=1===(g&1);else if("subjectAltName"===d.name||"issuerAltName"===d.name)for(d.altNames=[],c=b.fromDer(d.value),e=0;e<c.value.length;++e){var g=c.value[e],h={type:g.type,value:g.value};d.altNames.push(h);
switch(g.type){case 7:h.ip=a.util.bytesToIP(g.value);break;case 8:h.oid=b.derToOid(g.value)}}else"subjectKeyIdentifier"===d.name&&(c=b.fromDer(d.value),d.subjectKeyIdentifier=a.util.bytesToHex(c.value));return d};n.certificationRequestFromAsn1=function(c,d){var g={},h=[];if(!b.validate(c,J,g,h))throw g=Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest."),g.errors=h,g;if("string"!=typeof g.csrSignature){for(var h="\x00",m=0;m<g.csrSignature.length;++m)h+=
b.toDer(g.csrSignature[m]).getBytes();g.csrSignature=h}h=b.derToOid(g.publicKeyOid);if(h!==n.oids.rsaEncryption)throw Error("Cannot read public key. OID is not RSA.");var l=n.createCertificationRequest();l.version=g.csrVersion?g.csrVersion.charCodeAt(0):0;l.signatureOid=a.asn1.derToOid(g.csrSignatureOid);l.signatureParameters=r(l.signatureOid,g.csrSignatureParams,!0);l.siginfo.algorithmOid=a.asn1.derToOid(g.csrSignatureOid);l.siginfo.parameters=r(l.siginfo.algorithmOid,g.csrSignatureParams,!1);h=
a.util.createBuffer(g.csrSignature);++h.read;l.signature=h.getBytes();l.certificationRequestInfo=g.certificationRequestInfo;if(d){l.md=null;if(l.signatureOid in f)switch(h=f[l.signatureOid],h){case "sha1WithRSAEncryption":l.md=a.md.sha1.create();break;case "md5WithRSAEncryption":l.md=a.md.md5.create();break;case "sha256WithRSAEncryption":l.md=a.md.sha256.create();break;case "RSASSA-PSS":l.md=a.md.sha256.create()}if(null===l.md)throw g=Error("Could not compute certification request digest. Unknown signature OID."),
g.signatureOid=l.signatureOid,g;h=b.toDer(l.certificationRequestInfo);l.md.update(h.getBytes())}h=a.md.sha1.create();return l.subject.getField=function(a){return e(l.subject,a)},l.subject.addField=function(a){k([a]);l.subject.attributes.push(a)},l.subject.attributes=n.RDNAttributesAsArray(g.certificationRequestInfoSubject,h),l.subject.hash=h.digest().toHex(),l.publicKey=n.publicKeyFromAsn1(g.subjectPublicKeyInfo),l.getAttribute=function(a){return e(l,a)},l.addAttribute=function(a){k([a]);l.attributes.push(a)},
l.attributes=n.CRIAttributesAsArray(g.certificationRequestInfoAttributes||[]),l};n.createCertificationRequest=function(){var c={};return c.version=0,c.signatureOid=null,c.signature=null,c.siginfo={},c.siginfo.algorithmOid=null,c.subject={},c.subject.getField=function(a){return e(c.subject,a)},c.subject.addField=function(a){k([a]);c.subject.attributes.push(a)},c.subject.attributes=[],c.subject.hash=null,c.publicKey=null,c.attributes=[],c.getAttribute=function(a){return e(c,a)},c.addAttribute=function(a){k([a]);
c.attributes.push(a)},c.md=null,c.setSubject=function(a){k(a);c.subject.attributes=a;c.subject.hash=null},c.setAttributes=function(a){k(a);c.attributes=a},c.sign=function(d,g){c.md=g||a.md.sha1.create();var e=f[c.md.algorithm+"WithRSAEncryption"];if(!e)throw e=Error("Could not compute certification request digest. Unknown message digest algorithm OID."),e.algorithm=c.md.algorithm,e;c.signatureOid=c.siginfo.algorithmOid=e;c.certificationRequestInfo=n.getCertificationRequestInfo(c);e=b.toDer(c.certificationRequestInfo);
c.md.update(e.getBytes());c.signature=d.sign(c.md)},c.verify=function(){var d=!1,g=c.md;if(null===g){if(c.signatureOid in f)switch(f[c.signatureOid]){case "sha1WithRSAEncryption":g=a.md.sha1.create();break;case "md5WithRSAEncryption":g=a.md.md5.create();break;case "sha256WithRSAEncryption":g=a.md.sha256.create();break;case "RSASSA-PSS":g=a.md.sha256.create()}if(null===g)throw g=Error("Could not compute certification request digest. Unknown signature OID."),g.signatureOid=c.signatureOid,g;var e=c.certificationRequestInfo||
n.getCertificationRequestInfo(c),e=b.toDer(e);g.update(e.getBytes())}if(null!==g){var h;switch(c.signatureOid){case f["RSASSA-PSS"]:d=f[c.signatureParameters.mgf.hash.algorithmOid];if(void 0===d||void 0===a.md[d])throw g=Error("Unsupported MGF hash function."),g.oid=c.signatureParameters.mgf.hash.algorithmOid,g.name=d,g;h=f[c.signatureParameters.mgf.algorithmOid];if(void 0===h||void 0===a.mgf[h])throw g=Error("Unsupported MGF function."),g.oid=c.signatureParameters.mgf.algorithmOid,g.name=h,g;h=a.mgf[h].create(a.md[d].create());
d=f[c.signatureParameters.hash.algorithmOid];if(void 0===d||void 0===a.md[d])throw g=Error("Unsupported RSASSA-PSS hash function."),g.oid=c.signatureParameters.hash.algorithmOid,g.name=d,g;h=a.pss.create(a.md[d].create(),h,c.signatureParameters.saltLength)}d=c.publicKey.verify(g.digest().getBytes(),c.signature,h)}return d},c};n.getTBSCertificate=function(c){var f=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.CONTEXT_SPECIFIC,0,!0,[b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,b.integerToDer(c.version).getBytes())]),
b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,a.util.hexToBytes(c.serialNumber)),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(c.siginfo.algorithmOid).getBytes()),h(c.siginfo.algorithmOid,c.siginfo.parameters)]),d(c.issuer),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.UTCTIME,!1,b.dateToUtcTime(c.validity.notBefore)),b.create(b.Class.UNIVERSAL,b.Type.UTCTIME,!1,b.dateToUtcTime(c.validity.notAfter))]),d(c.subject),
n.publicKeyToAsn1(c.publicKey)]);return c.issuer.uniqueId&&f.value.push(b.create(b.Class.CONTEXT_SPECIFIC,1,!0,[b.create(b.Class.UNIVERSAL,b.Type.BITSTRING,!1,String.fromCharCode(0)+c.issuer.uniqueId)])),c.subject.uniqueId&&f.value.push(b.create(b.Class.CONTEXT_SPECIFIC,2,!0,[b.create(b.Class.UNIVERSAL,b.Type.BITSTRING,!1,String.fromCharCode(0)+c.subject.uniqueId)])),0<c.extensions.length&&f.value.push(n.certificateExtensionsToAsn1(c.extensions)),f};n.getCertificationRequestInfo=function(a){return b.create(b.Class.UNIVERSAL,
b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,b.integerToDer(a.version).getBytes()),d(a.subject),n.publicKeyToAsn1(a.publicKey),c(a)])};n.distinguishedNameToAsn1=function(a){return d(a)};n.certificateToAsn1=function(a){var c=a.tbsCertificate||n.getTBSCertificate(a);return b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[c,b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(a.signatureOid).getBytes()),h(a.signatureOid,a.signatureParameters)]),
b.create(b.Class.UNIVERSAL,b.Type.BITSTRING,!1,String.fromCharCode(0)+a.signature)])};n.certificateExtensionsToAsn1=function(a){var c=b.create(b.Class.CONTEXT_SPECIFIC,3,!0,[]),d=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[]);c.value.push(d);for(var f=0;f<a.length;++f)d.value.push(n.certificateExtensionToAsn1(a[f]));return c};n.certificateExtensionToAsn1=function(a){var c=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[]);c.value.push(b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(a.id).getBytes()));
a.critical&&c.value.push(b.create(b.Class.UNIVERSAL,b.Type.BOOLEAN,!1,String.fromCharCode(255)));var d=a.value;return"string"!=typeof a.value&&(d=b.toDer(d).getBytes()),c.value.push(b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,d)),c};n.certificationRequestToAsn1=function(a){var c=a.certificationRequestInfo||n.getCertificationRequestInfo(a);return b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[c,b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(a.signatureOid).getBytes()),
h(a.signatureOid,a.signatureParameters)]),b.create(b.Class.UNIVERSAL,b.Type.BITSTRING,!1,String.fromCharCode(0)+a.signature)])};n.createCaStore=function(c){function f(c){if(!c.hash){var b=a.md.sha1.create();c.attributes=n.RDNAttributesAsArray(d(c),b);c.hash=b.digest().toHex()}return g.certs[c.hash]||null}var g={certs:{},getIssuer:function(a){return f(a.issuer)},addCertificate:function(c){"string"==typeof c&&(c=a.pki.certificateFromPem(c));if(!c.subject.hash){var b=a.md.sha1.create();c.subject.attributes=
n.RDNAttributesAsArray(d(c.subject),b);c.subject.hash=b.digest().toHex()}c.subject.hash in g.certs?(b=g.certs[c.subject.hash],a.util.isArray(b)||(b=[b]),b.push(c)):g.certs[c.subject.hash]=c},hasCertificate:function(c){var d=f(c.subject);if(!d)return!1;a.util.isArray(d)||(d=[d]);c=b.toDer(n.certificateToAsn1(c)).getBytes();for(var g=0;g<d.length;++g){var e=b.toDer(n.certificateToAsn1(d[g])).getBytes();if(c===e)return!0}return!1}};if(c)for(var e=0;e<c.length;++e)g.addCertificate(c[e]);return g};n.certificateError=
{bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"};n.verifyCertificateChain=function(c,b,d){b=b.slice(0);var f=b.slice(0),g=new Date,e=!0,h=null,k=0;do{var m=b.shift(),q=null,u=!1;if(g<m.validity.notBefore||g>m.validity.notAfter)h={message:"Certificate is not valid yet or has expired.",
error:n.certificateError.certificate_expired,notBefore:m.validity.notBefore,notAfter:m.validity.notAfter,now:g};if(null===h){q=b[0]||c.getIssuer(m);null===q&&m.isIssuer(m)&&(u=!0,q=m);if(q){var r=q;a.util.isArray(r)||(r=[r]);for(var w=!1;!w&&0<r.length;){q=r.shift();try{w=q.verify(m)}catch(v){}}w||(h={message:"Certificate signature is invalid.",error:n.certificateError.bad_certificate})}null!==h||q&&!u||c.hasCertificate(m)||(h={message:"Certificate is not trusted.",error:n.certificateError.unknown_ca})}null===
h&&q&&!m.isIssuer(q)&&(h={message:"Certificate issuer is invalid.",error:n.certificateError.bad_certificate});if(null===h)for(r={keyUsage:!0,basicConstraints:!0},w=0;null===h&&w<m.extensions.length;++w){var J=m.extensions[w];!J.critical||J.name in r||(h={message:"Certificate has an unsupported critical extension.",error:n.certificateError.unsupported_certificate})}null!==h||e&&(0!==b.length||q&&!u)||(e=m.getExtension("basicConstraints"),m=m.getExtension("keyUsage"),null===m||m.keyCertSign&&null!==
e||(h={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:n.certificateError.bad_certificate}),null===h&&null!==e&&!e.cA&&(h={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:n.certificateError.bad_certificate}),null===h&&null!==m&&"pathLenConstraint"in e&&k-1>e.pathLenConstraint&&(h={message:"Certificate basicConstraints pathLenConstraint violated.",
error:n.certificateError.bad_certificate}));m=null===h?!0:h.error;e=d?d(m,k,f):m;if(!0!==e){!0===m&&(h={message:"The application rejected the certificate.",error:n.certificateError.bad_certificate});if(e||0===e)"object"!=typeof e||a.util.isArray(e)?"string"==typeof e&&(h.error=e):(e.message&&(h.message=e.message),e.error&&(h.error=e.error));throw h;}h=null;e=!1;++k}while(0<b.length);return!0}}if("function"!=typeof m){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge=
{}),x(forge);var F=!0;m=function(a,e){e(G,module)}}var y,C=function(a,e){e.exports=function(d){var e=y.map(function(d){return a(d)}).concat(x);d=d||{};d.defined=d.defined||{};if(d.defined.x509)return d.x509;d.defined.x509=!0;for(var g=0;g<e.length;++g)e[g](d);return d.pki}},t=m;m=function(a,e){return y="string"==typeof a?e.slice(2):a.slice(2),F?(delete m,t.apply(null,Array.prototype.slice.call(arguments,0))):(m=t,m.apply(null,Array.prototype.slice.call(arguments,0)))};m("js/x509","require module ./aes ./asn1 ./des ./md ./mgf ./oids ./pem ./pss ./rsa ./util".split(" "),
function(){C.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function x(a){function e(a,c,b,d){for(var f=[],g=0;g<a.length;g++)for(var e=0;e<a[g].safeBags.length;e++){var h=a[g].safeBags[e];if(void 0===d||h.type===d)null===c?f.push(h):void 0!==h.attributes[c]&&0<=h.attributes[c].indexOf(b)&&f.push(h)}return f}function d(c){if(c.composed||c.constructed){for(var b=a.util.createBuffer(),d=0;d<c.value.length;++d)b.putBytes(c.value[d].value);c.composed=c.constructed=!1;c.value=b.getBytes()}return c}
function k(e,h,k,n){h=c.fromDer(h,k);if(h.tagClass!==c.Class.UNIVERSAL||h.type!==c.Type.SEQUENCE||!0!==h.constructed)throw Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var m=0;m<h.value.length;m++){var q={},u=[];if(!c.validate(h.value[m],f,q,u))throw e=Error("Cannot read ContentInfo."),e.errors=u,e;var u={encrypted:!1},l=q.content.value[0];switch(c.derToOid(q.contentType)){case b.oids.data:if(l.tagClass!==c.Class.UNIVERSAL||l.type!==c.Type.OCTETSTRING)throw Error("PKCS#12 SafeContents Data is not an OCTET STRING.");
q=d(l).value;break;case b.oids.encryptedData:var w=n,q={},v=[];if(!c.validate(l,a.pkcs7.asn1.encryptedDataValidator,q,v))throw e=Error("Cannot read EncryptedContentInfo."),e.errors=v,e;l=c.derToOid(q.contentType);if(l!==b.oids.data)throw e=Error("PKCS#12 EncryptedContentInfo ContentType is not Data."),e.oid=l,e;l=c.derToOid(q.encAlgorithm);l=b.pbe.getCipher(l,q.encParameter,w);q=d(q.encryptedContentAsn1);q=a.util.createBuffer(q.value);l.update(q);if(!l.finish())throw Error("Failed to decrypt PKCS#12 SafeContents.");
q=l.output.getBytes();u.encrypted=!0;break;default:throw e=Error("Unsupported PKCS#12 contentType."),e.contentType=c.derToOid(q.contentType),e;}u.safeBags=g(q,k,n);e.safeContents.push(u)}}function g(a,d,f){if(!d&&0===a.length)return[];a=c.fromDer(a,d);if(a.tagClass!==c.Class.UNIVERSAL||a.type!==c.Type.SEQUENCE||!0!==a.constructed)throw Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var g=[],e=0;e<a.value.length;e++){var k={},n=[];if(!c.validate(a.value[e],u,k,n))throw a=Error("Cannot read SafeBag."),
a.errors=n,a;var l={type:c.derToOid(k.bagId),attributes:h(k.bagAttributes)};g.push(l);var m,q,w=k.bagValue.value[0];switch(l.type){case b.oids.pkcs8ShroudedKeyBag:if(w=b.decryptPrivateKeyInfo(w,f),null===w)throw Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case b.oids.keyBag:try{l.key=b.privateKeyFromAsn1(w)}catch(t){l.key=null,l.asn1=w}continue;case b.oids.certBag:m=v;q=function(){if(c.derToOid(k.certId)!==b.oids.x509Certificate){var a=Error("Unsupported certificate type, only X.509 supported.");
throw a.oid=c.derToOid(k.certId),a;}a=c.fromDer(k.cert,d);try{l.cert=b.certificateFromAsn1(a,!0)}catch(f){l.cert=null,l.asn1=a}};break;default:throw a=Error("Unsupported PKCS#12 SafeBag type."),a.oid=l.type,a;}if(void 0!==m&&!c.validate(w,m,k,n))throw a=Error("Cannot read PKCS#12 "+m.name),a.errors=n,a;q()}return g}function h(a){var d={};if(void 0!==a)for(var f=0;f<a.length;++f){var g={},e=[];if(!c.validate(a[f],q,g,e))throw a=Error("Cannot read PKCS#12 BagAttribute."),a.errors=e,a;e=c.derToOid(g.oid);
if(void 0!==b.oids[e]){d[b.oids[e]]=[];for(var h=0;h<g.values.length;++h)d[b.oids[e]].push(g.values[h].value)}}return d}var c=a.asn1,b=a.pki,n=a.pkcs12=a.pkcs12||{},f={name:"ContentInfo",tagClass:c.Class.UNIVERSAL,type:c.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:c.Class.UNIVERSAL,type:c.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:c.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},m={name:"PFX",tagClass:c.Class.UNIVERSAL,
type:c.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:c.Class.UNIVERSAL,type:c.Type.INTEGER,constructed:!1,capture:"version"},f,{name:"PFX.macData",tagClass:c.Class.UNIVERSAL,type:c.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:c.Class.UNIVERSAL,type:c.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:c.Class.UNIVERSAL,type:c.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",
tagClass:c.Class.UNIVERSAL,type:c.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:c.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:c.Class.UNIVERSAL,type:c.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:c.Class.UNIVERSAL,type:c.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:c.Class.UNIVERSAL,type:c.Type.INTEGER,
constructed:!1,optional:!0,capture:"macIterations"}]}]},u={name:"SafeBag",tagClass:c.Class.UNIVERSAL,type:c.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:c.Class.UNIVERSAL,type:c.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:c.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:c.Class.UNIVERSAL,type:c.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},q={name:"Attribute",tagClass:c.Class.UNIVERSAL,
type:c.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:c.Class.UNIVERSAL,type:c.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:c.Class.UNIVERSAL,type:c.Type.SET,constructed:!0,capture:"values"}]},v={name:"CertBag",tagClass:c.Class.UNIVERSAL,type:c.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:c.Class.UNIVERSAL,type:c.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:c.Class.CONTEXT_SPECIFIC,constructed:!0,
value:[{name:"CertBag.certValue[0]",tagClass:c.Class.UNIVERSAL,type:c.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};n.pkcs12FromAsn1=function(f,g,h){"string"==typeof g?(h=g,g=!0):void 0===g&&(g=!0);var q={};if(!c.validate(f,m,q,[]))throw g=Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX."),g.errors=g,g;var u={version:q.version.charCodeAt(0),safeContents:[],getBags:function(c){var b={},d;return"localKeyId"in c?d=c.localKeyId:"localKeyIdHex"in c&&(d=a.util.hexToBytes(c.localKeyIdHex)),
void 0===d&&!("friendlyName"in c)&&"bagType"in c&&(b[c.bagType]=e(u.safeContents,null,null,c.bagType)),void 0!==d&&(b.localKeyId=e(u.safeContents,"localKeyId",d,c.bagType)),"friendlyName"in c&&(b.friendlyName=e(u.safeContents,"friendlyName",c.friendlyName,c.bagType)),b},getBagsByFriendlyName:function(a,c){return e(u.safeContents,"friendlyName",a,c)},getBagsByLocalKeyId:function(a,c){return e(u.safeContents,"localKeyId",a,c)}};if(3!==q.version.charCodeAt(0))throw g=Error("PKCS#12 PFX of version other than 3 not supported."),
g.version=q.version.charCodeAt(0),g;if(c.derToOid(q.contentType)!==b.oids.data)throw g=Error("Only PKCS#12 PFX in password integrity mode supported."),g.oid=c.derToOid(q.contentType),g;f=q.content.value[0];if(f.tagClass!==c.Class.UNIVERSAL||f.type!==c.Type.OCTETSTRING)throw Error("PKCS#12 authSafe content data is not an OCTET STRING.");f=d(f);if(q.mac){var v=null,t=0,l=c.derToOid(q.macAlgorithm);switch(l){case b.oids.sha1:v=a.md.sha1.create();t=20;break;case b.oids.sha256:v=a.md.sha256.create();t=
32;break;case b.oids.sha384:v=a.md.sha384.create();t=48;break;case b.oids.sha512:v=a.md.sha512.create();t=64;break;case b.oids.md5:v=a.md.md5.create(),t=16}if(null===v)throw Error("PKCS#12 uses unsupported MAC algorithm: "+l);var l=new a.util.ByteBuffer(q.macSalt),y="macIterations"in q?parseInt(a.util.bytesToHex(q.macIterations),16):1,t=n.generateKey(h,l,3,y,t,v),l=a.hmac.create();l.start(v,t);l.update(f.value);if(l.getMac().getBytes()!==q.macDigest)throw Error("PKCS#12 MAC could not be verified. Invalid password?");
}return k(u,f.value,g,h),u};n.toPkcs12Asn1=function(d,f,g,e){e=e||{};e.saltSize=e.saltSize||8;e.count=e.count||2048;e.algorithm=e.algorithm||e.encAlgorithm||"aes128";"useMac"in e||(e.useMac=!0);"localKeyId"in e||(e.localKeyId=null);"generateLocalKeyId"in e||(e.generateLocalKeyId=!0);var h=e.localKeyId,k;if(null!==h)h=a.util.hexToBytes(h);else if(e.generateLocalKeyId)if(f){var m=a.util.isArray(f)?f[0]:f;"string"==typeof m&&(m=b.certificateFromPem(m));h=a.md.sha1.create();h.update(c.toDer(b.certificateToAsn1(m)).getBytes());
h=h.digest().getBytes()}else h=a.random.getBytes(20);m=[];null!==h&&m.push(c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,[c.create(c.Class.UNIVERSAL,c.Type.OID,!1,c.oidToDer(b.oids.localKeyId).getBytes()),c.create(c.Class.UNIVERSAL,c.Type.SET,!0,[c.create(c.Class.UNIVERSAL,c.Type.OCTETSTRING,!1,h)])]));"friendlyName"in e&&m.push(c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,[c.create(c.Class.UNIVERSAL,c.Type.OID,!1,c.oidToDer(b.oids.friendlyName).getBytes()),c.create(c.Class.UNIVERSAL,c.Type.SET,
!0,[c.create(c.Class.UNIVERSAL,c.Type.BMPSTRING,!1,e.friendlyName)])]));0<m.length&&(k=c.create(c.Class.UNIVERSAL,c.Type.SET,!0,m));h=[];m=[];null!==f&&(a.util.isArray(f)?m=f:m=[f]);for(var l=[],q=0;q<m.length;++q){f=m[q];"string"==typeof f&&(f=b.certificateFromPem(f));var u=0===q?k:void 0;f=b.certificateToAsn1(f);f=c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,[c.create(c.Class.UNIVERSAL,c.Type.OID,!1,c.oidToDer(b.oids.certBag).getBytes()),c.create(c.Class.CONTEXT_SPECIFIC,0,!0,[c.create(c.Class.UNIVERSAL,
c.Type.SEQUENCE,!0,[c.create(c.Class.UNIVERSAL,c.Type.OID,!1,c.oidToDer(b.oids.x509Certificate).getBytes()),c.create(c.Class.CONTEXT_SPECIFIC,0,!0,[c.create(c.Class.UNIVERSAL,c.Type.OCTETSTRING,!1,c.toDer(f).getBytes())])])]),u]);l.push(f)}0<l.length&&(f=c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,l),f=c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,[c.create(c.Class.UNIVERSAL,c.Type.OID,!1,c.oidToDer(b.oids.data).getBytes()),c.create(c.Class.CONTEXT_SPECIFIC,0,!0,[c.create(c.Class.UNIVERSAL,c.Type.OCTETSTRING,
!1,c.toDer(f).getBytes())])]),h.push(f));f=null;null!==d&&(d=b.wrapRsaPrivateKey(b.privateKeyToAsn1(d)),null===g?f=c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,[c.create(c.Class.UNIVERSAL,c.Type.OID,!1,c.oidToDer(b.oids.keyBag).getBytes()),c.create(c.Class.CONTEXT_SPECIFIC,0,!0,[d]),k]):f=c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,[c.create(c.Class.UNIVERSAL,c.Type.OID,!1,c.oidToDer(b.oids.pkcs8ShroudedKeyBag).getBytes()),c.create(c.Class.CONTEXT_SPECIFIC,0,!0,[b.encryptPrivateKeyInfo(d,g,e)]),
k]),d=c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,[f]),d=c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,[c.create(c.Class.UNIVERSAL,c.Type.OID,!1,c.oidToDer(b.oids.data).getBytes()),c.create(c.Class.CONTEXT_SPECIFIC,0,!0,[c.create(c.Class.UNIVERSAL,c.Type.OCTETSTRING,!1,c.toDer(d).getBytes())])]),h.push(d));k=c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,h);var w;e.useMac&&(h=a.md.sha1.create(),w=new a.util.ByteBuffer(a.random.getBytes(e.saltSize)),e=e.count,d=n.generateKey(g,w,3,e,20),g=a.hmac.create(),
g.start(h,d),g.update(c.toDer(k).getBytes()),g=g.getMac(),w=c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,[c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,[c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,[c.create(c.Class.UNIVERSAL,c.Type.OID,!1,c.oidToDer(b.oids.sha1).getBytes()),c.create(c.Class.UNIVERSAL,c.Type.NULL,!1,"")]),c.create(c.Class.UNIVERSAL,c.Type.OCTETSTRING,!1,g.getBytes())]),c.create(c.Class.UNIVERSAL,c.Type.OCTETSTRING,!1,w.getBytes()),c.create(c.Class.UNIVERSAL,c.Type.INTEGER,!1,c.integerToDer(e).getBytes())]));
return c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,[c.create(c.Class.UNIVERSAL,c.Type.INTEGER,!1,c.integerToDer(3).getBytes()),c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,[c.create(c.Class.UNIVERSAL,c.Type.OID,!1,c.oidToDer(b.oids.data).getBytes()),c.create(c.Class.CONTEXT_SPECIFIC,0,!0,[c.create(c.Class.UNIVERSAL,c.Type.OCTETSTRING,!1,c.toDer(k).getBytes())])]),w])};n.generateKey=a.pbe.generatePkcs12Key}if("function"!=typeof m){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&
(forge={}),x(forge);var F=!0;m=function(a,e){e(G,module)}}var y,C=function(a,e){e.exports=function(d){var e=y.map(function(d){return a(d)}).concat(x);d=d||{};d.defined=d.defined||{};if(d.defined.pkcs12)return d.pkcs12;d.defined.pkcs12=!0;for(var g=0;g<e.length;++g)e[g](d);return d.pkcs12}},t=m;m=function(a,e){return y="string"==typeof a?e.slice(2):a.slice(2),F?(delete m,t.apply(null,Array.prototype.slice.call(arguments,0))):(m=t,m.apply(null,Array.prototype.slice.call(arguments,0)))};m("js/pkcs12",
"require module ./asn1 ./hmac ./oids ./pkcs7asn1 ./pbe ./random ./rsa ./sha1 ./util ./x509".split(" "),function(){C.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function x(a){var e=a.asn1,d=a.pki=a.pki||{};d.pemToDer=function(d){d=a.pem.decode(d)[0];if(d.procType&&"ENCRYPTED"===d.procType.type)throw Error("Could not convert PEM to DER; PEM is encrypted.");return a.util.createBuffer(d.body)};d.privateKeyFromPem=function(k){k=a.pem.decode(k)[0];if("PRIVATE KEY"!==k.type&&"RSA PRIVATE KEY"!==
k.type){var g=Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw g.headerType=k.type,g;}if(k.procType&&"ENCRYPTED"===k.procType.type)throw Error("Could not convert private key from PEM; PEM is encrypted.");k=e.fromDer(k.body);return d.privateKeyFromAsn1(k)};d.privateKeyToPem=function(k,g){var h={type:"RSA PRIVATE KEY",body:e.toDer(d.privateKeyToAsn1(k)).getBytes()};return a.pem.encode(h,{maxline:g})};d.privateKeyInfoToPem=function(d,g){var h=
{type:"PRIVATE KEY",body:e.toDer(d).getBytes()};return a.pem.encode(h,{maxline:g})}}if("function"!=typeof m){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),x(forge);var F=!0;m=function(a,e){e(G,module)}}var y,C=function(a,e){e.exports=function(d){var e=y.map(function(d){return a(d)}).concat(x);d=d||{};d.defined=d.defined||{};if(d.defined.pki)return d.pki;d.defined.pki=!0;for(var g=0;g<e.length;++g)e[g](d);return d.pki}},t=m;m=function(a,e){return y="string"==
typeof a?e.slice(2):a.slice(2),F?(delete m,t.apply(null,Array.prototype.slice.call(arguments,0))):(m=t,m.apply(null,Array.prototype.slice.call(arguments,0)))};m("js/pki","require module ./asn1 ./oids ./pbe ./pem ./pbkdf2 ./pkcs12 ./pss ./rsa ./util ./x509".split(" "),function(){C.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function x(a){var e=function(c,b,d,f){var g=a.util.createBuffer(),e=c.length>>1,h=e+(c.length&1),k=c.substr(0,h),h=c.substr(e,h);c=a.util.createBuffer();
e=a.hmac.create();d=b+d;var l=Math.ceil(f/16);b=Math.ceil(f/20);e.start("MD5",k);k=a.util.createBuffer();c.putBytes(d);for(var n=0;n<l;++n)e.start(null,null),e.update(c.getBytes()),c.putBuffer(e.digest()),e.start(null,null),e.update(c.bytes()+d),k.putBuffer(e.digest());e.start("SHA1",h);h=a.util.createBuffer();c.clear();c.putBytes(d);for(n=0;n<b;++n)e.start(null,null),e.update(c.getBytes()),c.putBuffer(e.digest()),e.start(null,null),e.update(c.bytes()+d),h.putBuffer(e.digest());return g.putBytes(a.util.xorBytes(k.getBytes(),
h.getBytes(),f)),g},d=function(c,b,d){d=!1;try{var f=c.deflate(b.fragment.getBytes());b.fragment=a.util.createBuffer(f);b.length=f.length;d=!0}catch(g){}return d},k=function(c,b,d){d=!1;try{var f=c.inflate(b.fragment.getBytes());b.fragment=a.util.createBuffer(f);b.length=f.length;d=!0}catch(g){}return d},g=function(c,b){var d=0;switch(b){case 1:d=c.getByte();break;case 2:d=c.getInt16();break;case 3:d=c.getInt24();break;case 4:d=c.getInt32()}return a.util.createBuffer(c.getBytes(d))},h=function(a,
c,b){a.putInt(b.length(),c<<3);a.putBuffer(b)},c={Versions:{TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}}};c.SupportedVersions=[c.Versions.TLS_1_1,c.Versions.TLS_1_0];c.Version=c.SupportedVersions[0];c.MaxFragment=15360;c.ConnectionEnd={server:0,client:1};c.PRFAlgorithm={tls_prf_sha256:0};c.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2};c.CipherType={stream:0,block:1,aead:2};c.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4};
c.CompressionMethod={none:0,deflate:1};c.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24};c.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20};c.Alert={};c.Alert.Level={warning:1,fatal:2};c.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,
handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100};c.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2};c.CipherSuites={};c.getCipherSuite=function(a){var b=null,d;for(d in c.CipherSuites){var f=
c.CipherSuites[d];if(f.id[0]===a.charCodeAt(0)&&f.id[1]===a.charCodeAt(1)){b=f;break}}return b};c.handleUnexpected=function(a,b){!a.open&&a.entity===c.ConnectionEnd.client||a.error(a,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:c.Alert.Level.fatal,description:c.Alert.Description.unexpected_message}})};c.handleHelloRequest=function(a,b,d){!a.handshaking&&0<a.handshakes&&(c.queue(a,c.createAlert(a,{level:c.Alert.Level.warning,description:c.Alert.Description.no_renegotiation})),
c.flush(a));a.process()};c.parseHelloMessage=function(b,d,f){var e=null,h=b.entity===c.ConnectionEnd.client;if(38>f)b.error(b,{message:h?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:c.Alert.Level.fatal,description:c.Alert.Description.illegal_parameter}});else{d=d.fragment;var k=d.length(),e={version:{major:d.getByte(),minor:d.getByte()},random:a.util.createBuffer(d.getBytes(32)),session_id:g(d,1),extensions:[]};h?(e.cipher_suite=
d.getBytes(2),e.compression_method=d.getByte()):(e.cipher_suites=g(d,2),e.compression_methods=g(d,1));k=f-(k-d.length());if(0<k){for(f=g(d,2);0<f.length();)e.extensions.push({type:[f.getByte(),f.getByte()],data:g(f,2)});if(!h)for(f=0;f<e.extensions.length;++f)if(d=e.extensions[f],0===d.type[0]&&0===d.type[1])for(d=g(d.data,2);0<d.length()&&0===d.getByte();)b.session.extensions.server_name.serverNameList.push(g(d,2).getBytes())}if(b.session.version&&(e.version.major!==b.session.version.major||e.version.minor!==
b.session.version.minor))return b.error(b,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:c.Alert.Level.fatal,description:c.Alert.Description.protocol_version}});if(h)b.session.cipherSuite=c.getCipherSuite(e.cipher_suite);else for(f=a.util.createBuffer(e.cipher_suites.bytes());0<f.length()&&(b.session.cipherSuite=c.getCipherSuite(f.getBytes(2)),null===b.session.cipherSuite););if(null===b.session.cipherSuite)return b.error(b,{message:"No cipher suites in common.",
send:!0,alert:{level:c.Alert.Level.fatal,description:c.Alert.Description.handshake_failure},cipherSuite:a.util.bytesToHex(e.cipher_suite)});h?b.session.compressionMethod=e.compression_method:b.session.compressionMethod=c.CompressionMethod.none}return e};c.createSecurityParameters=function(a,b){var d=a.entity===c.ConnectionEnd.client,f=b.random.bytes(),e=d?a.session.sp.client_random:f,d=d?f:c.createRandom().getBytes();a.session.sp={entity:a.entity,prf_algorithm:c.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,
cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:a.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:e,server_random:d}};c.handleServerHello=function(a,d,f){d=c.parseHelloMessage(a,d,f);if(!a.fail){if(!(d.version.minor<=a.version.minor))return a.error(a,{message:"Incompatible TLS version.",send:!0,alert:{level:c.Alert.Level.fatal,description:c.Alert.Description.protocol_version}});
a.version.minor=d.version.minor;a.session.version=a.version;f=d.session_id.bytes();0<f.length&&f===a.session.id?(a.expect=u,a.session.resuming=!0,a.session.sp.server_random=d.random.bytes()):(a.expect=b,a.session.resuming=!1,c.createSecurityParameters(a,d));a.session.id=f;a.process()}};c.handleClientHello=function(b,d,f){d=c.parseHelloMessage(b,d,f);if(!b.fail){var e=d.session_id.bytes();f=null;if(b.sessionCache)if(f=b.sessionCache.getSession(e),null===f)e="";else if(f.version.major!==d.version.major||
f.version.minor>d.version.minor)f=null,e="";0===e.length&&(e=a.random.getBytes(32));b.session.id=e;b.session.clientHelloVersion=d.version;b.session.sp={};if(f)b.version=b.session.version=f.version,b.session.sp=f.sp;else{for(var g,e=1;e<c.SupportedVersions.length&&!(g=c.SupportedVersions[e],g.minor<=d.version.minor);++e);b.version={major:g.major,minor:g.minor};b.session.version=b.version}null!==f?(b.expect=z,b.session.resuming=!0,b.session.sp.client_random=d.random.bytes()):(b.expect=!1!==b.verifyClient?
r:p,b.session.resuming=!1,c.createSecurityParameters(b,d));b.open=!0;c.queue(b,c.createRecord(b,{type:c.ContentType.handshake,data:c.createServerHello(b)}));b.session.resuming?(c.queue(b,c.createRecord(b,{type:c.ContentType.change_cipher_spec,data:c.createChangeCipherSpec()})),b.state.pending=c.createConnectionState(b),b.state.current.write=b.state.pending.write,c.queue(b,c.createRecord(b,{type:c.ContentType.handshake,data:c.createFinished(b)}))):(c.queue(b,c.createRecord(b,{type:c.ContentType.handshake,
data:c.createCertificate(b)})),b.fail||(c.queue(b,c.createRecord(b,{type:c.ContentType.handshake,data:c.createServerKeyExchange(b)})),!1!==b.verifyClient&&c.queue(b,c.createRecord(b,{type:c.ContentType.handshake,data:c.createCertificateRequest(b)})),c.queue(b,c.createRecord(b,{type:c.ContentType.handshake,data:c.createServerHelloDone(b)}))));c.flush(b);b.process()}};c.handleCertificate=function(b,d,f){if(3>f)return b.error(b,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:c.Alert.Level.fatal,
description:c.Alert.Description.illegal_parameter}});f=g(d.fragment,3);var e,h;d=[];try{for(;0<f.length();)e=g(f,3),h=a.asn1.fromDer(e),e=a.pki.certificateFromAsn1(h,!0),d.push(e)}catch(k){return b.error(b,{message:"Could not parse certificate list.",cause:k,send:!0,alert:{level:c.Alert.Level.fatal,description:c.Alert.Description.bad_certificate}})}e=b.entity===c.ConnectionEnd.client;!e&&!0!==b.verifyClient||0!==d.length?0===d.length?b.expect=e?n:p:(e?b.session.serverCertificate=d[0]:b.session.clientCertificate=
d[0],c.verifyCertificateChain(b,d)&&(b.expect=e?n:p)):b.error(b,{message:e?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:c.Alert.Level.fatal,description:c.Alert.Description.illegal_parameter}});b.process()};c.handleServerKeyExchange=function(a,b,d){if(0<d)return a.error(a,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:c.Alert.Level.fatal,description:c.Alert.Description.unsupported_certificate}});a.expect=f;a.process()};c.handleClientKeyExchange=
function(b,d,f){if(48>f)return b.error(b,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:c.Alert.Level.fatal,description:c.Alert.Description.unsupported_certificate}});d=g(d.fragment,2).getBytes();f=null;if(b.getPrivateKey)try{f=b.getPrivateKey(b,b.session.serverCertificate),f=a.pki.privateKeyFromPem(f)}catch(e){b.error(b,{message:"Could not get private key.",cause:e,send:!0,alert:{level:c.Alert.Level.fatal,description:c.Alert.Description.internal_error}})}if(null===
f)return b.error(b,{message:"No private key set.",send:!0,alert:{level:c.Alert.Level.fatal,description:c.Alert.Description.internal_error}});try{var h=b.session.sp;h.pre_master_secret=f.decrypt(d);var k=b.session.clientHelloVersion;if(k.major!==h.pre_master_secret.charCodeAt(0)||k.minor!==h.pre_master_secret.charCodeAt(1))throw Error("TLS version rollback attack detected.");}catch(e){h.pre_master_secret=a.random.getBytes(48)}b.expect=z;null!==b.session.clientCertificate&&(b.expect=t);b.process()};
c.handleCertificateRequest=function(a,b,d){if(3>d)return a.error(a,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:c.Alert.Level.fatal,description:c.Alert.Description.illegal_parameter}});b=b.fragment;b={certificate_types:g(b,1),certificate_authorities:g(b,2)};a.session.certificateRequest=b;a.expect=m;a.process()};c.handleCertificateVerify=function(b,d,f){if(2>f)return b.error(b,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:c.Alert.Level.fatal,
description:c.Alert.Description.illegal_parameter}});f=d.fragment;f.read-=4;d=f.bytes();f.read+=4;f=g(f,2).getBytes();var e=a.util.createBuffer();e.putBuffer(b.session.md5.digest());e.putBuffer(b.session.sha1.digest());e=e.getBytes();try{if(!b.session.clientCertificate.publicKey.verify(e,f,"NONE"))throw Error("CertificateVerify signature does not match.");b.session.md5.update(d);b.session.sha1.update(d)}catch(h){return b.error(b,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:c.Alert.Level.fatal,
description:c.Alert.Description.handshake_failure}})}b.expect=z;b.process()};c.handleServerHelloDone=function(b,d,f){if(0<f)return b.error(b,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:c.Alert.Level.fatal,description:c.Alert.Description.record_overflow}});if(null===b.serverCertificate){f={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:c.Alert.Level.fatal,description:c.Alert.Description.insufficient_security}};var e=b.verify(b,
f.alert.description,0,[]);if(!0!==e){if(e||0===e)"object"!=typeof e||a.util.isArray(e)?"number"==typeof e&&(f.alert.description=e):(e.message&&(f.message=e.message),e.alert&&(f.alert.description=e.alert));return b.error(b,f)}}null!==b.session.certificateRequest&&(d=c.createRecord(b,{type:c.ContentType.handshake,data:c.createCertificate(b)}),c.queue(b,d));d=c.createRecord(b,{type:c.ContentType.handshake,data:c.createClientKeyExchange(b)});c.queue(b,d);b.expect=J;d=function(a,b){null!==a.session.certificateRequest&&
null!==a.session.clientCertificate&&c.queue(a,c.createRecord(a,{type:c.ContentType.handshake,data:c.createCertificateVerify(a,b)}));c.queue(a,c.createRecord(a,{type:c.ContentType.change_cipher_spec,data:c.createChangeCipherSpec()}));a.state.pending=c.createConnectionState(a);a.state.current.write=a.state.pending.write;c.queue(a,c.createRecord(a,{type:c.ContentType.handshake,data:c.createFinished(a)}));a.expect=u;c.flush(a);a.process()};if(null===b.session.certificateRequest||null===b.session.clientCertificate)return d(b,
null);c.getClientSignature(b,d)};c.handleChangeCipherSpec=function(a,b){if(1!==b.fragment.getByte())return a.error(a,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:c.Alert.Level.fatal,description:c.Alert.Description.illegal_parameter}});var d=a.entity===c.ConnectionEnd.client;if(a.session.resuming&&d||!a.session.resuming&&!d)a.state.pending=c.createConnectionState(a);a.state.current.read=a.state.pending.read;if(!a.session.resuming&&d||a.session.resuming&&!d)a.state.pending=
null;a.expect=d?q:y;a.process()};c.handleFinished=function(b,d,f){f=d.fragment;f.read-=4;var g=f.bytes();f.read+=4;d=d.fragment.getBytes();f=a.util.createBuffer();f.putBuffer(b.session.md5.digest());f.putBuffer(b.session.sha1.digest());var h=b.entity===c.ConnectionEnd.client;f=e(b.session.sp.master_secret,h?"server finished":"client finished",f.getBytes(),12);if(f.getBytes()!==d)return b.error(b,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:c.Alert.Level.fatal,description:c.Alert.Description.decrypt_error}});
b.session.md5.update(g);b.session.sha1.update(g);if(b.session.resuming&&h||!b.session.resuming&&!h)c.queue(b,c.createRecord(b,{type:c.ContentType.change_cipher_spec,data:c.createChangeCipherSpec()})),b.state.current.write=b.state.pending.write,b.state.pending=null,c.queue(b,c.createRecord(b,{type:c.ContentType.handshake,data:c.createFinished(b)}));b.expect=h?v:x;b.handshaking=!1;++b.handshakes;b.peerCertificate=h?b.session.serverCertificate:b.session.clientCertificate;c.flush(b);b.isConnected=!0;
b.connected(b);b.process()};c.handleAlert=function(a,b){var d=b.fragment,d={level:d.getByte(),description:d.getByte()},f;switch(d.description){case c.Alert.Description.close_notify:f="Connection closed.";break;case c.Alert.Description.unexpected_message:f="Unexpected message.";break;case c.Alert.Description.bad_record_mac:f="Bad record MAC.";break;case c.Alert.Description.decryption_failed:f="Decryption failed.";break;case c.Alert.Description.record_overflow:f="Record overflow.";break;case c.Alert.Description.decompression_failure:f=
"Decompression failed.";break;case c.Alert.Description.handshake_failure:f="Handshake failure.";break;case c.Alert.Description.bad_certificate:f="Bad certificate.";break;case c.Alert.Description.unsupported_certificate:f="Unsupported certificate.";break;case c.Alert.Description.certificate_revoked:f="Certificate revoked.";break;case c.Alert.Description.certificate_expired:f="Certificate expired.";break;case c.Alert.Description.certificate_unknown:f="Certificate unknown.";break;case c.Alert.Description.illegal_parameter:f=
"Illegal parameter.";break;case c.Alert.Description.unknown_ca:f="Unknown certificate authority.";break;case c.Alert.Description.access_denied:f="Access denied.";break;case c.Alert.Description.decode_error:f="Decode error.";break;case c.Alert.Description.decrypt_error:f="Decrypt error.";break;case c.Alert.Description.export_restriction:f="Export restriction.";break;case c.Alert.Description.protocol_version:f="Unsupported protocol version.";break;case c.Alert.Description.insufficient_security:f="Insufficient security.";
break;case c.Alert.Description.internal_error:f="Internal error.";break;case c.Alert.Description.user_canceled:f="User canceled.";break;case c.Alert.Description.no_renegotiation:f="Renegotiation not supported.";break;default:f="Unknown error."}if(d.description===c.Alert.Description.close_notify)return a.close();a.error(a,{message:f,send:!1,origin:a.entity===c.ConnectionEnd.client?"server":"client",alert:d});a.process()};c.handleHandshake=function(b,d){var f=d.fragment,e=f.getByte(),g=f.getInt24();
if(g>f.length())return b.fragmented=d,d.fragment=a.util.createBuffer(),f.read-=4,b.process();b.fragmented=null;f.read-=4;var h=f.bytes(g+4);f.read+=4;e in M[b.entity][b.expect]?(b.entity===c.ConnectionEnd.server&&!b.open&&!b.fail&&(b.handshaking=!0,b.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:a.md.md5.create(),sha1:a.md.sha1.create()}),e!==c.HandshakeType.hello_request&&e!==c.HandshakeType.certificate_verify&&
e!==c.HandshakeType.finished&&(b.session.md5.update(h),b.session.sha1.update(h)),M[b.entity][b.expect][e](b,d,g)):c.handleUnexpected(b,d)};c.handleApplicationData=function(a,b){a.data.putBuffer(b.fragment);a.dataReady(a);a.process()};c.handleHeartbeat=function(b,d){var f=d.fragment,e=f.getByte(),g=f.getInt16(),f=f.getBytes(g);if(e===c.HeartbeatMessageType.heartbeat_request){if(b.handshaking||g>f.length)return b.process();c.queue(b,c.createRecord(b,{type:c.ContentType.heartbeat,data:c.createHeartbeat(c.HeartbeatMessageType.heartbeat_response,
f)}));c.flush(b)}else if(e===c.HeartbeatMessageType.heartbeat_response){if(f!==b.expectedHeartbeatPayload)return b.process();b.heartbeatReceived&&b.heartbeatReceived(b,a.util.createBuffer(f))}b.process()};var b=1,n=2,f=3,m=4,u=5,q=6,v=7,J=8,r=1,p=2,t=3,z=4,y=5,x=6,l=c.handleUnexpected,E=c.handleChangeCipherSpec,C=c.handleAlert,B=c.handleHandshake,F=c.handleApplicationData,D=c.handleHeartbeat,G=[];G[c.ConnectionEnd.client]=[[l,C,B,l,D],[l,C,B,l,D],[l,C,B,l,D],[l,C,B,l,D],[l,C,B,l,D],[E,C,l,l,D],[l,
C,B,l,D],[l,C,B,F,D],[l,C,B,l,D]];G[c.ConnectionEnd.server]=[[l,C,B,l,D],[l,C,B,l,D],[l,C,B,l,D],[l,C,B,l,D],[E,C,l,l,D],[l,C,B,l,D],[l,C,B,F,D],[l,C,B,l,D]];var E=c.handleHelloRequest,C=c.handleCertificate,B=c.handleServerKeyExchange,F=c.handleCertificateRequest,D=c.handleServerHelloDone,I=c.handleFinished,M=[];M[c.ConnectionEnd.client]=[[l,l,c.handleServerHello,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l],[E,l,l,l,l,l,l,l,l,l,l,C,B,F,D,l,l,l,l,l,l],[E,l,l,l,l,l,l,l,l,l,l,l,B,F,D,l,l,l,l,l,l],[E,l,l,l,l,
l,l,l,l,l,l,l,l,F,D,l,l,l,l,l,l],[E,l,l,l,l,l,l,l,l,l,l,l,l,l,D,l,l,l,l,l,l],[E,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l],[E,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,I],[E,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l],[E,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l]];M[c.ConnectionEnd.server]=[[l,c.handleClientHello,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l],[l,l,l,l,l,l,l,l,l,l,l,C,l,l,l,l,l,l,l,l,l],[l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,c.handleClientKeyExchange,l,l,l,l],[l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,c.handleCertificateVerify,
l,l,l,l,l],[l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l],[l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,I],[l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l],[l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l]];c.generateKeys=function(a,b){var d=b.client_random+b.server_random;a.session.resuming||(b.master_secret=e(b.pre_master_secret,"master secret",d,48).bytes(),b.pre_master_secret=null);var d=b.server_random+b.client_random,f=2*b.mac_key_length+2*b.enc_key_length,g=a.version.major===c.Versions.TLS_1_0.major&&a.version.minor===
c.Versions.TLS_1_0.minor;g&&(f+=2*b.fixed_iv_length);d=e(b.master_secret,"key expansion",d,f);f={client_write_MAC_key:d.getBytes(b.mac_key_length),server_write_MAC_key:d.getBytes(b.mac_key_length),client_write_key:d.getBytes(b.enc_key_length),server_write_key:d.getBytes(b.enc_key_length)};return g&&(f.client_write_IV=d.getBytes(b.fixed_iv_length),f.server_write_IV=d.getBytes(b.fixed_iv_length)),f};c.createConnectionState=function(a){var b=a.entity===c.ConnectionEnd.client,f=function(){var a={sequenceNumber:[0,
0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(a){return!0},compressionState:null,compressFunction:function(a){return!0},updateSequenceNumber:function(){4294967295===a.sequenceNumber[1]?(a.sequenceNumber[1]=0,++a.sequenceNumber[0]):++a.sequenceNumber[1]}};return a},e={read:f(),write:f()};e.read.update=function(a,b){return e.read.cipherFunction(b,e.read)?e.read.compressFunction(a,b,e.read)||a.error(a,{message:"Could not decompress record.",send:!0,alert:{level:c.Alert.Level.fatal,
description:c.Alert.Description.decompression_failure}}):a.error(a,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:c.Alert.Level.fatal,description:c.Alert.Description.bad_record_mac}}),!a.fail};e.write.update=function(a,b){return e.write.compressFunction(a,b,e.write)?e.write.cipherFunction(b,e.write)||a.error(a,{message:"Could not encrypt record.",send:!1,alert:{level:c.Alert.Level.fatal,description:c.Alert.Description.internal_error}}):a.error(a,{message:"Could not compress record.",
send:!1,alert:{level:c.Alert.Level.fatal,description:c.Alert.Description.internal_error}}),!a.fail};if(a.session)switch(f=a.session.sp,a.session.cipherSuite.initSecurityParameters(f),f.keys=c.generateKeys(a,f),e.read.macKey=b?f.keys.server_write_MAC_key:f.keys.client_write_MAC_key,e.write.macKey=b?f.keys.client_write_MAC_key:f.keys.server_write_MAC_key,a.session.cipherSuite.initConnectionState(e,a,f),f.compression_algorithm){case c.CompressionMethod.none:break;case c.CompressionMethod.deflate:e.read.compressFunction=
k;e.write.compressFunction=d;break;default:throw Error("Unsupported compression algorithm.");}return e};c.createRandom=function(){var b=new Date,b=+b+6E4*b.getTimezoneOffset(),c=a.util.createBuffer();return c.putInt32(b),c.putBytes(a.random.getBytes(28)),c};c.createRecord=function(a,b){return b.data?{type:b.type,version:{major:a.version.major,minor:a.version.minor},length:b.data.length(),fragment:b.data}:null};c.createAlert=function(b,d){var f=a.util.createBuffer();return f.putByte(d.level),f.putByte(d.description),
c.createRecord(b,{type:c.ContentType.alert,data:f})};c.createClientHello=function(b){b.session.clientHelloVersion={major:b.version.major,minor:b.version.minor};for(var d=a.util.createBuffer(),f=0;f<b.cipherSuites.length;++f){var e=b.cipherSuites[f];d.putByte(e.id[0]);d.putByte(e.id[1])}var g=d.length(),f=a.util.createBuffer();f.putByte(c.CompressionMethod.none);var k=f.length(),e=a.util.createBuffer();if(b.virtualHost){var l=a.util.createBuffer();l.putByte(0);l.putByte(0);var n=a.util.createBuffer();
n.putByte(0);h(n,2,a.util.createBuffer(b.virtualHost));var m=a.util.createBuffer();h(m,2,n);h(l,2,m);e.putBuffer(l)}l=e.length();0<l&&(l+=2);n=b.session.id;g=n.length+1+2+4+28+2+g+1+k+l;k=a.util.createBuffer();return k.putByte(c.HandshakeType.client_hello),k.putInt24(g),k.putByte(b.version.major),k.putByte(b.version.minor),k.putBytes(b.session.sp.client_random),h(k,1,a.util.createBuffer(n)),h(k,2,d),h(k,1,f),0<l&&h(k,2,e),k};c.createServerHello=function(b){var d=b.session.id,f=d.length+1+2+4+28+2+
1,e=a.util.createBuffer();return e.putByte(c.HandshakeType.server_hello),e.putInt24(f),e.putByte(b.version.major),e.putByte(b.version.minor),e.putBytes(b.session.sp.server_random),h(e,1,a.util.createBuffer(d)),e.putByte(b.session.cipherSuite.id[0]),e.putByte(b.session.cipherSuite.id[1]),e.putByte(b.session.compressionMethod),e};c.createCertificate=function(b){var d=b.entity===c.ConnectionEnd.client,f=null;if(b.getCertificate){var e;d?e=b.session.certificateRequest:e=b.session.extensions.server_name.serverNameList;
f=b.getCertificate(b,e)}e=a.util.createBuffer();if(null!==f)try{a.util.isArray(f)||(f=[f]);for(var g=null,k=0;k<f.length;++k){var l=a.pem.decode(f[k])[0];if("CERTIFICATE"!==l.type&&"X509 CERTIFICATE"!==l.type&&"TRUSTED CERTIFICATE"!==l.type){var n=Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw n.headerType=l.type,n;}if(l.procType&&"ENCRYPTED"===l.procType.type)throw Error("Could not convert certificate from PEM; PEM is encrypted.");
var m=a.util.createBuffer(l.body);null===g&&(g=a.asn1.fromDer(m.bytes(),!1));var q=a.util.createBuffer();h(q,3,m);e.putBuffer(q)}f=a.pki.certificateFromAsn1(g);d?b.session.clientCertificate=f:b.session.serverCertificate=f}catch(u){return b.error(b,{message:"Could not send certificate list.",cause:u,send:!0,alert:{level:c.Alert.Level.fatal,description:c.Alert.Description.bad_certificate}})}b=3+e.length();d=a.util.createBuffer();return d.putByte(c.HandshakeType.certificate),d.putInt24(b),h(d,3,e),d};
c.createClientKeyExchange=function(b){var d=a.util.createBuffer();d.putByte(b.session.clientHelloVersion.major);d.putByte(b.session.clientHelloVersion.minor);d.putBytes(a.random.getBytes(46));var f=b.session.sp;f.pre_master_secret=d.getBytes();d=b.session.serverCertificate.publicKey.encrypt(f.pre_master_secret);b=d.length+2;f=a.util.createBuffer();return f.putByte(c.HandshakeType.client_key_exchange),f.putInt24(b),f.putInt16(d.length),f.putBytes(d),f};c.createServerKeyExchange=function(b){return a.util.createBuffer()};
c.getClientSignature=function(b,d){var f=a.util.createBuffer();f.putBuffer(b.session.md5.digest());f.putBuffer(b.session.sha1.digest());f=f.getBytes();b.getSignature=b.getSignature||function(b,d,f){var e=null;if(b.getPrivateKey)try{e=b.getPrivateKey(b,b.session.clientCertificate),e=a.pki.privateKeyFromPem(e)}catch(g){b.error(b,{message:"Could not get private key.",cause:g,send:!0,alert:{level:c.Alert.Level.fatal,description:c.Alert.Description.internal_error}})}null===e?b.error(b,{message:"No private key set.",
send:!0,alert:{level:c.Alert.Level.fatal,description:c.Alert.Description.internal_error}}):d=e.sign(d,null);f(b,d)};b.getSignature(b,f,d)};c.createCertificateVerify=function(b,d){var f=d.length+2,e=a.util.createBuffer();return e.putByte(c.HandshakeType.certificate_verify),e.putInt24(f),e.putInt16(d.length),e.putBytes(d),e};c.createCertificateRequest=function(b){var d=a.util.createBuffer();d.putByte(1);var f=a.util.createBuffer(),e;for(e in b.caStore.certs){var g=a.pki.distinguishedNameToAsn1(b.caStore.certs[e].subject);
f.putBuffer(a.asn1.toDer(g))}b=1+d.length()+2+f.length();e=a.util.createBuffer();return e.putByte(c.HandshakeType.certificate_request),e.putInt24(b),h(e,1,d),h(e,2,f),e};c.createServerHelloDone=function(b){b=a.util.createBuffer();return b.putByte(c.HandshakeType.server_hello_done),b.putInt24(0),b};c.createChangeCipherSpec=function(){var b=a.util.createBuffer();return b.putByte(1),b};c.createFinished=function(b){var d=a.util.createBuffer();d.putBuffer(b.session.md5.digest());d.putBuffer(b.session.sha1.digest());
d=e(b.session.sp.master_secret,b.entity===c.ConnectionEnd.client?"client finished":"server finished",d.getBytes(),12);b=a.util.createBuffer();return b.putByte(c.HandshakeType.finished),b.putInt24(d.length()),b.putBuffer(d),b};c.createHeartbeat=function(b,c,d){"undefined"==typeof d&&(d=c.length);var f=a.util.createBuffer();f.putByte(b);f.putInt16(d);f.putBytes(c);b=f.length();return f.putBytes(a.random.getBytes(Math.max(16,b-d-3))),f};c.queue=function(b,d){if(d){if(d.type===c.ContentType.handshake){var f=
d.fragment.bytes();b.session.md5.update(f);b.session.sha1.update(f)}if(d.fragment.length()<=c.MaxFragment)f=[d];else{for(var f=[],e=d.fragment.bytes();e.length>c.MaxFragment;)f.push(c.createRecord(b,{type:d.type,data:a.util.createBuffer(e.slice(0,c.MaxFragment))})),e=e.slice(c.MaxFragment);0<e.length&&f.push(c.createRecord(b,{type:d.type,data:a.util.createBuffer(e)}))}for(e=0;e<f.length&&!b.fail;++e){var g=f[e];b.state.current.write.update(b,g)&&b.records.push(g)}}};c.flush=function(a){for(var b=
0;b<a.records.length;++b){var c=a.records[b];a.tlsData.putByte(c.type);a.tlsData.putByte(c.version.major);a.tlsData.putByte(c.version.minor);a.tlsData.putInt16(c.fragment.length());a.tlsData.putBuffer(a.records[b].fragment)}return a.records=[],a.tlsDataReady(a)};var Q=function(b){switch(b){case !0:return!0;case a.pki.certificateError.bad_certificate:return c.Alert.Description.bad_certificate;case a.pki.certificateError.unsupported_certificate:return c.Alert.Description.unsupported_certificate;case a.pki.certificateError.certificate_revoked:return c.Alert.Description.certificate_revoked;
case a.pki.certificateError.certificate_expired:return c.Alert.Description.certificate_expired;case a.pki.certificateError.certificate_unknown:return c.Alert.Description.certificate_unknown;case a.pki.certificateError.unknown_ca:return c.Alert.Description.unknown_ca;default:return c.Alert.Description.bad_certificate}},S=function(b){switch(b){case !0:return!0;case c.Alert.Description.bad_certificate:return a.pki.certificateError.bad_certificate;case c.Alert.Description.unsupported_certificate:return a.pki.certificateError.unsupported_certificate;
case c.Alert.Description.certificate_revoked:return a.pki.certificateError.certificate_revoked;case c.Alert.Description.certificate_expired:return a.pki.certificateError.certificate_expired;case c.Alert.Description.certificate_unknown:return a.pki.certificateError.certificate_unknown;case c.Alert.Description.unknown_ca:return a.pki.certificateError.unknown_ca;default:return a.pki.certificateError.bad_certificate}};c.verifyCertificateChain=function(b,d){try{a.pki.verifyCertificateChain(b.caStore,d,
function(d,f,e){Q(d);f=b.verify(b,d,f,e);if(!0!==f){if("object"==typeof f&&!a.util.isArray(f))throw d=Error("The application rejected the certificate."),d.send=!0,d.alert={level:c.Alert.Level.fatal,description:c.Alert.Description.bad_certificate},f.message&&(d.message=f.message),f.alert&&(d.alert.description=f.alert),d;f!==d&&(f=S(f))}return f})}catch(f){var e=f;if("object"!=typeof e||a.util.isArray(e))e={send:!0,alert:{level:c.Alert.Level.fatal,description:Q(f)}};"send"in e||(e.send=!0);"alert"in
e||(e.alert={level:c.Alert.Level.fatal,description:Q(e.error)});b.error(b,e)}return!b.fail};c.createSessionCache=function(b,c){var d=null;if(b&&b.getSession&&b.setSession&&b.order)d=b;else{d={};d.cache=b||{};d.capacity=Math.max(c||100,1);d.order=[];for(var f in b)d.order.length<=c?d.order.push(f):delete b[f];d.getSession=function(b){var c=null,f=null;b?f=a.util.bytesToHex(b):0<d.order.length&&(f=d.order[0]);if(null!==f&&f in d.cache){c=d.cache[f];delete d.cache[f];for(var e in d.order)if(d.order[e]===
f){d.order.splice(e,1);break}}return c};d.setSession=function(b,c){if(d.order.length===d.capacity){var f=d.order.shift();delete d.cache[f]}f=a.util.bytesToHex(b);d.order.push(f);d.cache[f]=c}}return d};c.createConnection=function(b){var d=null;b.caStore?a.util.isArray(b.caStore)?d=a.pki.createCaStore(b.caStore):d=b.caStore:d=a.pki.createCaStore();var f=b.cipherSuites||null;if(null===f){var f=[],e;for(e in c.CipherSuites)f.push(c.CipherSuites[e])}e=b.server?c.ConnectionEnd.server:c.ConnectionEnd.client;
var g=b.sessionCache?c.createSessionCache(b.sessionCache):null,h={version:{major:c.Version.major,minor:c.Version.minor},entity:e,sessionId:b.sessionId,caStore:d,sessionCache:g,cipherSuites:f,connected:b.connected,virtualHost:b.virtualHost||null,verifyClient:b.verifyClient||!1,verify:b.verify||function(a,b,c,d){return b},getCertificate:b.getCertificate||null,getPrivateKey:b.getPrivateKey||null,getSignature:b.getSignature||null,input:a.util.createBuffer(),tlsData:a.util.createBuffer(),data:a.util.createBuffer(),
tlsDataReady:b.tlsDataReady,dataReady:b.dataReady,heartbeatReceived:b.heartbeatReceived,closed:b.closed,error:function(a,d){d.origin=d.origin||(a.entity===c.ConnectionEnd.client?"client":"server");d.send&&(c.queue(a,c.createAlert(a,d.alert)),c.flush(a));var f=!1!==d.fatal;f&&(a.fail=!0);b.error(a,d);f&&a.close(!1)},deflate:b.deflate||null,inflate:b.inflate||null,reset:function(a){h.version={major:c.Version.major,minor:c.Version.minor};h.record=null;h.session=null;h.peerCertificate=null;h.state={pending:null,
current:null};h.expect=0;h.fragmented=null;h.records=[];h.open=!1;h.handshakes=0;h.handshaking=!1;h.isConnected=!1;h.fail=!a&&"undefined"!=typeof a;h.input.clear();h.tlsData.clear();h.data.clear();h.state.current=c.createConnectionState(h)}};h.reset();return h.handshake=function(b){if(h.entity!==c.ConnectionEnd.client)h.error(h,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(h.handshaking)h.error(h,{message:"Handshake already in progress.",fatal:!1});else{h.fail&&!h.open&&0===
h.handshakes&&(h.fail=!1);h.handshaking=!0;b=b||"";var d=null;0<b.length&&(h.sessionCache&&(d=h.sessionCache.getSession(b)),null===d&&(b=""));0===b.length&&h.sessionCache&&(d=h.sessionCache.getSession(),null!==d&&(b=d.id));h.session={id:b,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:a.md.md5.create(),sha1:a.md.sha1.create()};d&&(h.version=d.version,h.session.sp=d.sp);h.session.sp.client_random=c.createRandom().getBytes();
h.open=!0;c.queue(h,c.createRecord(h,{type:c.ContentType.handshake,data:c.createClientHello(h)}));c.flush(h)}},h.process=function(b){var d=0;b&&h.input.putBytes(b);if(!h.fail){null!==h.record&&h.record.ready&&h.record.fragment.isEmpty()&&(h.record=null);if(null===h.record){d=0;b=h.input;var f=b.length();5>f?d=5-f:(h.record={type:b.getByte(),version:{major:b.getByte(),minor:b.getByte()},length:b.getInt16(),fragment:a.util.createBuffer(),ready:!1},(b=h.record.version.major===h.version.major)&&h.session&&
h.session.version&&(b=h.record.version.minor===h.version.minor),b||h.error(h,{message:"Incompatible TLS version.",send:!0,alert:{level:c.Alert.Level.fatal,description:c.Alert.Description.protocol_version}}))}if(!h.fail&&null!==h.record&&!h.record.ready){d=h;b=0;var f=d.input,e=f.length();e<d.record.length?b=d.record.length-e:(d.record.fragment.putBytes(f.getBytes(d.record.length)),f.compact(),d.state.current.read.update(d,d.record)&&(null!==d.fragmented&&(d.fragmented.type===d.record.type?(d.fragmented.fragment.putBuffer(d.record.fragment),
d.record=d.fragmented):d.error(d,{message:"Invalid fragmented record.",send:!0,alert:{level:c.Alert.Level.fatal,description:c.Alert.Description.unexpected_message}})),d.record.ready=!0));d=b}!h.fail&&null!==h.record&&h.record.ready&&(b=h.record,f=b.type-c.ContentType.change_cipher_spec,e=G[h.entity][h.expect],f in e?e[f](h,b):c.handleUnexpected(h,b))}return d},h.prepare=function(b){return c.queue(h,c.createRecord(h,{type:c.ContentType.application_data,data:a.util.createBuffer(b)})),c.flush(h)},h.prepareHeartbeatRequest=
function(b,d){return b instanceof a.util.ByteBuffer&&(b=b.bytes()),"undefined"==typeof d&&(d=b.length),h.expectedHeartbeatPayload=b,c.queue(h,c.createRecord(h,{type:c.ContentType.heartbeat,data:c.createHeartbeat(c.HeartbeatMessageType.heartbeat_request,b,d)})),c.flush(h)},h.close=function(a){if(!h.fail&&h.sessionCache&&h.session){var b={id:h.session.id,version:h.session.version,sp:h.session.sp};b.sp.keys=null;h.sessionCache.setSession(b.id,b)}if(h.open){h.open=!1;h.input.clear();if(h.isConnected||
h.handshaking)h.isConnected=h.handshaking=!1,c.queue(h,c.createAlert(h,{level:c.Alert.Level.warning,description:c.Alert.Description.close_notify})),c.flush(h);h.closed(h)}h.reset(a)},h};a.tls=a.tls||{};for(var X in c)"function"!=typeof c[X]&&(a.tls[X]=c[X]);a.tls.prf_tls1=e;a.tls.hmac_sha1=function(b,c,d){var f=a.hmac.create();f.start("SHA1",b);b=a.util.createBuffer();return b.putInt32(c[0]),b.putInt32(c[1]),b.putByte(d.type),b.putByte(d.version.major),b.putByte(d.version.minor),b.putInt16(d.length),
b.putBytes(d.fragment.bytes()),f.update(b.getBytes()),f.digest().getBytes()};a.tls.createSessionCache=c.createSessionCache;a.tls.createConnection=c.createConnection}if("function"!=typeof m){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),x(forge);var F=!0;m=function(a,e){e(G,module)}}var y,C=function(a,e){e.exports=function(d){var e=y.map(function(d){return a(d)}).concat(x);d=d||{};d.defined=d.defined||{};if(d.defined.tls)return d.tls;d.defined.tls=!0;for(var g=
0;g<e.length;++g)e[g](d);return d.tls}},t=m;m=function(a,e){return y="string"==typeof a?e.slice(2):a.slice(2),F?(delete m,t.apply(null,Array.prototype.slice.call(arguments,0))):(m=t,m.apply(null,Array.prototype.slice.call(arguments,0)))};m("js/tls","require module ./asn1 ./hmac ./md ./pem ./pki ./random ./util".split(" "),function(){C.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function x(a){function e(b,f,e){f=f.entity===a.tls.ConnectionEnd.client;b.read.cipherState={init:!1,
cipher:a.cipher.createDecipher("AES-CBC",f?e.keys.server_write_key:e.keys.client_write_key),iv:f?e.keys.server_write_IV:e.keys.client_write_IV};b.write.cipherState={init:!1,cipher:a.cipher.createCipher("AES-CBC",f?e.keys.client_write_key:e.keys.server_write_key),iv:f?e.keys.client_write_IV:e.keys.server_write_IV};b.read.cipherFunction=h;b.write.cipherFunction=d;b.read.macLength=b.write.macLength=e.mac_length;b.read.macFunction=b.write.macFunction=c.hmac_sha1}function d(b,d){var e=!1,g=d.macFunction(d.macKey,
d.sequenceNumber,b);b.fragment.putBytes(g);d.updateSequenceNumber();var h;b.version.minor===c.Versions.TLS_1_0.minor?h=d.cipherState.init?null:d.cipherState.iv:h=a.random.getBytesSync(16);d.cipherState.init=!0;g=d.cipherState.cipher;return g.start({iv:h}),b.version.minor>=c.Versions.TLS_1_1.minor&&g.output.putBytes(h),g.update(b.fragment),g.finish(k)&&(b.fragment=g.output,b.length=b.fragment.length(),e=!0),e}function k(a,b,c){c||(a-=b.length()%a,b.fillWithByte(a-1,a));return!0}function g(a,b,c){a=
!0;if(c){c=b.length();for(var d=b.last(),e=c-1-d;e<c-1;++e)a=a&&b.at(e)==d;a&&b.truncate(d+1)}return a}function h(d,f){var e;++b;d.version.minor===c.Versions.TLS_1_0.minor?e=f.cipherState.init?null:f.cipherState.iv:e=d.fragment.getBytes(16);f.cipherState.init=!0;var h=f.cipherState.cipher;h.start({iv:e});h.update(d.fragment);e=h.finish(g);var k=f.macLength,m=a.random.getBytesSync(k),J=h.output.length();J>=k?(d.fragment=h.output.getBytes(J-k),m=h.output.getBytes(k)):d.fragment=h.output.getBytes();
d.fragment=a.util.createBuffer(d.fragment);d.length=d.fragment.length();k=f.macFunction(f.macKey,f.sequenceNumber,d);f.updateSequenceNumber();h=f.macKey;J=a.hmac.create();return e=(J.start("SHA1",h),J.update(m),m=J.digest().getBytes(),J.start(null,null),J.update(k),k=J.digest().getBytes(),m===k)&&e,e}var c=a.tls;c.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(a){a.bulk_cipher_algorithm=c.BulkCipherAlgorithm.aes;a.cipher_type=
c.CipherType.block;a.enc_key_length=16;a.block_length=16;a.fixed_iv_length=16;a.record_iv_length=16;a.mac_algorithm=c.MACAlgorithm.hmac_sha1;a.mac_length=20;a.mac_key_length=20},initConnectionState:e};c.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(a){a.bulk_cipher_algorithm=c.BulkCipherAlgorithm.aes;a.cipher_type=c.CipherType.block;a.enc_key_length=32;a.block_length=16;a.fixed_iv_length=16;a.record_iv_length=16;a.mac_algorithm=
c.MACAlgorithm.hmac_sha1;a.mac_length=20;a.mac_key_length=20},initConnectionState:e};var b=0}if("function"!=typeof m){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),x(forge);var F=!0;m=function(a,e){e(G,module)}}var y,C=function(a,e){e.exports=function(d){var e=y.map(function(d){return a(d)}).concat(x);d=d||{};d.defined=d.defined||{};if(d.defined.aesCipherSuites)return d.aesCipherSuites;d.defined.aesCipherSuites=!0;for(var g=0;g<e.length;++g)e[g](d);return d.aesCipherSuites}},
t=m;m=function(a,e){return y="string"==typeof a?e.slice(2):a.slice(2),F?(delete m,t.apply(null,Array.prototype.slice.call(arguments,0))):(m=t,m.apply(null,Array.prototype.slice.call(arguments,0)))};m("js/aesCipherSuites",["require","module","./aes","./tls"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function x(a){a.debug=a.debug||{};a.debug.storage={};a.debug.get=function(e,d){var k;return"undefined"==typeof e?k=a.debug.storage:e in a.debug.storage&&("undefined"==
typeof d?k=a.debug.storage[e]:k=a.debug.storage[e][d]),k};a.debug.set=function(e,d,k){e in a.debug.storage||(a.debug.storage[e]={});a.debug.storage[e][d]=k};a.debug.clear=function(e,d){"undefined"==typeof e?a.debug.storage={}:e in a.debug.storage&&("undefined"==typeof d?delete a.debug.storage[e]:delete a.debug.storage[e][d])}}if("function"!=typeof m){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),x(forge);var F=!0;m=function(a,e){e(G,module)}}var y,C=function(a,
e){e.exports=function(d){var e=y.map(function(d){return a(d)}).concat(x);d=d||{};d.defined=d.defined||{};if(d.defined.debug)return d.debug;d.defined.debug=!0;for(var g=0;g<e.length;++g)e[g](d);return d.debug}},t=m;m=function(a,e){return y="string"==typeof a?e.slice(2):a.slice(2),F?(delete m,t.apply(null,Array.prototype.slice.call(arguments,0))):(m=t,m.apply(null,Array.prototype.slice.call(arguments,0)))};m("js/debug",["require","module"],function(){C.apply(null,Array.prototype.slice.call(arguments,
0))})}(),function(){function x(a){function e(d,e,h,c){d.generate=function(b,d){for(var f=new a.util.ByteBuffer,k=Math.ceil(d/c)+h,m=new a.util.ByteBuffer,q=h;q<k;++q){m.putInt32(q);e.start();e.update(b+m.getBytes());var v=e.digest();f.putBytes(v.getBytes(c))}return f.truncate(f.length()-d),f.getBytes()}}a.kem=a.kem||{};var d=a.jsbn.BigInteger;a.kem.rsa={};a.kem.rsa.create=function(e,g){g=g||{};var h=g.prng||a.random,c={};return c.encrypt=function(b,c){var f=Math.ceil(b.n.bitLength()/8),g;do g=(new d(a.util.bytesToHex(h.getBytesSync(f)),
16)).mod(b.n);while(g.equals(d.ZERO));g=a.util.hexToBytes(g.toString(16));f-=g.length;0<f&&(g=a.util.fillString(String.fromCharCode(0),f)+g);f=b.encrypt(g,"NONE");g=e.generate(g,c);return{encapsulation:f,key:g}},c.decrypt=function(a,c,d){a=a.decrypt(c,"NONE");return e.generate(a,d)},c};a.kem.kdf1=function(a,d){e(this,a,0,d||a.digestLength)};a.kem.kdf2=function(a,d){e(this,a,1,d||a.digestLength)}}if("function"!=typeof m){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&
(forge={}),x(forge);var F=!0;m=function(a,e){e(G,module)}}var y,C=function(a,e){e.exports=function(d){var e=y.map(function(d){return a(d)}).concat(x);d=d||{};d.defined=d.defined||{};if(d.defined.kem)return d.kem;d.defined.kem=!0;for(var g=0;g<e.length;++g)e[g](d);return d.kem}},t=m;m=function(a,e){return y="string"==typeof a?e.slice(2):a.slice(2),F?(delete m,t.apply(null,Array.prototype.slice.call(arguments,0))):(m=t,m.apply(null,Array.prototype.slice.call(arguments,0)))};m("js/kem",["require","module",
"./util","./random","./jsbn"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function x(a){a.log=a.log||{};a.log.levels="none error warning info debug verbose max".split(" ");var e={},d=[],k=null;a.log.LEVEL_LOCKED=2;a.log.NO_LEVEL_CHECK=4;a.log.INTERPOLATE=8;for(var g=0;g<a.log.levels.length;++g){var h=a.log.levels[g];e[h]={index:g,name:h.toUpperCase()}}a.log.logMessage=function(b){for(var c=e[b.level].index,f=0;f<d.length;++f){var g=d[f];g.flags&a.log.NO_LEVEL_CHECK?
g.f(b):c<=e[g.level].index&&g.f(g,b)}};a.log.prepareStandard=function(a){"standard"in a||(a.standard=e[a.level].name+" ["+a.category+"] "+a.message)};a.log.prepareFull=function(b){if(!("full"in b)){var c=[b.message],c=c.concat([]);b.full=a.util.format.apply(this,c)}};a.log.prepareStandardFull=function(b){"standardFull"in b||(a.log.prepareStandard(b),b.standardFull=b.standard)};h=["error","warning","info","debug","verbose"];for(g=0;g<h.length;++g)(function(b){a.log[b]=function(c,d){var e=Array.prototype.slice.call(arguments).slice(2);
a.log.logMessage({timestamp:new Date,level:b,category:c,message:d,arguments:e})}})(h[g]);a.log.makeLogger=function(b){b={flags:0,f:b};return a.log.setLevel(b,"none"),b};a.log.setLevel=function(b,c){var d=!1;if(b&&!(b.flags&a.log.LEVEL_LOCKED))for(var e=0;e<a.log.levels.length;++e)if(c==a.log.levels[e]){b.level=c;d=!0;break}return d};a.log.lock=function(b,c){"undefined"==typeof c||c?b.flags|=a.log.LEVEL_LOCKED:b.flags&=~a.log.LEVEL_LOCKED};a.log.addLogger=function(a){d.push(a)};if("undefined"!=typeof console&&
"log"in console){if(console.error&&console.warn&&console.info&&console.debug)var c={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},k=function(b,d){a.log.prepareStandard(d);var f=c[d.level],e=[d.standard],e=e.concat(d.arguments.slice());f.apply(console,e)};else k=function(b,c){a.log.prepareStandardFull(c);console.log(c.standardFull)};k=a.log.makeLogger(k);a.log.setLevel(k,"debug");a.log.addLogger(k)}else console={log:function(){}};null!==k&&(g=
a.util.getQueryVariables(),"console.level"in g&&a.log.setLevel(k,g["console.level"].slice(-1)[0]),"console.lock"in g&&"true"==g["console.lock"].slice(-1)[0]&&a.log.lock(k));a.log.consoleLogger=k}if("function"!=typeof m){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),x(forge);var F=!0;m=function(a,e){e(G,module)}}var y,C=function(a,e){e.exports=function(d){var e=y.map(function(d){return a(d)}).concat(x);d=d||{};d.defined=d.defined||{};if(d.defined.log)return d.log;
d.defined.log=!0;for(var g=0;g<e.length;++g)e[g](d);return d.log}},t=m;m=function(a,e){return y="string"==typeof a?e.slice(2):a.slice(2),F?(delete m,t.apply(null,Array.prototype.slice.call(arguments,0))):(m=t,m.apply(null,Array.prototype.slice.call(arguments,0)))};m("js/log",["require","module","./util"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function x(a){function e(b){var c={},d=[];if(!f.validate(b,m.asn1.recipientInfoValidator,c,d))throw b=Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo."),
b.errors=d,b;return{version:c.version.charCodeAt(0),issuer:a.pki.RDNAttributesAsArray(c.issuer),serialNumber:a.util.createBuffer(c.serial).toHex(),encryptedContent:{algorithm:f.derToOid(c.encAlgorithm),parameter:c.encParameter.value,content:c.encKey}}}function d(b){return f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,f.integerToDer(b.version).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[a.pki.distinguishedNameToAsn1({attributes:b.issuer}),
f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,a.util.hexToBytes(b.serialNumber))]),f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(b.encryptedContent.algorithm).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.NULL,!1,"")]),f.create(f.Class.UNIVERSAL,f.Type.OCTETSTRING,!1,b.encryptedContent.content)])}function k(a){for(var b=[],c=0;c<a.length;++c)b.push(d(a[c]));return b}function g(b){var c=f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,
f.Type.INTEGER,!1,f.integerToDer(b.version).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[a.pki.distinguishedNameToAsn1({attributes:b.issuer}),f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,a.util.hexToBytes(b.serialNumber))]),f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(b.digestAlgorithm).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.NULL,!1,"")])]);b.authenticatedAttributesAsn1&&c.value.push(b.authenticatedAttributesAsn1);c.value.push(f.create(f.Class.UNIVERSAL,
f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(b.signatureAlgorithm).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.NULL,!1,"")]));c.value.push(f.create(f.Class.UNIVERSAL,f.Type.OCTETSTRING,!1,b.signature));if(0<b.unauthenticatedAttributes.length){for(var d=f.create(f.Class.CONTEXT_SPECIFIC,1,!0,[]),e=0;e<b.unauthenticatedAttributes.length;++e)d.values.push(h(b.unauthenticatedAttributes[e]));c.value.push(d)}return c}function h(b){var c;if(b.type===a.pki.oids.contentType)c=
f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(b.value).getBytes());else if(b.type===a.pki.oids.messageDigest)c=f.create(f.Class.UNIVERSAL,f.Type.OCTETSTRING,!1,b.value.bytes());else if(b.type===a.pki.oids.signingTime){var d=new Date("Jan 1, 1950 00:00:00Z"),e=new Date("Jan 1, 2050 00:00:00Z"),g=b.value;if("string"==typeof g){var h=Date.parse(g);isNaN(h)?13===g.length?g=f.utcTimeToDate(g):g=f.generalizedTimeToDate(g):g=new Date(h)}g>=d&&g<e?c=f.create(f.Class.UNIVERSAL,f.Type.UTCTIME,!1,f.dateToUtcTime(g)):
c=f.create(f.Class.UNIVERSAL,f.Type.GENERALIZEDTIME,!1,f.dateToGeneralizedTime(g))}return f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(b.type).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.SET,!0,[c])])}function c(b){return[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(a.pki.oids.data).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(b.algorithm).getBytes()),f.create(f.Class.UNIVERSAL,
f.Type.OCTETSTRING,!1,b.parameter.getBytes())]),f.create(f.Class.CONTEXT_SPECIFIC,0,!0,[f.create(f.Class.UNIVERSAL,f.Type.OCTETSTRING,!1,b.content.getBytes())])]}function b(b,c,d){var e={};if(!f.validate(c,d,e,[]))throw b=Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message."),b.errors=b,b;if(f.derToOid(e.contentType)!==a.pki.oids.data)throw Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(e.encryptedContent){c="";if(a.util.isArray(e.encryptedContent))for(d=
0;d<e.encryptedContent.length;++d){if(e.encryptedContent[d].type!==f.Type.OCTETSTRING)throw Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");c+=e.encryptedContent[d].value}else c=e.encryptedContent;b.encryptedContent={algorithm:f.derToOid(e.encAlgorithm),parameter:a.util.createBuffer(e.encParameter.value),content:a.util.createBuffer(c)}}if(e.content){c="";if(a.util.isArray(e.content))for(d=0;d<e.content.length;++d){if(e.content[d].type!==f.Type.OCTETSTRING)throw Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");
c+=e.content[d].value}else c=e.content;b.content=a.util.createBuffer(c)}return b.version=e.version.charCodeAt(0),b.rawCapture=e,e}function n(b){if(void 0===b.encryptedContent.key)throw Error("Symmetric key not available.");if(void 0===b.content){var c;switch(b.encryptedContent.algorithm){case a.pki.oids["aes128-CBC"]:case a.pki.oids["aes192-CBC"]:case a.pki.oids["aes256-CBC"]:c=a.aes.createDecryptionCipher(b.encryptedContent.key);break;case a.pki.oids.desCBC:case a.pki.oids["des-EDE3-CBC"]:c=a.des.createDecryptionCipher(b.encryptedContent.key);
break;default:throw Error("Unsupported symmetric cipher, OID "+b.encryptedContent.algorithm);}c.start(b.encryptedContent.parameter);c.update(b.encryptedContent.content);if(!c.finish())throw Error("Symmetric decryption failed.");b.content=c.output}}var f=a.asn1,m=a.pkcs7=a.pkcs7||{};m.messageFromPem=function(b){b=a.pem.decode(b)[0];if("PKCS7"!==b.type){var c=Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw c.headerType=b.type,c;}if(b.procType&&"ENCRYPTED"===
b.procType.type)throw Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");b=f.fromDer(b.body);return m.messageFromAsn1(b)};m.messageToPem=function(b,c){var d={type:"PKCS7",body:f.toDer(b.toAsn1()).getBytes()};return a.pem.encode(d,{maxline:c})};m.messageToPemWithoutContent=function(b,c){var d={type:"PKCS7",body:f.toDer(b.toAsn1WithoutContent()).getBytes()};return a.pem.encode(d,{maxline:c})};m.messageFromAsn1=function(b){var c={},d=[];if(!f.validate(b,m.asn1.contentInfoValidator,
c,d))throw c=Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo."),c.errors=d,c;d=f.derToOid(c.contentType);switch(d){case a.pki.oids.envelopedData:d=m.createEnvelopedData();break;case a.pki.oids.encryptedData:d=m.createEncryptedData();break;case a.pki.oids.signedData:d=m.createSignedData();break;default:throw Error("Cannot read PKCS#7 message. ContentType with OID "+d+" is not (yet) supported.");}return d.fromAsn1(c.content.value[0]),d};m.createSignedData=function(){var c=
null;return c={type:a.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(d){b(c,d,m.asn1.signedDataValidator);c.certificates=[];c.crls=[];c.digestAlgorithmIdentifiers=[];c.contentInfo=null;c.signerInfos=[];d=c.rawCapture.certificates.value;for(var f=0;f<d.length;++f)c.certificates.push(a.pki.certificateFromAsn1(d[f]))},toAsn1:function(){c.contentInfo||c.sign();for(var b=[],d=0;d<c.certificates.length;++d)b.push(a.pki.certificateToAsn1(c.certificates[d]));
var d=[],e=f.create(f.Class.CONTEXT_SPECIFIC,0,!0,[f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,f.integerToDer(c.version).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.SET,!0,c.digestAlgorithmIdentifiers),c.contentInfo])]);return 0<b.length&&e.value[0].value.push(f.create(f.Class.CONTEXT_SPECIFIC,0,!0,b)),0<d.length&&e.value[0].value.push(f.create(f.Class.CONTEXT_SPECIFIC,1,!0,d)),e.value[0].value.push(f.create(f.Class.UNIVERSAL,f.Type.SET,!0,c.signerInfos)),
f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(c.type).getBytes()),e])},toAsn1WithoutContent:function(){return c.contentInfo.value.pop(),c.toAsn1()},addSigner:function(b){var d=b.issuer,f=b.serialNumber;b.certificate&&(f=b.certificate,"string"==typeof f&&(f=a.pki.certificateFromPem(f)),d=f.issuer.attributes,f=f.serialNumber);var e=b.key;if(!e)throw Error("Could not add PKCS#7 signer; no private key specified.");"string"==typeof e&&(e=a.pki.privateKeyFromPem(e));
var g=b.digestAlgorithm||a.pki.oids.sha1;switch(g){case a.pki.oids.sha1:case a.pki.oids.sha256:case a.pki.oids.sha384:case a.pki.oids.sha512:case a.pki.oids.md5:break;default:throw Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+g);}b=b.authenticatedAttributes||[];if(0<b.length){for(var h=!1,k=!1,n=0;n<b.length;++n){var m=b[n];if(!h&&m.type===a.pki.oids.contentType){if(h=!0,k)break}else if(!k&&m.type===a.pki.oids.messageDigest&&(k=!0,h))break}if(!h||!k)throw Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.");
}c.signers.push({key:e,version:1,issuer:d,serialNumber:f,digestAlgorithm:g,signatureAlgorithm:a.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:b,unauthenticatedAttributes:[]})},sign:function(){if("object"!=typeof c.content||null===c.contentInfo)if(c.contentInfo=f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(a.pki.oids.data).getBytes())]),"content"in c){var b;c.content instanceof a.util.ByteBuffer?b=c.content.bytes():"string"==typeof c.content&&
(b=a.util.encodeUtf8(c.content));c.contentInfo.value.push(f.create(f.Class.CONTEXT_SPECIFIC,0,!0,[f.create(f.Class.UNIVERSAL,f.Type.OCTETSTRING,!1,b)]))}if(0!==c.signers.length){b={};for(var d=0;d<c.signers.length;++d){var e=c.signers[d],k=e.digestAlgorithm;k in b||(b[k]=a.md[a.pki.oids[k]].create());0===e.authenticatedAttributes.length?e.md=b[k]:e.md=a.md[a.pki.oids[k]].create()}c.digestAlgorithmIdentifiers=[];for(k in b)c.digestAlgorithmIdentifiers.push(f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,
!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(k).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.NULL,!1,"")]));if(2>c.contentInfo.value.length)throw Error("Could not sign PKCS#7 message; there is no content to sign.");var k=f.derToOid(c.contentInfo.value[0].value),d=c.contentInfo.value[1],d=d.value[0],n=f.toDer(d);n.getByte();f.getBerValueLength(n);var n=n.getBytes(),m;for(m in b)b[m].start().update(n);m=new Date;for(d=0;d<c.signers.length;++d){e=c.signers[d];if(0===e.authenticatedAttributes.length){if(k!==
a.pki.oids.data)throw Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.");}else{e.authenticatedAttributesAsn1=f.create(f.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var n=f.create(f.Class.UNIVERSAL,f.Type.SET,!0,[]),w=0;w<e.authenticatedAttributes.length;++w){var t=e.authenticatedAttributes[w];t.type===a.pki.oids.messageDigest?t.value=b[e.digestAlgorithm].digest():t.type===a.pki.oids.signingTime&&(t.value||(t.value=m));n.value.push(h(t));
e.authenticatedAttributesAsn1.value.push(h(t))}n=f.toDer(n).getBytes();e.md.start().update(n)}e.signature=e.key.sign(e.md,"RSASSA-PKCS1-V1_5")}b=c;k=c.signers;m=[];for(d=0;d<k.length;++d)m.push(g(k[d]));b.signerInfos=m}},verify:function(){throw Error("PKCS#7 signature verification not yet implemented.");},addCertificate:function(b){"string"==typeof b&&(b=a.pki.certificateFromPem(b));c.certificates.push(b)},addCertificateRevokationList:function(a){throw Error("PKCS#7 CRL support not yet implemented.");
}},c};m.createEncryptedData=function(){var c=null;return c={type:a.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:a.pki.oids["aes256-CBC"]},fromAsn1:function(a){b(c,a,m.asn1.encryptedDataValidator)},decrypt:function(a){void 0!==a&&(c.encryptedContent.key=a);n(c)}},c};m.createEnvelopedData=function(){var d=null;return d={type:a.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:a.pki.oids["aes256-CBC"]},fromAsn1:function(a){var c=b(d,a,m.asn1.envelopedDataValidator);
a=d;for(var c=c.recipientInfos.value,f=[],g=0;g<c.length;++g)f.push(e(c[g]));a.recipients=f},toAsn1:function(){return f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(d.type).getBytes()),f.create(f.Class.CONTEXT_SPECIFIC,0,!0,[f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,f.integerToDer(d.version).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.SET,!0,k(d.recipients)),f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,
!0,c(d.encryptedContent))])])])},findRecipient:function(a){for(var b=a.issuer.attributes,c=0;c<d.recipients.length;++c){var f=d.recipients[c],e=f.issuer;if(f.serialNumber===a.serialNumber&&e.length===b.length){for(var g=!0,h=0;h<b.length;++h)if(e[h].type!==b[h].type||e[h].value!==b[h].value){g=!1;break}if(g)return f}}return null},decrypt:function(b,c){if(void 0===d.encryptedContent.key&&void 0!==b&&void 0!==c)switch(b.encryptedContent.algorithm){case a.pki.oids.rsaEncryption:case a.pki.oids.desCBC:var f=
c.decrypt(b.encryptedContent.content);d.encryptedContent.key=a.util.createBuffer(f);break;default:throw Error("Unsupported asymmetric cipher, OID "+b.encryptedContent.algorithm);}n(d)},addRecipient:function(b){d.recipients.push({version:0,issuer:b.issuer.attributes,serialNumber:b.serialNumber,encryptedContent:{algorithm:a.pki.oids.rsaEncryption,key:b.publicKey}})},encrypt:function(b,c){if(void 0===d.encryptedContent.content){c=c||d.encryptedContent.algorithm;b=b||d.encryptedContent.key;var f,e,g;
switch(c){case a.pki.oids["aes128-CBC"]:e=f=16;g=a.aes.createEncryptionCipher;break;case a.pki.oids["aes192-CBC"]:f=24;e=16;g=a.aes.createEncryptionCipher;break;case a.pki.oids["aes256-CBC"]:f=32;e=16;g=a.aes.createEncryptionCipher;break;case a.pki.oids["des-EDE3-CBC"]:f=24;e=8;g=a.des.createEncryptionCipher;break;default:throw Error("Unsupported symmetric cipher, OID "+c);}if(void 0===b)b=a.util.createBuffer(a.random.getBytes(f));else if(b.length()!=f)throw Error("Symmetric key has wrong length; got "+
b.length()+" bytes, expected "+f+".");d.encryptedContent.algorithm=c;d.encryptedContent.key=b;d.encryptedContent.parameter=a.util.createBuffer(a.random.getBytes(e));f=g(b);f.start(d.encryptedContent.parameter.copy());f.update(d.content);if(!f.finish())throw Error("Symmetric encryption failed.");d.encryptedContent.content=f.output}for(f=0;f<d.recipients.length;++f)if(e=d.recipients[f],void 0===e.encryptedContent.content)switch(e.encryptedContent.algorithm){case a.pki.oids.rsaEncryption:e.encryptedContent.content=
e.encryptedContent.key.encrypt(d.encryptedContent.key.data);break;default:throw Error("Unsupported asymmetric cipher, OID "+e.encryptedContent.algorithm);}}},d}}if("function"!=typeof m){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),x(forge);var F=!0;m=function(a,e){e(G,module)}}var y,C=function(a,e){e.exports=function(d){var e=y.map(function(d){return a(d)}).concat(x);d=d||{};d.defined=d.defined||{};if(d.defined.pkcs7)return d.pkcs7;d.defined.pkcs7=!0;for(var g=
0;g<e.length;++g)e[g](d);return d.pkcs7}},t=m;m=function(a,e){return y="string"==typeof a?e.slice(2):a.slice(2),F?(delete m,t.apply(null,Array.prototype.slice.call(arguments,0))):(m=t,m.apply(null,Array.prototype.slice.call(arguments,0)))};m("js/pkcs7","require module ./aes ./asn1 ./des ./oids ./pem ./pkcs7asn1 ./random ./util ./x509".split(" "),function(){C.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function x(a){function e(d,c){var b=c.toString(16);"8"<=b[0]&&(b="00"+b);
b=a.util.hexToBytes(b);d.putInt32(b.length);d.putBytes(b)}function d(a,c){a.putInt32(c.length);a.putString(c)}function k(){for(var d=a.md.sha1.create(),c=arguments.length,b=0;b<c;++b)d.update(arguments[b]);return d.digest()}var g=a.ssh=a.ssh||{};g.privateKeyToPutty=function(g,c,b){b=b||"";c=c||"";var n=""===c?"none":"aes256-cbc",f;f="PuTTY-User-Key-File-2: ssh-rsa\r\n"+("Encryption: "+n+"\r\n")+("Comment: "+b+"\r\n");var m=a.util.createBuffer();d(m,"ssh-rsa");e(m,g.e);e(m,g.n);var u=a.util.encode64(m.bytes(),
64),q=Math.floor(u.length/66)+1;f+="Public-Lines: "+q+"\r\n";f+=u;u=a.util.createBuffer();e(u,g.d);e(u,g.p);e(u,g.q);e(u,g.qInv);c?(q=u.length()+16-1,q-=q%16,g=k(u.bytes()),g.truncate(g.length()-q+u.length()),u.putBuffer(g),q=a.util.createBuffer(),q.putBuffer(k("\x00\x00\x00\x00",c)),q.putBuffer(k("\x00\x00\x00\u0001",c)),q=a.aes.createEncryptionCipher(q.truncate(8),"CBC"),q.start(a.util.createBuffer().fillWithByte(0,16)),q.update(u.copy()),q.finish(),q=q.output,q.truncate(16),g=a.util.encode64(q.bytes(),
64)):g=a.util.encode64(u.bytes(),64);q=Math.floor(g.length/66)+1;f+="\r\nPrivate-Lines: "+q+"\r\n";f+=g;c=k("putty-private-key-file-mac-key",c);q=a.util.createBuffer();d(q,"ssh-rsa");d(q,n);d(q,b);q.putInt32(m.length());q.putBuffer(m);q.putInt32(u.length());q.putBuffer(u);b=a.hmac.create();return b.start("sha1",c),b.update(q.bytes()),f+="\r\nPrivate-MAC: "+b.digest().toHex()+"\r\n",f};g.publicKeyToOpenSSH=function(g,c){c=c||"";var b=a.util.createBuffer();return d(b,"ssh-rsa"),e(b,g.e),e(b,g.n),"ssh-rsa "+
a.util.encode64(b.bytes())+" "+c};g.privateKeyToOpenSSH=function(d,c){return c?a.pki.encryptRsaPrivateKey(d,c,{legacy:!0,algorithm:"aes128"}):a.pki.privateKeyToPem(d)};g.getPublicKeyFingerprint=function(g,c){c=c||{};var b=c.md||a.md.md5.create(),k=a.util.createBuffer();d(k,"ssh-rsa");e(k,g.e);e(k,g.n);b.start();b.update(k.getBytes());b=b.digest();if("hex"===c.encoding)return b=b.toHex(),c.delimiter?b.match(/.{2}/g).join(c.delimiter):b;if("binary"===c.encoding)return b.getBytes();if(c.encoding)throw Error('Unknown encoding "'+
c.encoding+'".');return b}}if("function"!=typeof m){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),x(forge);var F=!0;m=function(a,e){e(G,module)}}var y,C=function(a,e){e.exports=function(d){var e=y.map(function(d){return a(d)}).concat(x);d=d||{};d.defined=d.defined||{};if(d.defined.ssh)return d.ssh;d.defined.ssh=!0;for(var g=0;g<e.length;++g)e[g](d);return d.ssh}},t=m;m=function(a,e){return y="string"==typeof a?e.slice(2):a.slice(2),F?(delete m,t.apply(null,
Array.prototype.slice.call(arguments,0))):(m=t,m.apply(null,Array.prototype.slice.call(arguments,0)))};m("js/ssh","require module ./aes ./hmac ./md5 ./sha1 ./util".split(" "),function(){C.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function x(a){var e={},d=0;a.debug.set("forge.task","tasks",e);var k={};a.debug.set("forge.task","queues",k);var g={ready:{}};g.ready.stop="ready";g.ready.start="running";g.ready.cancel="done";g.ready.fail="error";g.running={};g.running.stop="ready";
g.running.start="running";g.running.block="blocked";g.running.unblock="running";g.running.sleep="sleeping";g.running.wakeup="running";g.running.cancel="done";g.running.fail="error";g.blocked={};g.blocked.stop="blocked";g.blocked.start="blocked";g.blocked.block="blocked";g.blocked.unblock="blocked";g.blocked.sleep="blocked";g.blocked.wakeup="blocked";g.blocked.cancel="done";g.blocked.fail="error";g.sleeping={};g.sleeping.stop="sleeping";g.sleeping.start="sleeping";g.sleeping.block="sleeping";g.sleeping.unblock=
"sleeping";g.sleeping.sleep="sleeping";g.sleeping.wakeup="sleeping";g.sleeping.cancel="done";g.sleeping.fail="error";g.done={};g.done.stop="done";g.done.start="done";g.done.block="done";g.done.unblock="done";g.done.sleep="done";g.done.wakeup="done";g.done.cancel="done";g.done.fail="error";g.error={};g.error.stop="error";g.error.start="error";g.error.block="error";g.error.unblock="error";g.error.sleep="error";g.error.wakeup="error";g.error.cancel="error";g.error.fail="error";var h=function(a){this.id=
-1;this.name=a.name||"?";this.parent=a.parent||null;this.run=a.run;this.subtasks=[];this.error=!1;this.state="ready";this.blocks=0;this.userData=this.swapTime=this.timeoutId=null;this.id=d++;e[this.id]=this};h.prototype.debug=function(b){a.log.debug("forge.task",b||"","[%s][%s] task:",this.id,this.name,this,"subtasks:",this.subtasks.length,"queue:",k)};h.prototype.next=function(a,b){"function"==typeof a&&(b=a,a=this.name);var c=new h({run:b,name:a,parent:this});return c.state="running",c.type=this.type,
c.successCallback=this.successCallback||null,c.failureCallback=this.failureCallback||null,this.subtasks.push(c),this};h.prototype.parallel=function(b,c){return a.util.isArray(b)&&(c=b,b=this.name),this.next(b,function(d){d.block(c.length);for(var e=function(b,f){a.task.start({type:b,run:function(a){c[f](a)},success:function(a){d.unblock()},failure:function(a){d.unblock()}})},g=0;g<c.length;g++)e(b+"__parallel-"+d.id+"-"+g,g)})};h.prototype.stop=function(){this.state=g[this.state].stop};h.prototype.start=
function(){this.error=!1;this.state=g[this.state].start;"running"===this.state&&(this.start=new Date,this.run(this),b(this,0))};h.prototype.block=function(a){this.blocks+="undefined"==typeof a?1:a;0<this.blocks&&(this.state=g[this.state].block)};h.prototype.unblock=function(a){return a="undefined"==typeof a?1:a,this.blocks-=a,0===this.blocks&&"done"!==this.state&&(this.state="running",b(this,0)),this.blocks};h.prototype.sleep=function(a){this.state=g[this.state].sleep;var c=this;this.timeoutId=setTimeout(function(){c.timeoutId=
null;c.state="running";b(c,0)},"undefined"==typeof a?0:a)};h.prototype.wait=function(a){a.wait(this)};h.prototype.wakeup=function(){"sleeping"===this.state&&(cancelTimeout(this.timeoutId),this.timeoutId=null,this.state="running",b(this,0))};h.prototype.cancel=function(){this.state=g[this.state].cancel;this.permitsNeeded=0;null!==this.timeoutId&&(cancelTimeout(this.timeoutId),this.timeoutId=null);this.subtasks=[]};h.prototype.fail=function(a){this.error=!0;n(this,!0);if(a)a.error=this.error,a.swapTime=
this.swapTime,a.userData=this.userData,b(a,0);else{if(null!==this.parent){for(a=this.parent;null!==a.parent;)a.error=this.error,a.swapTime=this.swapTime,a.userData=this.userData,a=a.parent;n(a,!0)}this.failureCallback&&this.failureCallback(this)}};var c=function(a){a.error=!1;a.state=g[a.state].start;setTimeout(function(){"running"===a.state&&(a.swapTime=+new Date,a.run(a),b(a,0))},0)},b=function(a,c){var d=30<c||20<+new Date-a.swapTime,e=function(c){c++;if("running"===a.state)if(d&&(a.swapTime=+new Date),
0<a.subtasks.length){var e=a.subtasks.shift();e.error=a.error;e.swapTime=a.swapTime;e.userData=a.userData;e.run(e);e.error||b(e,c)}else n(a),a.error||null!==a.parent&&(a.parent.error=a.error,a.parent.swapTime=a.swapTime,a.parent.userData=a.userData,b(a.parent,c))};d?setTimeout(e,0):e(c)},n=function(b,c){b.state="done";delete e[b.id];null===b.parent&&(b.type in k?0===k[b.type].length?a.log.error("forge.task","[%s][%s] task queue empty [%s]",b.id,b.name,b.type):k[b.type][0]!==b?a.log.error("forge.task",
"[%s][%s] task not first in queue [%s]",b.id,b.name,b.type):(k[b.type].shift(),0===k[b.type].length?delete k[b.type]:k[b.type][0].start()):a.log.error("forge.task","[%s][%s] task queue missing [%s]",b.id,b.name,b.type),c||(b.error&&b.failureCallback?b.failureCallback(b):!b.error&&b.successCallback&&b.successCallback(b)))};a.task=a.task||{};a.task.start=function(a){var b=new h({run:a.run,name:a.name||"?"});b.type=a.type;b.successCallback=a.success||null;b.failureCallback=a.failure||null;b.type in k?
k[a.type].push(b):(k[b.type]=[b],c(b))};a.task.cancel=function(a){a in k&&(k[a]=[k[a][0]])};a.task.createCondition=function(){var a={tasks:{}};return a.wait=function(b){b.id in a.tasks||(b.block(),a.tasks[b.id]=b)},a.notify=function(){var b=a.tasks;a.tasks={};for(var c in b)b[c].unblock()},a}}if("function"!=typeof m){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),x(forge);var F=!0;m=function(a,e){e(G,module)}}var y,C=function(a,e){e.exports=function(d){var e=
y.map(function(d){return a(d)}).concat(x);d=d||{};d.defined=d.defined||{};if(d.defined.task)return d.task;d.defined.task=!0;for(var g=0;g<e.length;++g)e[g](d);return d.task}},t=m;m=function(a,e){return y="string"==typeof a?e.slice(2):a.slice(2),F?(delete m,t.apply(null,Array.prototype.slice.call(arguments,0))):(m=t,m.apply(null,Array.prototype.slice.call(arguments,0)))};m("js/task",["require","module","./debug","./log","./util"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})}(),
function(){if("function"!=typeof m){if("object"!=typeof module||!module.exports){"undefined"==typeof forge&&(forge={disableNativeCode:!1});return}var x=!0;m=function(m,a){a(G,module)}}var F,y=function(m,a){a.exports=function(a){var d=F.map(function(a){return m(a)});a=a||{};a.defined=a.defined||{};if(a.defined.forge)return a.forge;a.defined.forge=!0;for(var k=0;k<d.length;++k)d[k](a);return a};a.exports.disableNativeCode=!1;a.exports(a.exports)},C=m;m=function(t,a){return F="string"==typeof t?a.slice(2):
t.slice(2),x?(delete m,C.apply(null,Array.prototype.slice.call(arguments,0))):(m=C,m.apply(null,Array.prototype.slice.call(arguments,0)))};m("js/forge","require module ./aes ./aesCipherSuites ./asn1 ./cipher ./cipherModes ./debug ./des ./hmac ./kem ./log ./md ./mgf1 ./pbkdf2 ./pem ./pkcs7 ./pkcs1 ./pkcs12 ./pki ./prime ./prng ./pss ./random ./rc2 ./ssh ./task ./tls ./util".split(" "),function(){y.apply(null,Array.prototype.slice.call(arguments,0))})}(),G("js/forge")})}
var twcaLib=new twidCryptoLibSync,twcaCryptoLibAlertDialog=new TwcaCryptoLibAlertDialog,twcaDialogParams;
function twidCryptoLibSync(){function I(d,e,h,c){var b="",n,f;do if(null==a.selectedCertInfo||null!=e)G(e,h);else{var m=61440&c;switch(m){case 0:m=forge.pki.oids.sha1;break;case 4096:m=forge.pki.oids.md5;break;case 8192:m=forge.pki.oids.sha256;break;case 16384:m=forge.pki.oids.sha512;break;default:m=forge.pki.oids.sha1}var u=3840&c,u=1024==u?!1:!0,q=15&c,b=forge.asn1.fromDer(forge.util.decode64(a.selectedCertInfo.certb64)),b=forge.pki.certificateFromAsn1(b);n=JSON.parse(sessionStorage.getItem("twcaSelectedKey"));
n=C(null,null,n);f=forge.pkcs7.createSignedData();switch(q){case 0:f.content=forge.util.createBuffer(x(d),"raw");break;case 1:f.content=forge.util.createBuffer(d,"utf8");break;case 2:f.content="undefined"==typeof Big5Encoding?forge.util.createBuffer(d,"utf8"):forge.util.createBuffer(Big5Encoding.getBig5Encoding(d),"raw");break;default:f.content=forge.util.createBuffer(x(d),"raw")}f.addCertificate(b);f.addSigner({key:n,certificate:b,digestAlgorithm:m});f.sign();b=u?forge.pkcs7.messageToPem(f):forge.pkcs7.messageToPemWithoutContent(f);
b=b.replace(/\-----BEGIN PKCS7-----/g,"");b=b.replace(/\-----END PKCS7-----/g,"");b=b.replace(/(?:\\[rn]|[\r\n]+)+/g,"")}while(0);return b}function D(d,e,h,c){var b,n,f;do if(null==a.selectedCertInfo||null!=e)G(e,h);else{f=61440&c;switch(f){case 0:f=forge.md.sha1;break;case 4096:f=forge.md.md5;break;case 8192:f=forge.md.sha256;break;case 16384:f=forge.md.sha512;break;default:f=forge.md.sha1}b=3840&c;b=256==b?!1:!0;var m=15&c;n=JSON.parse(sessionStorage.getItem("twcaSelectedKey"));n=C(null,null,n);
f=f.create();switch(m){case 0:f.update(x(d));break;case 1:f.update(d,"utf8");break;case 2:"undefined"==typeof Big5Encoding?f.update(d,"utf8"):f.update(Big5Encoding.getBig5Encoding(d));break;default:f.update(x(d))}b=b?forge.util.bytesToHex(n.sign(f)):forge.util.encode64(n.sign(f))}while(0);return b}function G(a,d,e,c){var b=-1,m=[],f,w=null;f=localStorage.getItem("TWCACertIdxRef");if(null==f)w={};else if(""==f)w={};else try{console.log("obj name:TWCACertIdxRef"),console.log("obj value: "+f),w=JSON.parse(f)}catch(x){w=
{}}f=w;var u,w={},q=null,v="",J=!1,r=!1,p=!1,H;do if(4096==(61440&e)&&(J=!0),4==(4&e)&&(r=!0),8==(8&e)&&(p=!0),H=e&240,null==a||""==a)b=5005,q=null;else if("//S"!=a.substring(0,3)&&"//I"!=a.substring(0,3)||"//"!=a.substring(a.length-2,a.length))b=5005,q=null;else if(null==d||""==d||14==d.length&&!isNaN(d)){u=a.replace(/^\/\/|\/\/\s*$/g,"").replace(/\s*=\s*/gm,"=").split("//");for(var z=0;z<u.length;z++){var A=z,D;a:{D={};for(var l="S_SN S_CN S_OU S_O S_C I_CN I_OU I_O I_C".split(" "),E=u[z];0<E.length;){var K=
E.substring(0,E.indexOf("="));if(!y(l,K)){D=5005;break a}var E=E.substring(E.indexOf("=")+1,E.length),B=E.length,L=E.indexOf(",S_"),G=E.indexOf(",I_");0<L&&L<B&&(B=L);0<G&&G<B&&(B=G);L=E.substring(0,B);"S_O"==K||"S_OU"==K||"I_O"==K||"I_OU"==K?(D[K]||(D[K]=[]),D[K].push(L)):D[K]=L;E=E.substring(B+1,E.length)}}m[A]=D}if(y(m,5005)||""==m[0])b=5005,q=null;else{for(var I in f){u=f[I];console.log("cert subject: "+u.cn);u.certb64=JSON.parse(localStorage.getItem(I)).certb64;if(p){z=m;D=F(u.certb64);A=D.subject;
D=D.issuer;l=!1;for(E=0;E<z.length;E++){var K=!0,N;for(N in z[E])if("S_SN"==N)z[E][N].toUpperCase()!=A.SN&&(K=!1);else if("S_CN"==N)0>A.CN.indexOf(z[E][N])&&(K=!1);else if("S_OU"==N)for(B=0;B<z[E][N].length;B++)y(A.OU,z[E][N][B])||(K=!1);else if("S_O"==N)for(B=0;B<z[E][N].length;B++)y(A.O,z[E][N][B])||(K=!1);else if("S_C"==N)z[E][N]!=A.C&&(K=!1);else if("I_CN"==N)z[E][N]!=D.CN&&(K=!1);else if("I_OU"==N)for(B=0;B<z[E][N].length;B++)y(D.OU,z[E][N][B])||(K=!1);else if("I_O"==N)for(B=0;B<z[E][N].length;B++)y(D.O,
z[E][N][B])||(K=!1);else"I_C"==N&&z[E][N]!=D.C&&(K=!1);if(l=l||K)break}z=l}else{z=m;A=F(u.certb64).subject;D=!1;for(l=0;l<z.length;l++)if(E=!1,z[l].S_C==A.C&&(null==A.O||null!=z[l].S_O&&z[l].S_O.length==A.O.length)){for(K=0;null!=A.O&&K<A.O.length;K++)y(z[l].S_O,A.O[K])||(E=!0);if(!E&&(null==A.OU||null!=z[l].S_OU&&z[l].S_OU.length==A.OU.length)){for(K=0;null!=A.OU&&K<A.OU.length;K++)y(z[l].S_OU,A.OU[K])||(E=!0);if(!E&&z[l].S_CN==A.CN){D=!0;break}}}z=D}""!=d?u.notAfter<d&&(z=!1):r&&(B=new Date,A=B.getFullYear(),
D=B.getMonth()+1,l=B.getDate(),E=B.getHours(),K=B.getMinutes(),B=B.getSeconds(),A="0000"+A,A=A.substring(A.length-4,A.length),D="00"+D,D=D.substring(D.length-2,D.length),l="00"+l,l=l.substring(l.length-2,l.length),E="00"+E,E=E.substring(E.length-2,E.length),K="00"+K,K=K.substring(K.length-2,K.length),B="00"+B,B=B.substring(B.length-2,B.length),u.notAfter<A+D+l+E+K+B&&(z=!1));z&&null!=localStorage.getItem(I)&&""!=localStorage.getItem(I)&&(w[I]=u)}for(var M in w)if(null==q)v=M,q=w[M];else switch(H){case 0:q.notBefore<=
w[M].notBefore&&(v=M,q=w[M]);break;case 16:q.notBefore<=w[M].notBefore&&(v=M,q=w[M]);break;case 32:q.notBefore>=w[M].notBefore&&(v=M,q=w[M]);break;case 64:q.notAfter<=w[M].notAfter&&(v=M,q=w[M]);break;case 128:q.notAfter>=w[M].notAfter&&(v=M,q=w[M]);break;default:q.notAfter<=w[M].notAfter&&(v=M,q=w[M])}if(null==q)b=5010,q=null;else if(q.b64P12Cert=JSON.parse(localStorage.getItem(v)).b64P12Cert,q.keySet=JSON.parse(localStorage.getItem(v)).keySet,q.certfinger=JSON.parse(localStorage.getItem(v)).certfinger,
q.certb64=JSON.parse(localStorage.getItem(v)).certb64,!J){sessionStorage.removeItem("twcaSelectedKey");if(q.b64P12Cert){H=c;u=null;try{u=forge.pkcs12.pkcs12FromAsn1(forge.asn1.fromDer(forge.util.decode64(q.b64P12Cert)),H)}catch(x){}H=u;if(!H){b=5071;q=null;break}H=H.getBags({bagType:forge.pki.oids.pkcs8ShroudedKeyBag})[forge.pki.oids.pkcs8ShroudedKeyBag][0].key;H=JSON.stringify(t(H))}else if(q.keySet){H=C(q.keySet,c);if(!H){b=5071;q=null;break}H=JSON.stringify(t(H))}else{b=5112;q=null;break}sessionStorage.setItem("twcaSelectedKey",
H)}}}else b=5005,rtnCodeInfo=null;while(0);return null!=q?q:b}function m(a){return a?'"sn":"'+a.serial+'","cn":"'+a.cn+'","ntb":"'+a.notBefore+'","nta":"'+a.notAfter+'","issdn":"'+a.issuer+'","subdn":"'+a.subject+'","certfinger":"'+a.certfinger+'","certb64":"'+a.certb64+'"':""}function x(a){for(var d=new Uint8Array(2*a.length),e=0;e<a.length;e++){var c=a.charCodeAt(e);d[2*e]=c&255;d[2*e+1]=c>>8&255}a="";for(e=0;e<d.length;e++)a=16>d[e]?a+"%0":a+"%",a+=d[e].toString(16);return unescape(a)}function F(a){ret=
{};var d;try{d=forge.asn1.fromDer(forge.util.decode64(a)),d=forge.pki.certificateFromAsn1(d)}catch(c){return null}ret.subject={};for(a=0;a<d.subject.attributes.length;a++){var e=d.subject.attributes[a];"C"==e.shortName&&(ret.subject.C=e.value);"O"==e.shortName&&(null==ret.subject.O&&(ret.subject.O=[]),ret.subject.O.push(e.value));"OU"==e.shortName&&(null==ret.subject.OU&&(ret.subject.OU=[]),ret.subject.OU.push(e.value));"CN"==e.shortName&&(ret.subject.CN=e.value)}ret.subject.SN=d.serialNumber.toUpperCase();
ret.issuer={};for(a=0;a<d.issuer.attributes.length;a++)e=d.issuer.attributes[a],"C"==e.shortName&&(ret.issuer.C=e.value),"O"==e.shortName&&(null==ret.issuer.O&&(ret.issuer.O=[]),ret.issuer.O.push(e.value)),"OU"==e.shortName&&(null==ret.issuer.OU&&(ret.issuer.OU=[]),ret.issuer.OU.push(e.value)),"CN"==e.shortName&&(ret.issuer.CN=e.value);return ret}function y(a,d){for(var e in a)if(a[e]==d)return!0;return!1}function C(a,d,e){var c=null;try{if(3>arguments.length){var b=forge.md.sha256.create();b.update(d);
var m=b.digest().getBytes(),f=forge.cipher.createDecipher("AES-CBC",m);f.start({iv:""});f.update(forge.util.createBuffer(forge.util.decode64(a)));f.finish();var w=f.output.data.split("||");"TWCA"==w[8]&&(c=forge.pki.setRsaPrivateKey(new forge.jsbn.BigInteger(w[1],16),new forge.jsbn.BigInteger(w[0],16),new forge.jsbn.BigInteger(w[7],16),new forge.jsbn.BigInteger(w[2],16),new forge.jsbn.BigInteger(w[3],16),new forge.jsbn.BigInteger(w[4],16),new forge.jsbn.BigInteger(w[5],16),new forge.jsbn.BigInteger(w[6],
16)))}else c=forge.pki.setRsaPrivateKey(new forge.jsbn.BigInteger(e.n,16),new forge.jsbn.BigInteger(e.e,16),new forge.jsbn.BigInteger(e.d,16),new forge.jsbn.BigInteger(e.p,16),new forge.jsbn.BigInteger(e.q,16),new forge.jsbn.BigInteger(e.dP,16),new forge.jsbn.BigInteger(e.dQ,16),new forge.jsbn.BigInteger(e.qInv,16))}catch(u){c=null}return c}function t(a){if(a){var d={};d.n=a.n.toString(16);d.e=a.e.toString(16);d.d=a.d.toString(16);d.p=a.p.toString(16);d.q=a.q.toString(16);d.dP=a.dP.toString(16);d.dQ=
a.dQ.toString(16);d.qInv=a.qInv.toString(16);return d}}var a=this,e=null,d=!1;-1<navigator.userAgent.indexOf("TWID")&&(d=!0);this.SelectSignerEx=function(k,g,h,c,b,n,f,w,u){if(window.opener&&window.opener.twcaLib)e=[k,g,h,c,b,n,f,w,u],window.opener.twcaLib.setOpenWindowObject(window),window.opener.twcaLib.SelectSignerEx(k,g,h,c,b,n,f,w,"oTwcaLib._childWindow.twcaLib.SelectSignerExFromChildWindowHandler");else{if(d)try{"undefined"==typeof u&&(u="ret_SelectSignerEx");var q=MobileUtils.registerFunction(u),
v=navigator.userAgent;return MobileUtils.supportTwidAndroid()?(window.mobile.SelectSignerEx(k,g,h,c,b,MobileUtils.toNumber(n),f,w,q),0):0<v.indexOf("iPhone")||0<v.indexOf("iPad")?(document.location="PKI::SelectSignerEx::"+encodeURI(k+separation+g+separation+h+separation+c+separation+b+separation+n+separation+f+separation+w+separation+q),0):1}catch(p){return alert(p),-1}if(4>=arguments.length)return G(k,b,n,c);var q=0,v="\u6210\u529f",t="";do{var r=G(k,b,n,c);if("number"==typeof r)switch(r){case 5005:q=
5005;v="\u53c3\u6578\u932f\u8aa4";break;case 5010:q=5010;v="\u7121\u6191\u8b49";break;case 5071:if(null==c&&0>"oTwcaLib._childWindow.twcaLib.SelectSignerExFromChildWindowHandler".indexOf(u)){twcaCryptoLibAlertDialog.show("\u8f38\u5165\u5bc6\u78bc","\u8acb\u8f38\u5165\u6191\u8b49\u5bc6\u78bc","","\u53d6\u6d88","\u78ba\u8a8d",["SelectSignerEx",k,g,h,c,b,n,f,w,u,twcaLib]);return}q=5071;v="\u6191\u8b49\u5bc6\u78bc\u932f\u8aa4";break;case 5112:q=5112;v="\u8b80\u53d6\u6191\u8b49\u5931\u6557";break;default:q=
5001,v="\u4e00\u822c\u932f\u8aa4"}else 0==(n&61440)&&(a.selectedCertInfo=r,sessionStorage.setItem("selectedCertInfo",JSON.stringify(r))),t="{"+m(r)+"}"}while(0);a.callback(u,q,v,t)}};this.SignPkcs7=function(k,g,h,c){if(window.opener&&window.opener.twcaLib)e=[k,g,h],window.opener.twcaLib.setOpenWindowObject(window),window.opener.twcaLib.SignPkcs7(k,g,"oTwcaLib._childWindow.twcaLib.SignPkcs7FromChildWindowHandler");else{if(d)try{"undefined"==typeof h&&(h="ret_SignPkcs7");var b=MobileUtils.registerFunction(h),
n=navigator.userAgent;return MobileUtils.supportTwidAndroid()?(window.mobile.SignPkcs7(k,MobileUtils.toNumber(g),b),0):0<n.indexOf("iPhone")||0<n.indexOf("iPad")?(document.location="PKI::SignPkcs7::"+encodeURI(k+separation+g+separation+b),0):1}catch(u){return alert(u),-1}if(4<=arguments.length)return I(k,g,h,c);var f,b=0,n="\u6210\u529f",w="";if(null==k||0>=k.length)b=5005,n="\u53c3\u6578\u932f\u8aa4";else{if(f=sessionStorage.getItem("selectedCertInfo"))a.selectedCertInfo=JSON.parse(f);f=sessionStorage.getItem("twcaSelectedKey");
a.selectedCertInfo&&null!=f?(f=I(k,null,null,g),null==f||""==f?(b=5061,n="\u7c3d\u7ae0\u5931\u6557"):w="{"+m(a.selectedCertInfo)+',"signature":"'+f+'"}'):(b=5067,n="\u57f7\u884c\u7c3d\u7ae0\u6642\uff0c\u5c1a\u672a\u9078\u64c7\u7c3d\u7ae0\u6191\u8b49")}a.callback(h,b,n,w)}};this.SignPkcs1=function(k,g,h,c){if(window.opener&&window.opener.twcaLib)e=[k,g,h],window.opener.twcaLib.setOpenWindowObject(window),window.opener.twcaLib.SignPkcs1(k,g,"oTwcaLib._childWindow.twcaLib.SignPkcs1FromChildWindowHandler");
else{if(d)try{"undefined"==typeof h&&(h="ret_SignPkcs1");var b=MobileUtils.registerFunction(h),n=navigator.userAgent;return MobileUtils.supportTwidAndroid()?(window.mobile.SignPkcs1(k,MobileUtils.toNumber(g),b),0):0<n.indexOf("iPhone")||0<n.indexOf("iPad")?(document.location="PKI::SignPkcs1::"+encodeURI(k+separation+g+separation+b),0):1}catch(u){return alert(u),-1}if(4<=arguments.length)return D(k,g,h,c);var f,b=0,n="\u6210\u529f",w="";if(null==k||0>=k.length)b=5005,n="\u53c3\u6578\u932f\u8aa4";else{if(f=
sessionStorage.getItem("selectedCertInfo"))a.selectedCertInfo=JSON.parse(f);f=sessionStorage.getItem("twcaSelectedKey");a.selectedCertInfo&&null!=f?(f=D(k,null,null,g),null==f||""==f?(b=5061,n="\u7c3d\u7ae0\u5931\u6557"):w='{"signature":"'+f+'",'+m(a.selectedCertInfo)+"}"):(b=5067,n="\u57f7\u884c\u7c3d\u7ae0\u6642\uff0c\u5c1a\u672a\u9078\u64c7\u7c3d\u7ae0\u6191\u8b49")}a.callback(h,b,n,w)}};this.ResetKey=function(k){if(window.opener&&window.opener.twcaLib)e=[k],window.opener.twcaLib.setOpenWindowObject(window),
window.opener.twcaLib.ResetKey("oTwcaLib._childWindow.twcaLib.ResetKeyFromChildWindowHandler");else{if(d)try{"undefined"==typeof k&&(k="ret_ResetKey");var g=MobileUtils.registerFunction(k),h=navigator.userAgent;return MobileUtils.supportTwidAndroid()?(window.mobile.ResetKey(g),0):0<h.indexOf("iPhone")||0<h.indexOf("iPad")?(document.location="PKI::ResetKey::"+encodeURI(g),0):1}catch(c){return alert(c),-1}a.selectedCertInfo=null;sessionStorage.removeItem("selectedCertInfo");sessionStorage.removeItem("twcaSelectedKey");
if(0>=arguments.length)return 0;a.callback(k,0,"\u6210\u529f","")}};this.GetVersion=function(k){if(window.opener&&window.opener.twcaLib)e=[k],window.opener.twcaLib.setOpenWindowObject(window),window.opener.twcaLib.GetVersion("oTwcaLib._childWindow.twcaLib.GetVersionFromChildWindowHandler");else{if(d)try{"undefined"==typeof k&&(k="ret_GetVersion");var g=MobileUtils.registerFunction(k),h=navigator.userAgent;return MobileUtils.supportTwidAndroid()?(window.mobile.GetVersion(g),0):0<h.indexOf("iPhone")||
0<h.indexOf("iPad")?(document.location="PKI::GetVersion::"+encodeURI(g),0):1}catch(c){return alert(c),-1}if(0>=arguments.length)return"1.0.1.0";a.callback(k,0,"\u6210\u529f",'{"version":"1.0.1.0"}')}};this.QueryDeviceID=function(a,d,e){try{"undefined"==typeof e&&(e="ret_QueryDeviceID");var c=MobileUtils.registerFunction(e),b=navigator.userAgent;return MobileUtils.supportTwidAndroid()?(window.mobile.QueryDeviceID(a,d,c),0):0<b.indexOf("iPhone")||0<b.indexOf("iPad")?(document.location="PKI::QueryDeviceID::"+
encodeURI(a+separation+d+separation+c),0):1}catch(m){return alert(m),-1}};this.ImportPfxCert=function(a,d,e,c){};this.GetCertSubjectCN=function(){return a.getSelectedCertFieldValue("cn")};this.GetCertSubject=function(){return a.getSelectedCertFieldValue("subject")};this.GetCertIssuer=function(){return a.getSelectedCertFieldValue("issuer")};this.GetCertSerial=function(){return a.getSelectedCertFieldValue("serial")};this.GetCertNotBefore=function(){return a.getSelectedCertFieldValue("notBefore")};this.GetCertNotAfter=
function(){return a.getSelectedCertFieldValue("notAfter")};this.getSelectedCertFieldValue=function(d){return a.selectedCertInfo&&"undefined"!=typeof a.selectedCertInfo[d]?a.selectedCertInfo[d]:""};this.setOpenWindowObject=function(d){if("object"!=typeof d)return 5005;a._childWindow=d};this.SelectSignerExFromChildWindowHandler=function(d,g,h,c){5071==d&&null==e[3]?twcaCryptoLibAlertDialog.show("\u8f38\u5165\u5bc6\u78bc","\u8acb\u8f38\u5165\u6191\u8b49\u5bc6\u78bc","","\u53d6\u6d88","\u78ba\u8a8d",
["SelectSignerExFromChild",e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],twcaLib]):(h=e[8],e=null,a.callback(h,d,g,c))};this.SignPkcs7FromChildWindowHandler=function(d,g,h,c){h=e[2];e=null;a.callback(h,d,g,c)};this.SignPkcs1FromChildWindowHandler=function(d,g,h,c){h=e[2];e=null;a.callback(h,d,g,c)};this.ResetKeyFromChildWindowHandler=function(d,g,h,c){h=e[0];e=null;a.callback(h,d,g,c)};this.GetVersionFromChildWindowHandler=function(d,g,h,c){h=e[0];e=null;a.callback(h,d,g,c)};this.callback=function(d,
e,h,c){if("string"===typeof d&&0==d.indexOf("oTwcaLib._childWindow.twcaLib."))d=d.substring(30,d.length),a._childWindow.twcaLib[d](e,h,"",c);else if("string"===typeof d&&0==d.indexOf("twcaLib."))d=d.substring(8,d.length),a[d](e,h,"",c);else{var b={};if(d&&"[object Function]"===b.toString.call(d))d(e,h,"",c);else window[d](e,h,"",c)}}}
support_amd&&define(function(I){var D=require("twca/forge");return new function(){function G(e,c,b,g){var f="",k,m;do if(null==d.selectedCertInfo||null!=c)x(c,b);else{var q=61440&g;switch(q){case 0:q=D.pki.oids.sha1;break;case 4096:q=D.pki.oids.md5;break;case 8192:q=D.pki.oids.sha256;break;case 16384:q=D.pki.oids.sha512;break;default:q=D.pki.oids.sha1}var v=3840&g,v=1024==v?!1:!0,t=15&g,f=D.asn1.fromDer(D.util.decode64(d.selectedCertInfo.certb64)),f=D.pki.certificateFromAsn1(f);k=JSON.parse(sessionStorage.getItem("twcaSelectedKey"));
k=a(null,null,k);m=D.pkcs7.createSignedData();switch(t){case 0:m.content=D.util.createBuffer(y(e),"raw");break;case 1:m.content=D.util.createBuffer(e,"utf8");break;case 2:m.content="undefined"==typeof Big5Encoding?D.util.createBuffer(e,"utf8"):D.util.createBuffer(Big5Encoding.getBig5Encoding(e),"raw");break;default:m.content=D.util.createBuffer(y(e),"raw")}m.addCertificate(f);m.addSigner({key:k,certificate:f,digestAlgorithm:q});m.sign();f=v?D.pkcs7.messageToPem(m):D.pkcs7.messageToPemWithoutContent(m);
f=f.replace(/\-----BEGIN PKCS7-----/g,"");f=f.replace(/\-----END PKCS7-----/g,"");f=f.replace(/(?:\\[rn]|[\r\n]+)+/g,"")}while(0);return f}function m(e,c,b,g){var f,k,m;do if(null==d.selectedCertInfo||null!=c)x(c,b);else{m=61440&g;switch(m){case 0:m=D.md.sha1;break;case 4096:m=D.md.md5;break;case 8192:m=D.md.sha256;break;case 16384:m=D.md.sha512;break;default:m=D.md.sha1}f=3840&g;f=256==f?!1:!0;var q=15&g;k=JSON.parse(sessionStorage.getItem("twcaSelectedKey"));k=a(null,null,k);m=m.create();switch(q){case 0:m.update(y(e));
break;case 1:m.update(e,"utf8");break;case 2:"undefined"==typeof Big5Encoding?m.update(e,"utf8"):m.update(Big5Encoding.getBig5Encoding(e));break;default:m.update(y(e))}f=f?D.util.bytesToHex(k.sign(m)):D.util.encode64(k.sign(m))}while(0);return f}function x(d,c,b,g){var f=-1,k=[],m,q=null;m=localStorage.getItem("TWCACertIdxRef");if(null==m)q={};else if(""==m)q={};else try{console.log("obj name:TWCACertIdxRef"),console.log("obj value: "+m),q=JSON.parse(m)}catch(y){q={}}m=q;var v,q={},x=null,r="",p=
!1,F=!1,z=!1,A;do if(4096==(61440&b)&&(p=!0),4==(4&b)&&(F=!0),8==(8&b)&&(z=!0),A=b&240,null==d||""==d)f=5005,x=null;else if("//S"!=d.substring(0,3)&&"//I"!=d.substring(0,3)||"//"!=d.substring(d.length-2,d.length))f=5005,x=null;else if(null==c||""==c||14==c.length&&!isNaN(c)){v=d.replace(/^\/\/|\/\/\s*$/g,"").replace(/\s*=\s*/gm,"=").split("//");for(var G=0;G<v.length;G++){var l=G,E;a:{E={};for(var K="S_SN S_CN S_OU S_O S_C I_CN I_OU I_O I_C".split(" "),B=v[G];0<B.length;){var L=B.substring(0,B.indexOf("="));
if(!t(K,L)){E=5005;break a}var B=B.substring(B.indexOf("=")+1,B.length),I=B.length,T=B.indexOf(",S_"),N=B.indexOf(",I_");0<T&&T<I&&(I=T);0<N&&N<I&&(I=N);T=B.substring(0,I);"S_O"==L||"S_OU"==L||"I_O"==L||"I_OU"==L?(E[L]||(E[L]=[]),E[L].push(T)):E[L]=T;B=B.substring(I+1,B.length)}}k[l]=E}if(t(k,5005)||""==k[0])f=5005,x=null;else{for(var M in m){v=m[M];console.log("cert subject: "+v.cn);v.certb64=JSON.parse(localStorage.getItem(M)).certb64;if(z){G=k;E=C(v.certb64);l=E.subject;E=E.issuer;K=!1;for(B=0;B<
G.length;B++){var L=!0,Q;for(Q in G[B])if("S_SN"==Q)G[B][Q].toUpperCase()!=l.SN&&(L=!1);else if("S_CN"==Q)0>l.CN.indexOf(G[B][Q])&&(L=!1);else if("S_OU"==Q)for(I=0;I<G[B][Q].length;I++)t(l.OU,G[B][Q][I])||(L=!1);else if("S_O"==Q)for(I=0;I<G[B][Q].length;I++)t(l.O,G[B][Q][I])||(L=!1);else if("S_C"==Q)G[B][Q]!=l.C&&(L=!1);else if("I_CN"==Q)G[B][Q]!=E.CN&&(L=!1);else if("I_OU"==Q)for(I=0;I<G[B][Q].length;I++)t(E.OU,G[B][Q][I])||(L=!1);else if("I_O"==Q)for(I=0;I<G[B][Q].length;I++)t(E.O,G[B][Q][I])||
(L=!1);else"I_C"==Q&&G[B][Q]!=E.C&&(L=!1);if(K=K||L)break}G=K}else{G=k;l=C(v.certb64).subject;E=!1;for(K=0;K<G.length;K++)if(B=!1,G[K].S_C==l.C&&(null==l.O||null!=G[K].S_O&&G[K].S_O.length==l.O.length)){for(L=0;null!=l.O&&L<l.O.length;L++)t(G[K].S_O,l.O[L])||(B=!0);if(!B&&(null==l.OU||null!=G[K].S_OU&&G[K].S_OU.length==l.OU.length)){for(L=0;null!=l.OU&&L<l.OU.length;L++)t(G[K].S_OU,l.OU[L])||(B=!0);if(!B&&G[K].S_CN==l.CN){E=!0;break}}}G=E}""!=c?v.notAfter<c&&(G=!1):F&&(L=new Date,l=L.getFullYear(),
E=L.getMonth()+1,L.getDate(),K=L.getHours(),B=L.getMinutes(),I=L.getSeconds(),l="0000"+l,l=l.substring(l.length-4,l.length),E="00"+E,E=E.substring(E.length-2,E.length),L="00"+E,L=L.substring(L.length-2,L.length),K="00"+K,K=K.substring(K.length-2,K.length),B="00"+B,B=B.substring(B.length-2,B.length),I="00"+I,I=I.substring(I.length-2,I.length),v.notAfter<l+E+L+K+B+I&&(G=!1));G&&null!=localStorage.getItem(M)&&""!=localStorage.getItem(M)&&(q[M]=v)}for(var S in q)if(null==x)r=S,x=q[S];else switch(A){case 0:x.notBefore<=
q[S].notBefore&&(r=S,x=q[S]);break;case 16:x.notBefore<=q[S].notBefore&&(r=S,x=q[S]);break;case 32:x.notBefore>=q[S].notBefore&&(r=S,x=q[S]);break;case 64:x.notAfter<=q[S].notAfter&&(r=S,x=q[S]);break;case 128:x.notAfter>=q[S].notAfter&&(r=S,x=q[S]);break;default:x.notAfter<=q[S].notAfter&&(r=S,x=q[S])}if(null==x)f=5010,x=null;else if(x.b64P12Cert=JSON.parse(localStorage.getItem(r)).b64P12Cert,x.keySet=JSON.parse(localStorage.getItem(r)).keySet,x.certfinger=JSON.parse(localStorage.getItem(r)).certfinger,
x.certb64=JSON.parse(localStorage.getItem(r)).certb64,!p){sessionStorage.removeItem("twcaSelectedKey");if(x.b64P12Cert){A=g;v=null;try{v=D.pkcs12.pkcs12FromAsn1(D.asn1.fromDer(D.util.decode64(x.b64P12Cert)),A)}catch(y){}A=v;if(!A){f=5071;x=null;break}A=A.getBags({bagType:D.pki.oids.pkcs8ShroudedKeyBag})[D.pki.oids.pkcs8ShroudedKeyBag][0].key;A=JSON.stringify(e(A))}else if(x.keySet){A=a(x.keySet,g);if(!A){f=5071;x=null;break}A=JSON.stringify(e(A))}else{f=5112;x=null;break}sessionStorage.setItem("twcaSelectedKey",
A)}}}else f=5005,rtnCodeInfo=null;while(0);return null!=x?x:f}function F(a){return a?'"sn":"'+a.serial+'","cn":"'+a.cn+'","ntb":"'+a.notBefore+'","nta":"'+a.notAfter+'","issdn":"'+a.issuer+'","subdn":"'+a.subject+'","certfinger":"'+a.certfinger+'","certb64":"'+a.certb64+'"':""}function y(a){for(var c=new Uint8Array(2*a.length),b=0;b<a.length;b++){var d=a.charCodeAt(b);c[2*b]=d&255;c[2*b+1]=d>>8&255}a="";for(b=0;b<c.length;b++)a=16>c[b]?a+"%0":a+"%",a+=c[b].toString(16);return unescape(a)}function C(a){ret=
{};var c;try{c=D.asn1.fromDer(D.util.decode64(a)),c=D.pki.certificateFromAsn1(c)}catch(d){return null}ret.subject={};for(a=0;a<c.subject.attributes.length;a++){var b=c.subject.attributes[a];"C"==b.shortName&&(ret.subject.C=b.value);"O"==b.shortName&&(null==ret.subject.O&&(ret.subject.O=[]),ret.subject.O.push(b.value));"OU"==b.shortName&&(null==ret.subject.OU&&(ret.subject.OU=[]),ret.subject.OU.push(b.value));"CN"==b.shortName&&(ret.subject.CN=b.value)}ret.subject.SN=c.serialNumber.toUpperCase();ret.issuer=
{};for(a=0;a<c.issuer.attributes.length;a++)b=c.issuer.attributes[a],"C"==b.shortName&&(ret.issuer.C=b.value),"O"==b.shortName&&(null==ret.issuer.O&&(ret.issuer.O=[]),ret.issuer.O.push(b.value)),"OU"==b.shortName&&(null==ret.issuer.OU&&(ret.issuer.OU=[]),ret.issuer.OU.push(b.value)),"CN"==b.shortName&&(ret.issuer.CN=b.value);return ret}function t(a,c){for(var b in a)if(a[b]==c)return!0;return!1}function a(a,c,b){var d=null;try{if(3>arguments.length){var e=D.md.sha256.create();e.update(c);var g=e.digest().getBytes(),
k=D.cipher.createDecipher("AES-CBC",g);k.start({iv:""});k.update(D.util.createBuffer(D.util.decode64(a)));k.finish();var m=k.output.data.split("||");"TWCA"==m[8]&&(d=D.pki.setRsaPrivateKey(new D.jsbn.BigInteger(m[1],16),new D.jsbn.BigInteger(m[0],16),new D.jsbn.BigInteger(m[7],16),new D.jsbn.BigInteger(m[2],16),new D.jsbn.BigInteger(m[3],16),new D.jsbn.BigInteger(m[4],16),new D.jsbn.BigInteger(m[5],16),new D.jsbn.BigInteger(m[6],16)))}else d=D.pki.setRsaPrivateKey(new D.jsbn.BigInteger(b.n,16),new D.jsbn.BigInteger(b.e,
16),new D.jsbn.BigInteger(b.d,16),new D.jsbn.BigInteger(b.p,16),new D.jsbn.BigInteger(b.q,16),new D.jsbn.BigInteger(b.dP,16),new D.jsbn.BigInteger(b.dQ,16),new D.jsbn.BigInteger(b.qInv,16))}catch(v){d=null}return d}function e(a){if(a){var c={};c.n=a.n.toString(16);c.e=a.e.toString(16);c.d=a.d.toString(16);c.p=a.p.toString(16);c.q=a.q.toString(16);c.dP=a.dP.toString(16);c.dQ=a.dQ.toString(16);c.qInv=a.qInv.toString(16);return c}}var d=this;twcaLib=d;var k=null,g=!1;-1<navigator.userAgent.indexOf("TWID")&&
(g=!0);this.SelectSignerEx=function(a,c,b,e,f,m,u,q,v){if(window.opener&&window.opener.twcaLib)k=[a,c,b,e,f,m,u,q,v],window.opener.twcaLib.setOpenWindowObject(window),window.opener.twcaLib.SelectSignerEx(a,c,b,e,f,m,u,q,"oTwcaLib._childWindow.twcaLib.SelectSignerExFromChildWindowHandler");else{if(g)try{"undefined"==typeof v&&(v="ret_SelectSignerEx");var t=MobileUtils.registerFunction(v),r=navigator.userAgent;return MobileUtils.supportTwidAndroid()?(window.mobile.SelectSignerEx(a,c,b,e,f,MobileUtils.toNumber(m),
u,q,t),0):0<r.indexOf("iPhone")||0<r.indexOf("iPad")?(document.location="PKI::SelectSignerEx::"+encodeURI(a+separation+c+separation+b+separation+e+separation+f+separation+m+separation+u+separation+q+separation+t),0):1}catch(y){return alert(y),-1}var t=0,r="\u6210\u529f",p="";do{var C=x(a,f,m,e);if("number"==typeof C)switch(C){case 5005:t=5005;r="\u53c3\u6578\u932f\u8aa4";break;case 5010:t=5010;r="\u7121\u6191\u8b49";break;case 5071:if(null==e&&0>"oTwcaLib._childWindow.twcaLib.SelectSignerExFromChildWindowHandler".indexOf(v)){twcaCryptoLibAlertDialog.show("\u8f38\u5165\u5bc6\u78bc",
"\u8acb\u8f38\u5165\u6191\u8b49\u5bc6\u78bc","","\u53d6\u6d88","\u78ba\u8a8d",["SelectSignerEx",a,c,b,e,f,m,u,q,v,d]);return}t=5071;r="\u6191\u8b49\u5bc6\u78bc\u932f\u8aa4";break;case 5112:t=5112;r="\u8b80\u53d6\u6191\u8b49\u5931\u6557";break;default:t=5001,r="\u4e00\u822c\u932f\u8aa4"}else 0==(m&61440)&&(d.selectedCertInfo=C,sessionStorage.setItem("selectedCertInfo",JSON.stringify(C))),p="{"+F(C)+"}"}while(0);d.callback(v,t,r,p)}};this.SignPkcs7=function(a,c,b,e){if(window.opener&&window.opener.twcaLib)k=
[a,c,b],window.opener.twcaLib.setOpenWindowObject(window),window.opener.twcaLib.SignPkcs7(a,c,"oTwcaLib._childWindow.twcaLib.SignPkcs7FromChildWindowHandler");else{if(g)try{"undefined"==typeof b&&(b="ret_SignPkcs7");var f=MobileUtils.registerFunction(b),m=navigator.userAgent;return MobileUtils.supportTwidAndroid()?(window.mobile.SignPkcs7(a,MobileUtils.toNumber(c),f),0):0<m.indexOf("iPhone")||0<m.indexOf("iPad")?(document.location="PKI::SignPkcs7::"+encodeURI(a+separation+c+separation+f),0):1}catch(t){return alert(t),
-1}if(4<=arguments.length)return G(a,c,b,e);var u,f=0,m="\u6210\u529f",q="";if(null==a||0>=a.length)f=5005,m="\u53c3\u6578\u932f\u8aa4";else{if(u=sessionStorage.getItem("selectedCertInfo"))d.selectedCertInfo=JSON.parse(u);u=sessionStorage.getItem("twcaSelectedKey");d.selectedCertInfo&&null!=u?(u=G(a,null,null,c),null==u||""==u?(f=5061,m="\u7c3d\u7ae0\u5931\u6557"):q="{"+F(d.selectedCertInfo)+',"signature":"'+u+'"}'):(f=5067,m="\u57f7\u884c\u7c3d\u7ae0\u6642\uff0c\u5c1a\u672a\u9078\u64c7\u7c3d\u7ae0\u6191\u8b49")}d.callback(b,
f,m,q)}};this.SignPkcs1=function(a,c,b,e){if(window.opener&&window.opener.twcaLib)k=[a,c,b],window.opener.twcaLib.setOpenWindowObject(window),window.opener.twcaLib.SignPkcs1(a,c,"oTwcaLib._childWindow.twcaLib.SignPkcs1FromChildWindowHandler");else{if(g)try{"undefined"==typeof b&&(b="ret_SignPkcs1");var f=MobileUtils.registerFunction(b),t=navigator.userAgent;return MobileUtils.supportTwidAndroid()?(window.mobile.SignPkcs1(a,MobileUtils.toNumber(c),f),0):0<t.indexOf("iPhone")||0<t.indexOf("iPad")?(document.location=
"PKI::SignPkcs1::"+encodeURI(a+separation+c+separation+f),0):1}catch(v){return alert(v),-1}if(4<=arguments.length)return m(a,c,b,e);var u,f=0,t="\u6210\u529f",q="";if(null==a||0>=a.length)f=5005,t="\u53c3\u6578\u932f\u8aa4";else{if(u=sessionStorage.getItem("selectedCertInfo"))d.selectedCertInfo=JSON.parse(u);u=sessionStorage.getItem("twcaSelectedKey");d.selectedCertInfo&&null!=u?(u=m(a,null,null,c),null==u||""==u?(f=5061,t="\u7c3d\u7ae0\u5931\u6557"):q='{"signature":"'+u+'",'+F(d.selectedCertInfo)+
"}"):(f=5067,t="\u57f7\u884c\u7c3d\u7ae0\u6642\uff0c\u5c1a\u672a\u9078\u64c7\u7c3d\u7ae0\u6191\u8b49")}d.callback(b,f,t,q)}};this.ResetKey=function(a){if(window.opener&&window.opener.twcaLib)k=[a],window.opener.twcaLib.setOpenWindowObject(window),window.opener.twcaLib.ResetKey("oTwcaLib._childWindow.twcaLib.ResetKeyFromChildWindowHandler");else{if(g)try{"undefined"==typeof a&&(a="ret_ResetKey");var c=MobileUtils.registerFunction(a),b=navigator.userAgent;return MobileUtils.supportTwidAndroid()?(window.mobile.ResetKey(c),
0):0<b.indexOf("iPhone")||0<b.indexOf("iPad")?(document.location="PKI::ResetKey::"+encodeURI(c),0):1}catch(e){return alert(e),-1}d.selectedCertInfo=null;sessionStorage.removeItem("selectedCertInfo");sessionStorage.removeItem("twcaSelectedKey");if(0>=arguments.length)return 0;d.callback(a,0,"\u6210\u529f","")}};this.GetVersion=function(a){if(window.opener&&window.opener.twcaLib)k=[a],window.opener.twcaLib.setOpenWindowObject(window),window.opener.twcaLib.GetVersion("oTwcaLib._childWindow.twcaLib.GetVersionFromChildWindowHandler");
else{if(g)try{"undefined"==typeof a&&(a="ret_GetVersion");var c=MobileUtils.registerFunction(a),b=navigator.userAgent;return MobileUtils.supportTwidAndroid()?(window.mobile.GetVersion(c),0):0<b.indexOf("iPhone")||0<b.indexOf("iPad")?(document.location="PKI::GetVersion::"+encodeURI(c),0):1}catch(e){return alert(e),-1}if(0>=arguments.length)return"1.0.1.0";d.callback(a,0,"\u6210\u529f",'{"version":"1.0.1.0"}')}};this.QueryDeviceID=function(a,c,b){try{"undefined"==typeof b&&(b="ret_QueryDeviceID");var d=
MobileUtils.registerFunction(b),e=navigator.userAgent;return MobileUtils.supportTwidAndroid()?(window.mobile.QueryDeviceID(a,c,d),0):0<e.indexOf("iPhone")||0<e.indexOf("iPad")?(document.location="PKI::QueryDeviceID::"+encodeURI(a+separation+c+separation+d),0):1}catch(g){return alert(g),-1}};this.ImportPfxCert=function(a,c,b,d){};this.GetCertSubjectCN=function(){return d.getSelectedCertFieldValue("cn")};this.GetCertSubject=function(){return d.getSelectedCertFieldValue("subject")};this.GetCertIssuer=
function(){return d.getSelectedCertFieldValue("issuer")};this.GetCertSerial=function(){return d.getSelectedCertFieldValue("serial")};this.GetCertNotBefore=function(){return d.getSelectedCertFieldValue("notBefore")};this.GetCertNotAfter=function(){return d.getSelectedCertFieldValue("notAfter")};this.getSelectedCertFieldValue=function(a){return d.selectedCertInfo&&"undefined"!=typeof d.selectedCertInfo[a]?d.selectedCertInfo[a]:""};this.setOpenWindowObject=function(a){if("object"!=typeof a)return 5005;
d._childWindow=a};this.SelectSignerExFromChildWindowHandler=function(a,c,b,e){5071==a&&null==k[3]?twcaCryptoLibAlertDialog.show("\u8f38\u5165\u5bc6\u78bc","\u8acb\u8f38\u5165\u6191\u8b49\u5bc6\u78bc","","\u53d6\u6d88","\u78ba\u8a8d",["SelectSignerExFromChild",k[0],k[1],k[2],k[3],k[4],k[5],k[6],k[7],k[8],d]):(b=k[8],k=null,d.callback(b,a,c,e))};this.SignPkcs7FromChildWindowHandler=function(a,c,b,e){b=k[2];k=null;d.callback(b,a,c,e)};this.SignPkcs1FromChildWindowHandler=function(a,c,b,e){b=k[2];k=null;
d.callback(b,a,c,e)};this.ResetKeyFromChildWindowHandler=function(a,c,b,e){b=k[0];k=null;d.callback(b,a,c,e)};this.GetVersionFromChildWindowHandler=function(a,c,b,e){b=k[0];k=null;d.callback(b,a,c,e)};this.callback=function(a,c,b,e){if("string"===typeof a&&0==a.indexOf("oTwcaLib._childWindow.twcaLib."))a=a.substring(30,a.length),d._childWindow.twcaLib[a](c,b,"",e);else if("string"===typeof a&&0==a.indexOf("twcaLib."))a=a.substring(8,a.length),d[a](c,b,"",e);else{var f={};if(a&&"[object Function]"===
f.toString.call(a))a(c,b,"",e);else window[a](c,b,"",e)}}}});